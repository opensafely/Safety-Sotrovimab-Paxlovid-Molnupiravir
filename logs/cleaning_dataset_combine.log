-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /workspace/logs/cleaning_dataset_combine.log
  log type:  text
 opened on:   8 Aug 2023, 14:43:33

. 
. *Set Ado file path
. adopath + "$projectdir/analysis/ado"
  [1]  (BASE)      "/usr/local/stata/ado/base/"
  [2]  (SITE)      "/usr/local/ado/"
  [3]              "."
  [4]  (PERSONAL)  "~/ado/personal/"
  [5]  (PLUS)      "~/ado/plus/"
  [6]  (OLDPLACE)  "~/ado/"
  [7]              "/workspace/analysis/ado"

. 
. *       Import control dataset
. import delimited "$projectdir/output/input_control.csv", clear
(263 vars, 50,000 obs)

. gen control_dataset=1

. *       Convert control strings to dates     * 
. foreach var of varlist   pre_covid_hosp_date                                 
>    ///
>                                                  pre_covid_hosp_discharge    
>                            ///
>                                                  covid_test_positive_date    
>                            ///
>                                                  covid_test_positive_date2   
>                            ///
>                                                  covid_test_positive_date3   
>                            ///
>                                                  covid_test_positive_treat   
>                            ///
>                                                  prior_covid_date            
>                            ///
>                                                  sotrovimab                  
>                                            ///
>                                                  molnupiravir                
>                                    /// 
>                                                  paxlovid                    
>                                            ///
>                                                  remdesivir                  
>                                            ///
>                                                  casirivimab                 
>                                    ///
>                                                  sotrovimab_not_start        
>                            ///
>                                                  molnupiravir_not_start      
>                            ///
>                                                  paxlovid_not_start          
>                                    ///
>                                                  date_treated                
>                                    ///
>                                                  start_date                  
>                                            ///
>                                                  drugs_paxlovid_interaction  
>                            ///
>                                                  drugs_nirmatrelvir_interacti
> on                 ///
>                                                  last_vaccination_date       
>                            ///
>                                                  death_date                  
>                                            ///
>                                                  dereg_date                  
>                                    ///
>                                                  bmi_date_measured           
>                                    ///
>                                                  creatinine_ctv3_date        
>                            ///
>                                                  creatinine_snomed_date      
>                            ///
>                                                  creatinine_short_snomed_date
>                    ///
>                                                  ae_diverticulitis_icd       
>                            ///
>                                                  ae_diverticulitis_icd_prim  
>                            ///
>                                                  ae_diverticulitis_snomed    
>                            ///
>                                                  ae_diverticulitis_ae        
>                            ///                      
>                                                  ae_diarrhoea_snomed         
>                            ///
>                                                  ae_diarrhoea_icd            
>                                    ///
>                                                  ae_diarrhoea_icd_prim       
>                            ///
>                                                  ae_diarrhoeal_icd           
>                                    ///
>                                                  ae_diarrhoeal_icd_prim      
>                            ///              
>                                                  ae_taste_snomed             
>                                    ///
>                                                  ae_taste_icd                
>                                    ///
>                                                  ae_taste_icd_prim           
>                                    ///
>                                                  ae_rash_snomed              
>                                    ///
>                                                  ae_rash_ae                  
>                                            ///
>                                                  ae_rash_icd                 
>                                    ///
>                                                  ae_rash_icd_prim            
>                                    ///
>                                                  ae_anaphylaxis_icd          
>                                    ///
>                                              ae_anaphylaxis_icd_prim         
>                    ///
>                                              ae_anaphylaxis_snomed           
>                            ///
>                                                  ae_anaphlaxis_ae            
>                                    ///
>                                                  ae_severedrug_icd           
>                                    ///
>                                                  ae_severedrug_icd_prim      
>                            ///
>                                                  ae_severedrug_sjs_icd       
>                            ///
>                                                  ae_severedrug_sjs_icd_prim  
>                            ///
>                                                  ae_severedrug_snomed        
>                            ///
>                                                  ae_severedrug_ae            
>                                    ///
>                                                  ae_nonsevere_drug_snomed    
>                            ///
>                                                  ae_nonsevere_drug_ae        
>                            ///
>                                                  ae_rheumatoid_arthritis_icd 
>                    ///
>                                                  ae_rheumatoid_arthritis_icd_
> prim               ///
>                                                  ae_rheumatoid_arthritis_snom
> ed                 ///
>                                                  ae_rheumatoid_arthritis_ae  
>                            ///
>                                                  ae_sle_icd                  
>                                            ///
>                                                  ae_sle_icd_prim             
>                                    ///
>                                                  ae_sle_ae                   
>                                            ///
>                                                  ae_sle_ctv                  
>                                            ///
>                                                  ae_psoriasis_icd            
>                                    ///
>                                                  ae_psoriasis_icd_prim       
>                            ///
>                                                  ae_psoriasis_ae             
>                                    ///
>                                                  ae_psoriasis_snomed         
>                            ///
>                                                  ae_psa_icd                  
>                                            ///
>                                                  ae_psa_icd_prim             
>                                    ///
>                                                  ae_psa_snomed               
>                                    ///
>                                                  ae_psa_ae                   
>                                            ///
>                                                  ae_psa_snomed               
>                                    ///
>                                                  ae_axspa_icd                
>                                    ///
>                                                  ae_axspa_icd_prim           
>                                    ///
>                                                  ae_axspa_ctv                
>                                    ///
>                                                  ae_axspa_ae                 
>                                    ///
>                                                  ae_ibd_icd                  
>                                            ///
>                                                  ae_ibd_icd_prim             
>                                    ///
>                                                  ae_ibd_ctv                  
>                                            ///
>                                                  ae_ibd_ae                   
>                                            ///
>                                                  pre_diverticulitis_icd      
>                            ///
>                                                  pre_diverticulitis_icd_prim 
>                    ///
>                                                  pre_diverticulitis_snomed   
>                            ///
>                                                  pre_diverticulitis_ae       
>                            ///
>                                                  pre_diarrhoea_snomed        
>                            ///
>                                                  pre_diarrhoea_icd           
>                                    ///
>                                                  pre_diarrhoea_icd_prim      
>                            ///
>                                                  pre_diarrhoeal_icd          
>                                    ///
>                                                  pre_diarrhoeal_icd_prim     
>                            ///
>                                                  pre_taste_icd               
>                                    ///
>                                                  pre_taste_icd_prim          
>                                    ///
>                                                  pre_taste_snomed            
>                                    ///
>                                                  pre_rash_snomed             
>                                    ///
>                                                  pre_rash_ae                 
>                                    ///
>                                                  pre_rash_icd                
>                                    ///
>                                                  pre_rash_icd_prim           
>                                    ///
>                                                  pre_anaphylaxis_icd_prim    
>                            ///
>                                                  pre_anaphylaxis_icd         
>                            ///
>                                                  pre_anaphylaxis_snomed      
>                            ///                                              
>                                                  pre_anaphlaxis_ae           
>                                    ///
>                                                  pre_severedrug_icd          
>                                    ///
>                                                  pre_severedrug_icd_prim     
>                            ///
>                                                  pre_severedrug_sjs_icd      
>                            ///
>                                                  pre_severedrug_sjs_icd_prim 
>                    ///
>                                                  pre_severedrug_snomed       
>                            ///
>                                                  pre_severedrug_ae           
>                                    ///
>                                              pre_nonsevere_drug_snomed       
>                    ///
>                                                  pre_nonsevere_drug_ae       
>                            ///
>                                                  pre_rheumatoid_icd_prim     
>                            ///
>                                                  pre_sle_icd_prim            
>                                    ///
>                                                  pre_sle_ctv                 
>                                    ///
>                                                  pre_sle_icd                 
>                                    ///
>                                                  pre_sle_ae                  
>                                            ///
>                                                  pre_rheumatoid_arthritis_icd
>                    ///
>                                                  pre_rheumatoid_icd_prim     
>                            ///
>                                                  pre_rheumatoid_arthritis_ae 
>                    ///
>                                                  pre_rheumatoid_arthritis_sno
> med                ///
>                                                  pre_psoriasis_icd           
>                                    ///
>                                                  pre_psoriasis_icd_prim      
>                            ///
>                                                  pre_psoriasis_snomed        
>                            ///
>                                                  pre_psoriasis_ae            
>                                    /// 
>                                                  pre_psa_icd                 
>                                    /// 
>                                                  pre_psa_icd_prim            
>                                    /// 
>                                                  pre_psa_ae                  
>                                            ///
>                                                  pre_psa_snomed              
>                                    ///                                       
>        
>                                                  pre_axspa_icd               
>                                    ///     
>                                                  pre_axspa_icd_prim          
>                                    ///     
>                                                  pre_axspa_ctv               
>                                    ///
>                                                  pre_axspa_ae                
>                                    ///
>                                                  pre_ibd_ae                  
>                                            ///
>                                                  pre_ibd_ctv                 
>                                    ///
>                                                  pre_ibd_icd                 
>                                    ///
>                                                  pre_ibd_icd_prim            
>                                    ///
>                                                  allcause_emerg_aande        
>                            ///
>                                                  all_hosp_date               
>                                    ///
>                                                  all_hosp_date0              
>                                    ///
>                                                  all_hosp_date1              
>                                    ///
>                                                  all_hosp_date2              
>                                    ///
>                                                  hosp_discharge_date         
>                            ///
>                                                  hosp_discharge_date0        
>                            ///
>                                                  hosp_discharge_date1        
>                            ///
>                                                  hosp_discharge_date2        
>                            ///
>                                                  covid_hosp_date             
>                                    ///
>                                                  covid_hosp_date0            
>                                    ///
>                                                  covid_hosp_date1            
>                                    ///
>                                                  covid_hosp_date2            
>                                    ///                                       
>       
>                                                  covid_discharge_date        
>                            ///
>                                                  covid_discharge_date0       
>                            ///                                             
>                                                  covid_discharge_date1       
>                            /// 
>                                                  covid_discharge_date2       
>                            /// 
>                                                  any_covid_hosp_discharge    
>                            ///                     
>                                                  covid_hosp_date_mabs        
>                            /// 
>                                                  covid_hosp_date_mabs_not_pri
> mary               /// 
>                                                  died_date_ons               
>                                    ///
>                                                  died_ons_covid {            
>                             
  2.         capture confirm string variable `var'
  3.         if _rc==0 {
  4.         rename `var' a
  5.         gen `var' = date(a, "YMD")
  6.         drop a
  7.         format %td `var'
  8.  }
  9. }
(47,500 missing values generated)
(47,500 missing values generated)
(4,999 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(30,000 missing values generated)
(4,999 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,542 missing values generated)
(47,500 missing values generated)
(47,500 missing values generated)
(2,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(2,500 missing values generated)
(25,000 missing values generated)
(25,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(20,000 missing values generated)
(20,000 missing values generated)

. tab control_dataset

control_dat |
       aset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     50,000      100.00      100.00
------------+-----------------------------------
      Total |     50,000      100.00

. save "$projectdir/output/data/control.dta", replace 
file /workspace/output/data/control.dta saved

. //                                               //                          
>    ///
. 
. * import treatment dataset
. import delimited "$projectdir/output/input_treatment.csv", clear
(263 vars, 50,000 obs)

. gen treatment_dataset=1

. 
. *       Convert control strings to dates     * 
. foreach var of varlist   pre_covid_hosp_date                                 
>    ///
>                                                  pre_covid_hosp_discharge    
>                            ///
>                                                  covid_test_positive_date    
>                            ///
>                                                  covid_test_positive_date2   
>                            ///
>                                                  covid_test_positive_date3   
>                            ///
>                                                  covid_test_positive_treat   
>                            ///
>                                                  prior_covid_date            
>                            ///
>                                                  sotrovimab                  
>                                            ///
>                                                  molnupiravir                
>                                    /// 
>                                                  paxlovid                    
>                                            ///
>                                                  remdesivir                  
>                                            ///
>                                                  casirivimab                 
>                                    ///
>                                                  sotrovimab_not_start        
>                            ///
>                                                  molnupiravir_not_start      
>                            ///
>                                                  paxlovid_not_start          
>                                    ///
>                                                  date_treated                
>                                    ///
>                                                  start_date                  
>                                            ///
>                                                  drugs_paxlovid_interaction  
>                            ///
>                                                  drugs_nirmatrelvir_interacti
> on                 ///
>                                                  last_vaccination_date       
>                            ///
>                                                  death_date                  
>                                            ///
>                                                  dereg_date                  
>                                    ///
>                                                  bmi_date_measured           
>                                    ///
>                                                  creatinine_ctv3_date        
>                            ///
>                                                  creatinine_snomed_date      
>                            ///
>                                                  creatinine_short_snomed_date
>                    ///
>                                                  ae_diverticulitis_icd       
>                            ///
>                                                  ae_diverticulitis_icd_prim  
>                            ///
>                                                  ae_diverticulitis_snomed    
>                            ///
>                                                  ae_diverticulitis_ae        
>                            ///                      
>                                                  ae_diarrhoea_snomed         
>                            ///
>                                                  ae_diarrhoea_icd            
>                                    ///
>                                                  ae_diarrhoea_icd_prim       
>                            ///
>                                                  ae_diarrhoeal_icd           
>                                    ///
>                                                  ae_diarrhoeal_icd_prim      
>                            ///              
>                                                  ae_taste_snomed             
>                                    ///
>                                                  ae_taste_icd                
>                                    ///
>                                                  ae_taste_icd_prim           
>                                    ///
>                                                  ae_rash_snomed              
>                                    ///
>                                                  ae_rash_ae                  
>                                            ///
>                                                  ae_rash_icd                 
>                                    ///
>                                                  ae_rash_icd_prim            
>                                    ///
>                                                  ae_anaphylaxis_icd          
>                                    ///
>                                              ae_anaphylaxis_icd_prim         
>                    ///
>                                              ae_anaphylaxis_snomed           
>                            ///
>                                                  ae_anaphlaxis_ae            
>                                    ///
>                                                  ae_severedrug_icd           
>                                    ///
>                                                  ae_severedrug_icd_prim      
>                            ///
>                                                  ae_severedrug_sjs_icd       
>                            ///
>                                                  ae_severedrug_sjs_icd_prim  
>                            ///
>                                                  ae_severedrug_snomed        
>                            ///
>                                                  ae_severedrug_ae            
>                                    ///
>                                                  ae_nonsevere_drug_snomed    
>                            ///
>                                                  ae_nonsevere_drug_ae        
>                            ///
>                                                  ae_rheumatoid_arthritis_icd 
>                    ///
>                                                  ae_rheumatoid_arthritis_icd_
> prim               ///
>                                                  ae_rheumatoid_arthritis_snom
> ed                 ///
>                                                  ae_rheumatoid_arthritis_ae  
>                            ///
>                                                  ae_sle_icd                  
>                                            ///
>                                                  ae_sle_icd_prim             
>                                    ///
>                                                  ae_sle_ae                   
>                                            ///
>                                                  ae_sle_ctv                  
>                                            ///
>                                                  ae_psoriasis_icd            
>                                    ///
>                                                  ae_psoriasis_icd_prim       
>                            ///
>                                                  ae_psoriasis_ae             
>                                    ///
>                                                  ae_psoriasis_snomed         
>                            ///
>                                                  ae_psa_icd                  
>                                            ///
>                                                  ae_psa_icd_prim             
>                                    ///
>                                                  ae_psa_snomed               
>                                    ///
>                                                  ae_psa_ae                   
>                                            ///
>                                                  ae_psa_snomed               
>                                    ///
>                                                  ae_axspa_icd                
>                                    ///
>                                                  ae_axspa_icd_prim           
>                                    ///
>                                                  ae_axspa_ctv                
>                                    ///
>                                                  ae_axspa_ae                 
>                                    ///
>                                                  ae_ibd_icd                  
>                                            ///
>                                                  ae_ibd_icd_prim             
>                                    ///
>                                                  ae_ibd_ctv                  
>                                            ///
>                                                  ae_ibd_ae                   
>                                            ///
>                                                  pre_diverticulitis_icd      
>                            ///
>                                                  pre_diverticulitis_icd_prim 
>                    ///
>                                                  pre_diverticulitis_snomed   
>                            ///
>                                                  pre_diverticulitis_ae       
>                            ///
>                                                  pre_diarrhoea_snomed        
>                            ///
>                                                  pre_diarrhoea_icd           
>                                    ///
>                                                  pre_diarrhoea_icd_prim      
>                            ///
>                                                  pre_diarrhoeal_icd          
>                                    ///
>                                                  pre_diarrhoeal_icd_prim     
>                            ///
>                                                  pre_taste_icd               
>                                    ///
>                                                  pre_taste_icd_prim          
>                                    ///
>                                                  pre_taste_snomed            
>                                    ///
>                                                  pre_rash_snomed             
>                                    ///
>                                                  pre_rash_ae                 
>                                    ///
>                                                  pre_rash_icd                
>                                    ///
>                                                  pre_rash_icd_prim           
>                                    ///
>                                                  pre_anaphylaxis_icd_prim    
>                            ///
>                                                  pre_anaphylaxis_icd         
>                            ///
>                                                  pre_anaphylaxis_snomed      
>                            ///                                              
>                                                  pre_anaphlaxis_ae           
>                                    ///
>                                                  pre_severedrug_icd          
>                                    ///
>                                                  pre_severedrug_icd_prim     
>                            ///
>                                                  pre_severedrug_sjs_icd      
>                            ///
>                                                  pre_severedrug_sjs_icd_prim 
>                    ///
>                                                  pre_severedrug_snomed       
>                            ///
>                                                  pre_severedrug_ae           
>                                    ///
>                                              pre_nonsevere_drug_snomed       
>                    ///
>                                                  pre_nonsevere_drug_ae       
>                            ///
>                                                  pre_rheumatoid_icd_prim     
>                            ///
>                                                  pre_sle_icd_prim            
>                                    ///
>                                                  pre_sle_ctv                 
>                                    ///
>                                                  pre_sle_icd                 
>                                    ///
>                                                  pre_sle_ae                  
>                                            ///
>                                                  pre_rheumatoid_arthritis_icd
>                    ///
>                                                  pre_rheumatoid_icd_prim     
>                            ///
>                                                  pre_rheumatoid_arthritis_ae 
>                    ///
>                                                  pre_rheumatoid_arthritis_sno
> med                ///
>                                                  pre_psoriasis_icd           
>                                    ///
>                                                  pre_psoriasis_icd_prim      
>                            ///
>                                                  pre_psoriasis_snomed        
>                            ///
>                                                  pre_psoriasis_ae            
>                                    /// 
>                                                  pre_psa_icd                 
>                                    /// 
>                                                  pre_psa_icd_prim            
>                                    /// 
>                                                  pre_psa_ae                  
>                                            ///
>                                                  pre_psa_snomed              
>                                    ///                                       
>        
>                                                  pre_axspa_icd               
>                                    ///     
>                                                  pre_axspa_icd_prim          
>                                    ///     
>                                                  pre_axspa_ctv               
>                                    ///
>                                                  pre_axspa_ae                
>                                    ///
>                                                  pre_ibd_ae                  
>                                            ///
>                                                  pre_ibd_ctv                 
>                                    ///
>                                                  pre_ibd_icd                 
>                                    ///
>                                                  pre_ibd_icd_prim            
>                                    ///
>                                                  allcause_emerg_aande        
>                            ///
>                                                  all_hosp_date               
>                                    ///
>                                                  all_hosp_date0              
>                                    ///
>                                                  all_hosp_date1              
>                                    ///
>                                                  all_hosp_date2              
>                                    ///
>                                                  hosp_discharge_date         
>                            ///
>                                                  hosp_discharge_date0        
>                            ///
>                                                  hosp_discharge_date1        
>                            ///
>                                                  hosp_discharge_date2        
>                            ///
>                                                  covid_hosp_date             
>                                    ///
>                                                  covid_hosp_date0            
>                                    ///
>                                                  covid_hosp_date1            
>                                    ///
>                                                  covid_hosp_date2            
>                                    ///                                       
>       
>                                                  covid_discharge_date        
>                            ///
>                                                  covid_discharge_date0       
>                            ///                                             
>                                                  covid_discharge_date1       
>                            /// 
>                                                  covid_discharge_date2       
>                            /// 
>                                                  any_covid_hosp_discharge    
>                            ///                     
>                                                  covid_hosp_date_mabs        
>                            /// 
>                                                  covid_hosp_date_mabs_not_pri
> mary               /// 
>                                                  died_date_ons               
>                                    ///
>                                                  died_ons_covid {            
>                             
  2.         capture confirm string variable `var'
  3.         if _rc==0 {
  4.         rename `var' a
  5.         gen `var' = date(a, "YMD")
  6.         drop a
  7.         format %td `var'
  8.  }
  9. }
(47,500 missing values generated)
(47,500 missing values generated)
(4,999 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(30,000 missing values generated)
(4,999 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,548 missing values generated)
(48,516 missing values generated)
(47,500 missing values generated)
(47,500 missing values generated)
(2,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(2,500 missing values generated)
(25,000 missing values generated)
(25,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(20,000 missing values generated)
(20,000 missing values generated)

. tab treatment_dataset

treatment_d |
     ataset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     50,000      100.00      100.00
------------+-----------------------------------
      Total |     50,000      100.00

. *********************************
. *  Append control & treatment datasets     *
. ********************************* 
. append using "$projectdir/output/data/control.dta"

. duplicates tag patient_id, gen(duplicate_patient_id)

Duplicates in terms of patient_id

. bys patient_id (treatment_dataset duplicate_patient_id): gen n=_n

. tab n

          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     94,856       94.86       94.86
          2 |      5,144        5.14      100.00
------------+-----------------------------------
      Total |    100,000      100.00

. drop if n>1  // drops duplicate patient id and in control group
(5,144 observations deleted)

. tab control_dataset,m

control_dat |
       aset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     44,856       47.29       47.29
          . |     50,000       52.71      100.00
------------+-----------------------------------
      Total |     94,856      100.00

. tab treatment_dataset,m

treatment_d |
     ataset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     50,000       52.71       52.71
          . |     44,856       47.29      100.00
------------+-----------------------------------
      Total |     94,856      100.00

. count if start_date==.
  48,516

. count if start_date!=date_treated & treatment_dataset==1
  982

. count if start_date!=covid_test_positive_date & control_dataset==1
  44,795

. gen dataset = 0 if control_dataset==1
(50,000 missing values generated)

. replace dataset= 1 if treatment_dataset==1
(50,000 real changes made)

. label define dataset 0 "control" 1 "drug" 

. label values dataset dataset

. 
. ****************************
. *       INCLUSION               *
. ****************************
. ** inclusion criteria*
. keep if age>=18 & age<110
(20,111 observations deleted)

. keep if sex=="F"|sex=="M"
(0 observations deleted)

. keep if has_died==0
(3,723 observations deleted)

. 
. ** exclusion criteria*
. count if start_date>dereg_date & start_date!=.
  3,437

. count if start_date>death_date & start_date!=.
  3,432

. drop if start_date>death_date | start_date>dereg_date
(13,380 observations deleted)

. 
. ** hospitalised and control cohort
. // control patient, discharged<5 days prior to covid test
. count if dataset==0 & (start_date-pre_covid_hosp_discharge<5) & (start_date-p
> re_covid_hosp_discharge>=0)
  1

. // control patient, hospitalised without discharged date
. count if dataset==0 & pre_covid_hosp_date!=. & pre_covid_hosp_discharge==. 
  1,298

. count if dataset==0 & pre_covid_hosp_date!=. & pre_covid_hosp_discharge==. & 
> (start_date-pre_covid_hosp_date<29)
  74

. count if dataset==0 & pre_covid_hosp_date!=. & pre_covid_hosp_discharge==. & 
> (start_date-pre_covid_hosp_date<366)
  169

. // control patient, hospitalised without discharged date (discharge date prec
> eed admission)
. count if dataset==0 & pre_covid_hosp_date>pre_covid_hosp_discharge & pre_covi
> d_hosp_date!=. & pre_covid_hosp_discharge!=.
  25

. count if dataset==0 & pre_covid_hosp_date>pre_covid_hosp_discharge & pre_covi
> d_hosp_date!=. & pre_covid_hosp_discharge!=. & (start_date-pre_covid_hosp_dat
> e<29)
  7

. count if dataset==0 & pre_covid_hosp_date>pre_covid_hosp_discharge & pre_covi
> d_hosp_date!=. & pre_covid_hosp_discharge!=. & (start_date-pre_covid_hosp_dat
> e<366)
  12

. // control patient, hospitalised on same day at covid test
. count if dataset==0 & pre_covid_hosp_date==start_date
  0

. count if dataset==0 & pre_covid_hosp_date==covid_test_positive_date
  2,652

. // remove these hospitalised patients from control group
. drop if dataset==0 & (start_date-pre_covid_hosp_discharge<5) & (start_date-pr
> e_covid_hosp_discharge>=0)
(1 observation deleted)

. drop if dataset==0 & pre_covid_hosp_date!=. & pre_covid_hosp_discharge==. & (
> start_date-pre_covid_hosp_date<366)
(169 observations deleted)

. drop if dataset==0 & pre_covid_hosp_date>pre_covid_hosp_discharge & pre_covid
> _hosp_date!=. & pre_covid_hosp_discharge!=. & (start_date-pre_covid_hosp_date
> <366)
(12 observations deleted)

. drop if dataset==0 & pre_covid_hosp_date==start_date
(0 observations deleted)

. 
. ** high risk cohort from blueteq therapeutics datafor drug arms
. tab high_risk_cohort_therapeutics dataset,m //should be 0 in control group

high_risk_cohort_ther |        dataset
             apeutics |   control       drug |     Total
----------------------+----------------------+----------
       Downs syndrome |     2,652      3,028 |     5,680 
          HIV or AIDS |     1,367      1,566 |     2,933 
                 IMID |     2,751      2,970 |     5,721 
    IMID,solid cancer |     2,729      3,036 |     5,765 
                   NA |     1,326      1,513 |     2,839 
haematological dise.. |     1,385      1,469 |     2,854 
haematological mali.. |     1,340      1,521 |     2,861 
        liver disease |     1,323      1,490 |     2,813 
primary immune defi.. |     2,744      3,019 |     5,763 
sickle cell disease.. |     2,678      3,032 |     5,710 
         solid cancer |     2,699      3,115 |     5,814 
solid organ transpl.. |     2,748      3,024 |     5,772 
stem cell transplan.. |     1,412      1,523 |     2,935 
----------------------+----------------------+----------
                Total |    27,154     30,306 |    57,460 

. gen downs_syndrome_therap= 1 if strpos(high_risk_cohort_therapeutics, "Downs 
> syndrome")
(51,780 missing values generated)

. gen solid_cancer_therap=1 if strpos(high_risk_cohort_therapeutics, "solid can
> cer")
(45,881 missing values generated)

. gen haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "haematolo
> gical malignancies")
(54,599 missing values generated)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "haema
> tologic malignancy")
(0 real changes made)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "sickl
> e cell disease")
(5,710 real changes made)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "haema
> tological diseases")
(2,854 real changes made)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "stem 
> cell transplant")
(2,935 real changes made)

. gen renal_disease_therap= 1 if strpos(high_risk_cohort_therapeutics, "renal d
> isease")
(51,688 missing values generated)

. gen liver_disease_therap= 1 if strpos(high_risk_cohort_therapeutics, "liver d
> isease")
(54,647 missing values generated)

. gen imid_on_drug_therap= 1 if strpos(high_risk_cohort_therapeutics, "IMID")
(45,974 missing values generated)

. gen immunosupression_therap= 1 if strpos(high_risk_cohort_therapeutics, "prim
> ary immune deficiencies")
(51,697 missing values generated)

. gen hiv_aids_therap= 1 if strpos(high_risk_cohort_therapeutics, "HIV or AIDS"
> )
(54,527 missing values generated)

. gen organ_transplant_therap= 1 if strpos(high_risk_cohort_therapeutics, "soli
> d organ recipients")
(57,460 missing values generated)

. replace organ_transplant_therap= 1 if strpos(high_risk_cohort_therapeutics, "
> solid organ transplant")
(5,772 real changes made)

. gen rare_neuro_therap= 1 if strpos(high_risk_cohort_therapeutics, "rare neuro
> logical conditions")
(51,750 missing values generated)

. count if high_risk_cohort_therapeutics!=""&high_risk_cohort_therapeutics!="ot
> her"& min(downs_syndrome_therap,solid_cancer_therap,haem_disease_therap,renal
> _disease_therap,liver_disease_therap,imid_on_drug_therap,immunosupression_the
> rap,hiv_aids_therap,organ_transplant_therap,rare_neuro_therap)==. //check if 
> all diseases have been captured
  2,839

. tab high_risk_cohort_therapeutics if high_risk_cohort_therapeutics!=""&high_r
> isk_cohort_therapeutics!="other"& min(downs_syndrome_therap,solid_cancer_ther
> ap,haem_disease_therap,renal_disease_therap,liver_disease_therap,imid_on_drug
> _therap,immunosupression_therap,hiv_aids_therap,organ_transplant_therap,rare_
> neuro_therap)==.

          high_risk_cohort_therapeutics |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     NA |      2,839      100.00      100.00
----------------------------------------+-----------------------------------
                                  Total |      2,839      100.00

. gen high_risk_cohort_ther= 1 if high_risk_cohort_therapeutics!=""&high_risk_c
> ohort_therapeutics!="other"

. foreach var of varlist downs_syndrome_therap solid_cancer_therap haem_disease
> _therap renal_disease_therap liver_disease_therap imid_on_drug_therap immunos
> upression_therap hiv_aids_therap organ_transplant_therap rare_neuro_therap{
  2.         replace `var'=0 if `var'==. 
  3. }
(51,780 real changes made)
(45,881 real changes made)
(43,100 real changes made)
(51,688 real changes made)
(54,647 real changes made)
(45,974 real changes made)
(51,697 real changes made)
(54,527 real changes made)
(51,688 real changes made)
(51,750 real changes made)

. 
. ** high risk cohort from open codelist from control group
. tab high_risk_cohort_nhsd,m 

high_risk_c |
 ohort_nhsd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,230        2.14        2.14
          1 |     56,230       97.86      100.00
------------+-----------------------------------
      Total |     57,460      100.00

. count if downs_syndrome==1
  10,970

. count if solid_cancer==1
  5,755

. count if haem_disease==1
  27,183

. count if renal_disease==1
  19,713

. count if liver_disease==1
  10,860

. count if imid_on_drug==1
  28,733

. count if hiv_aids==1
  10,897

. count if organ_transplant==1
  17,917

. count if rare_neuro==1
  32,699

. count if imid_on_drug==1 & imid_nhsd==1 & imid_drug==0 //should be 0
  15,531

. count if imid_on_drug==1 & imid_nhsd==0 & imid_drug==1 //should be 0
  603

. count if imid_on_drug==1 & imid_nhsd==1 & imid_drug==1 & downs_syndrome==0 &s
> olid_cancer==0 &haem_disease==0 &renal_disease==0 &liver_disease==0 &immunosu
> pression==0 &hiv_aids==0 &organ_transplant==0 &rare_neuro==0
  32

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1
  553

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 &immun
> osuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate==0 
  535

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 &immun
> osuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate==0 &imid_on_dr
> ug==1
  273

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 &immun
> osuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate==0 &imid_on_dr
> ug==1 &downs_syndrome==0 &solid_cancer==0 &haem_disease==0 &renal_disease==0 
> &liver_disease==0 &immunosupression==0 &hiv_aids==0 &organ_transplant==0 &rar
> e_neuro==0
  7

. replace imid_drug=0 if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_
> nhsd==1 &immunosuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate=
> =0 &imid_on_drug==1 //ignore if steriods<4 scripts in 6m & not coded other im
> id drug 
(273 real changes made)

. replace oral_steroid_drugs_nhsd=0 if oral_steroid_drug_nhsd_6m_count<4 &oral_
> steroid_drugs_nhsd==1 //ignore if steriods<4 scripts in 6m
(553 real changes made)

. count if imid_on_drug==1 & imid_nhsd==1 & imid_drug==0 
  15,688

. replace imid_on_drug=0 if imid_nhsd==1 & imid_drug==0 //ignore if steriods<4 
> & not coded other imid drug 
(15,688 real changes made)

. replace imid_on_drug=0 if imid_nhsd==0 & imid_drug==1 
(487 real changes made)

. gen high_risk_cohort_codelist=((downs_syndrome + solid_cancer + haem_disease 
> + renal_disease + liver_disease + imid_on_drug + immunosupression + hiv_aids 
> + organ_transplant + rare_neuro )>0)

. tab high_risk_cohort_codelist dataset,m 

high_risk_ |
cohort_cod |        dataset
     elist |   control       drug |     Total
-----------+----------------------+----------
         0 |       897      1,055 |     1,952 
         1 |    26,257     29,251 |    55,508 
-----------+----------------------+----------
     Total |    27,154     30,306 |    57,460 

. drop if high_risk_cohort_codelist==0 & dataset==0 //should be same number dro
> pped as change above 
(897 observations deleted)

. tab high_risk_cohort_codelist dataset

high_risk_ |
cohort_cod |        dataset
     elist |   control       drug |     Total
-----------+----------------------+----------
         0 |         0      1,055 |     1,055 
         1 |    26,257     29,251 |    55,508 
-----------+----------------------+----------
     Total |    26,257     30,306 |    56,563 

. bys dataset:count if high_risk_cohort_codelist==. & high_risk_cohort_ther==.

-------------------------------------------------------------------------------
-> dataset = control
  0
-------------------------------------------------------------------------------
-> dataset = drug
  0

. 
. ** combine two high risk cohorts into one 
. foreach var of varlist downs_syndrome solid_cancer haem_disease renal_disease
>  liver_disease imid_on_drug immunosupression hiv_aids organ_transplant rare_n
> euro {
  2.         gen `var'_comb = `var'
  3.         replace `var'_comb = 1 if `var'_therap==1 
  4.         tab `var' `var'_therap 
  5.         tab dataset `var'_comb 
  6. }
(4,487 real changes made)

downs_synd | downs_syndrome_therap
      rome |         0          1 |     Total
-----------+----------------------+----------
         0 |    41,106      4,487 |    45,593 
         1 |     9,861      1,109 |    10,970 
-----------+----------------------+----------
     Total |    50,967      5,596 |    56,563 

           |  downs_syndrome_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    19,020      7,237 |    26,257 
      drug |    22,086      8,220 |    30,306 
-----------+----------------------+----------
     Total |    41,106     15,457 |    56,563 
(10,255 real changes made)

solid_canc |  solid_cancer_therap
        er |         0          1 |     Total
-----------+----------------------+----------
         0 |    40,553     10,255 |    50,808 
         1 |     4,606      1,149 |     5,755 
-----------+----------------------+----------
     Total |    45,159     11,404 |    56,563 

           |   solid_cancer_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    18,875      7,382 |    26,257 
      drug |    21,678      8,628 |    30,306 
-----------+----------------------+----------
     Total |    40,553     16,010 |    56,563 
(7,279 real changes made)

haem_disea |  haem_disease_therap
        se |         0          1 |     Total
-----------+----------------------+----------
         0 |    22,101      7,279 |    29,380 
         1 |    20,338      6,845 |    27,183 
-----------+----------------------+----------
     Total |    42,439     14,124 |    56,563 

           |   haem_disease_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    10,118     16,139 |    26,257 
      drug |    11,983     18,323 |    30,306 
-----------+----------------------+----------
     Total |    22,101     34,462 |    56,563 
(3,693 real changes made)

renal_dise | renal_disease_therap
       ase |         0          1 |     Total
-----------+----------------------+----------
         0 |    33,157      3,693 |    36,850 
         1 |    17,734      1,979 |    19,713 
-----------+----------------------+----------
     Total |    50,891      5,672 |    56,563 

           |  renal_disease_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    15,191     11,066 |    26,257 
      drug |    17,966     12,340 |    30,306 
-----------+----------------------+----------
     Total |    33,157     23,406 |    56,563 
(2,216 real changes made)

liver_dise | liver_disease_therap
       ase |         0          1 |     Total
-----------+----------------------+----------
         0 |    43,487      2,216 |    45,703 
         1 |    10,307        553 |    10,860 
-----------+----------------------+----------
     Total |    53,794      2,769 |    56,563 

           |  liver_disease_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    20,145      6,112 |    26,257 
      drug |    23,342      6,964 |    30,306 
-----------+----------------------+----------
     Total |    43,487     13,076 |    56,563 
(8,827 real changes made)

imid_on_dr |  imid_on_drug_therap
        ug |         0          1 |     Total
-----------+----------------------+----------
         0 |    35,178      8,827 |    44,005 
         1 |    10,072      2,486 |    12,558 
-----------+----------------------+----------
     Total |    45,250     11,313 |    56,563 

           |   imid_on_drug_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    16,273      9,984 |    26,257 
      drug |    18,905     11,401 |    30,306 
-----------+----------------------+----------
     Total |    35,178     21,385 |    56,563 
(5,115 real changes made)

           | immunosupression_ther
immunosupr |          ap
    ession |         0          1 |     Total
-----------+----------------------+----------
         0 |    45,717      5,115 |    50,832 
         1 |     5,176        555 |     5,731 
-----------+----------------------+----------
     Total |    50,893      5,670 |    56,563 

           | immunosupression_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    21,148      5,109 |    26,257 
      drug |    24,569      5,737 |    30,306 
-----------+----------------------+----------
     Total |    45,717     10,846 |    56,563 
(2,299 real changes made)

           |    hiv_aids_therap
  hiv_aids |         0          1 |     Total
-----------+----------------------+----------
         0 |    43,367      2,299 |    45,666 
         1 |    10,304        593 |    10,897 
-----------+----------------------+----------
     Total |    53,671      2,892 |    56,563 

           |     hiv_aids_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    20,062      6,195 |    26,257 
      drug |    23,305      7,001 |    30,306 
-----------+----------------------+----------
     Total |    43,367     13,196 |    56,563 
(3,885 real changes made)

           | organ_transplant_ther
organ_tran |          ap
    splant |         0          1 |     Total
-----------+----------------------+----------
         0 |    34,761      3,885 |    38,646 
         1 |    16,130      1,787 |    17,917 
-----------+----------------------+----------
     Total |    50,891      5,672 |    56,563 

           | organ_transplant_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    16,031     10,226 |    26,257 
      drug |    18,730     11,576 |    30,306 
-----------+----------------------+----------
     Total |    34,761     21,802 |    56,563 
(2,356 real changes made)

           |   rare_neuro_therap
rare_neuro |         0          1 |     Total
-----------+----------------------+----------
         0 |    21,508      2,356 |    23,864 
         1 |    29,460      3,239 |    32,699 
-----------+----------------------+----------
     Total |    50,968      5,595 |    56,563 

           |    rare_neuro_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |     9,747     16,510 |    26,257 
      drug |    11,761     18,545 |    30,306 
-----------+----------------------+----------
     Total |    21,508     35,055 |    56,563 

. 
. ****************************
. *       EXPOSURE                *
. ****************************
. ** removing individuals who did not start therapy
. foreach var of varlist sotrovimab molnupiravir paxlovid {
  2.     display "`var'"
  3.         count if `var'!=.
  4.         count if `var'==date_treated & `var'!=. & date_treated!=.
  5.         count if `var'==date_treated & `var'!=. & date_treated!=. & `var'_
> not_start!=.
  6.         gen `var'_start = 1 if `var'==date_treated & `var'!=. & date_treat
> ed!=. & `var'_not_start==.
  7.         replace `var'_start = 0 if `var'==date_treated & `var'!=. & date_t
> reated!=. & `var'_not_start!=.
  8.         tab `var'_start, m  //number on treatment, first drug given, and d
> rug was started
  9. }
sotrovimab
  570
  564
  5
(56,004 missing values generated)
(5 real changes made)

sotrovimab_ |
      start |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |          5        0.01        0.01
          1 |        559        0.99        1.00
          . |     55,999       99.00      100.00
------------+-----------------------------------
      Total |     56,563      100.00
molnupiravir
  539
  520
  4
(56,047 missing values generated)
(4 real changes made)

molnupiravi |
    r_start |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |          4        0.01        0.01
          1 |        516        0.91        0.92
          . |     56,043       99.08      100.00
------------+-----------------------------------
      Total |     56,563      100.00
paxlovid
  549
  538
  4
(56,029 missing values generated)
(4 real changes made)

paxlovid_st |
        art |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |          4        0.01        0.01
          1 |        534        0.94        0.95
          . |     56,025       99.05      100.00
------------+-----------------------------------
      Total |     56,563      100.00

. gen two_drugs= 1 if sotrovimab_start==1 & paxlovid_start==1
(56,563 missing values generated)

. replace two_drugs=2 if sotrovimab_start==1 & molnupiravir_start==1
(0 real changes made)

. replace two_drugs=3 if paxlovid_start==1 & molnupiravir_start==1
(0 real changes made)

. replace two_drugs=4 if sotrovimab_start==1 & paxlovid_start==1 & molnupiravir
> _start==1
(0 real changes made)

. tab two_drug
no observations

. gen drug=7 if remdesivir==date_treated&remdesivir!=.&date_treated!=.
(56,012 missing values generated)

. replace drug=8 if casirivimab==date_treated&casirivimab!=.&date_treated!=.
(544 real changes made)

. tab drug,m 

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          7 |        551        0.97        0.97
          8 |        544        0.96        1.94
          . |     55,468       98.06      100.00
------------+-----------------------------------
      Total |     56,563      100.00

. replace drug=1 if sotrovimab_start==1 
(559 real changes made)

. replace drug=2 if paxlovid_start==1
(534 real changes made)

. replace drug=3 if molnupiravir_start==1
(516 real changes made)

. tab drug,m 

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        559        0.99        0.99
          2 |        534        0.94        1.93
          3 |        516        0.91        2.84
          7 |        551        0.97        3.82
          8 |        544        0.96        4.78
          . |     53,859       95.22      100.00
------------+-----------------------------------
      Total |     56,563      100.00

. replace drug=4 if sotrovimab==date_treated & sotrovimab_start==0 
(5 real changes made)

. replace drug=5 if paxlovid==date_treated & paxlovid_start==0 
(4 real changes made)

. replace drug=6 if molnupiravir==date_treated & molnupiravir_start==0 
(4 real changes made)

. replace drug=9 if two_drugs!=.
(0 real changes made)

. tab drug,m 

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        559        0.99        0.99
          2 |        534        0.94        1.93
          3 |        516        0.91        2.84
          4 |          5        0.01        2.85
          5 |          4        0.01        2.86
          6 |          4        0.01        2.87
          7 |        551        0.97        3.84
          8 |        544        0.96        4.80
          . |     53,846       95.20      100.00
------------+-----------------------------------
      Total |     56,563      100.00

. replace drug=0 if drug==.
(53,846 real changes made)

. label define drug 0 "control" 1 "sotrovimab" 2 "paxlovid" 3"molnupiravir", re
> place

. label values drug drug

. tab drug, m

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |     53,846       95.20       95.20
  sotrovimab |        559        0.99       96.18
    paxlovid |        534        0.94       97.13
molnupiravir |        516        0.91       98.04
           4 |          5        0.01       98.05
           5 |          4        0.01       98.06
           6 |          4        0.01       98.06
           7 |        551        0.97       99.04
           8 |        544        0.96      100.00
-------------+-----------------------------------
       Total |     56,563      100.00

. bys dataset: tab drug,m

-------------------------------------------------------------------------------
-> dataset = control

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |     25,023       95.30       95.30
  sotrovimab |        251        0.96       96.26
    paxlovid |        241        0.92       97.17
molnupiravir |        242        0.92       98.10
           4 |          2        0.01       98.10
           5 |          1        0.00       98.11
           6 |          2        0.01       98.11
           7 |        253        0.96       99.08
           8 |        242        0.92      100.00
-------------+-----------------------------------
       Total |     26,257      100.00

-------------------------------------------------------------------------------
-> dataset = drug

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |     28,823       95.11       95.11
  sotrovimab |        308        1.02       96.12
    paxlovid |        293        0.97       97.09
molnupiravir |        274        0.90       97.99
           4 |          3        0.01       98.00
           5 |          3        0.01       98.01
           6 |          2        0.01       98.02
           7 |        298        0.98       99.00
           8 |        302        1.00      100.00
-------------+-----------------------------------
       Total |     30,306      100.00


. drop if drug>3
(1,108 observations deleted)

. drop if drug>0 & dataset==0
(734 observations deleted)

. 
. ** start date is date treatment for treatment arms and date of covid test for
>  control arm 
. count if start_date==. //should be 0
  28,823

. count if start_date!=covid_test_positive_date & drug==0  //should be 0
  50,898

. count if start_date!=date_treated & drug>0 //should be 0
  0

. 
. ** check number of positive covid tests prior to drug in treatment arms
. bys drug:count if covid_test_positive_date==. // should be 0 in control arm

-------------------------------------------------------------------------------
-> drug = control
  5,454
-------------------------------------------------------------------------------
-> drug = sotrovimab
  35
-------------------------------------------------------------------------------
-> drug = paxlovid
  22
-------------------------------------------------------------------------------
-> drug = molnupiravir
  23

. bys drug:count if covid_test_positive_date!=. 

-------------------------------------------------------------------------------
-> drug = control
  48,392
-------------------------------------------------------------------------------
-> drug = sotrovimab
  273
-------------------------------------------------------------------------------
-> drug = paxlovid
  271
-------------------------------------------------------------------------------
-> drug = molnupiravir
  251

. bys drug:count if covid_test_positive_date!=.&date_treated!=.& date_treated>c
> ovid_test_positive_date //test prior to treatment

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  148
-------------------------------------------------------------------------------
-> drug = paxlovid
  142
-------------------------------------------------------------------------------
-> drug = molnupiravir
  132

. bys drug:count if covid_test_positive_date!=.&date_treated!=.& (date_treated-
> covid_test_positive_date>0)&(date_treated-covid_test_positive_date<=5) //test
>  <5d

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  3
-------------------------------------------------------------------------------
-> drug = paxlovid
  5
-------------------------------------------------------------------------------
-> drug = molnupiravir
  1

. bys drug:count if covid_test_positive_date2!=.&date_treated!=.& date_treated>
> covid_test_positive_date2 //2nd covid episode prior to treatment 

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  21
-------------------------------------------------------------------------------
-> drug = paxlovid
  8
-------------------------------------------------------------------------------
-> drug = molnupiravir
  16

. bys drug:count if covid_test_positive_date2!=.&date_treated!=.& (date_treated
> -covid_test_positive_date2>0)&(date_treated-covid_test_positive_date2<=5) //t
> est <5d

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug:count if covid_test_positive_date3!=.&date_treated!=.& date_treated>
> covid_test_positive_date3 //3rd covid episode prior to treatment 

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  9
-------------------------------------------------------------------------------
-> drug = paxlovid
  17
-------------------------------------------------------------------------------
-> drug = molnupiravir
  21

. bys drug:count if covid_test_positive_date3!=.&date_treated!=.& (date_treated
> -covid_test_positive_date3>0)&(date_treated-covid_test_positive_date3<=5) //t
> est <5d

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  1
-------------------------------------------------------------------------------
-> drug = paxlovid
  1
-------------------------------------------------------------------------------
-> drug = molnupiravir
  1

. ** check in control group that covid positive, and not repeat covid test afte
> r an infection within 30 days prior
. tab covid_test_positive covid_positive_previous_30_days if drug==0

           | covid_positive_previo
covid_test |      us_30_days
 _positive |         0          1 |     Total
-----------+----------------------+----------
         0 |     5,140        268 |     5,408 
         1 |    46,016      2,422 |    48,438 
-----------+----------------------+----------
     Total |    51,156      2,690 |    53,846 

. drop if drug==0 & covid_test_positive==1 & covid_positive_previous_30_days==1
(2,422 observations deleted)

. ** gen study start and study end date
. gen campaign_start=mdy(12,16,2021)

. gen study_end_date=mdy(09,01,2023)

. gen start_date_29=start_date + 29
(27,524 missing values generated)

. format campaign_start study_end_date start_date_29 %td

. 
. ****************************
. *       OUTCOME         *
. ****************************
. *** AESI, IMAE and some Drug reaction (need to add further IMAE and DRESS, SJ
> S, TEN) 
. gen new_ae_ra_icd = ae_rheumatoid_arthritis_icd if rheumatoid_arthritis_nhsd_
> snomed==0 
(33,414 missing values generated)

. gen new_ae_ra_icd_prim = ae_rheumatoid_arthritis_icd_prim if rheumatoid_arthr
> itis_nhsd_snomed==0 
(33,470 missing values generated)

. gen new_ae_ra_snomed = ae_rheumatoid_arthritis_snomed if rheumatoid_arthritis
> _nhsd_snomed==0 
(33,421 missing values generated)

. gen new_ae_ra_ae = ae_rheumatoid_arthritis_ae if rheumatoid_arthritis_nhsd_sn
> omed==0
(33,710 missing values generated)

. count if rheumatoid_arthritis_nhsd_snomed!=0 
  5,195

. count if ae_rheumatoid_arthritis_icd!=. 
  20,922

. count if new_ae_ra_icd!=.
  18,885

. count if ae_rheumatoid_arthritis_icd_prim!=. 
  20,954

. count if new_ae_ra_icd_prim!=.
  18,829

. count if ae_rheumatoid_arthritis_snomed!=. 
  20,920

. count if new_ae_ra_snomed!=.
  18,878

. count if ae_rheumatoid_arthritis_ae!=. 
  20,669

. count if new_ae_ra_ae!=.
  18,589

. gen new_ae_sle_icd = ae_sle_icd if sle_nhsd_ctv==0 
(33,499 missing values generated)

. gen new_ae_sle_icd_prim = ae_sle_icd_prim if sle_nhsd_ctv==0 
(33,546 missing values generated)

. gen new_ae_sle_ctv = ae_sle_ctv if sle_nhsd_ctv==0 
(33,453 missing values generated)

. gen new_ae_sle_ae = ae_sle_ae if sle_nhsd_ctv==0 
(33,476 missing values generated)

. count if sle_nhsd_ctv!=0 
  5,299

. count if ae_sle_icd!=. 
  20,902

. count if new_ae_sle_icd!=.
  18,800

. count if ae_sle_icd_prim!=. 
  20,949

. count if new_ae_sle_icd_prim!=.
  18,753

. count if ae_sle_ctv!=. 
  20,939

. count if new_ae_sle_ctv!=.
  18,846

. count if ae_sle_ae!=. 
  20,896

. count if new_ae_sle_ae!=.
  18,823

. gen new_ae_psoriasis_icd = ae_psoriasis_icd if psoriasis_nhsd==0 
(33,429 missing values generated)

. gen new_ae_psoriasis_icd_prim = ae_psoriasis_icd_prim if psoriasis_nhsd==0 
(33,364 missing values generated)

. gen new_ae_psoriasis_snomed = ae_psoriasis_snomed if psoriasis_nhsd==0
(33,530 missing values generated)

. gen new_ae_psoriasis_ae = ae_psoriasis_ae if psoriasis_nhsd==0
(33,607 missing values generated)

. count if psoriasis_nhsd!=0 
  5,174

. count if ae_psoriasis_icd!=. 
  20,879

. count if new_ae_psoriasis_icd!=. 
  18,870

. count if ae_psoriasis_icd_prim!=. 
  21,037

. count if new_ae_psoriasis_icd_prim!=. 
  18,935

. count if ae_psoriasis_snomed!=. 
  20,861

. count if new_ae_psoriasis_snomed!=.
  18,769

. count if ae_psoriasis_ae!=. 
  20,768

. count if new_ae_psoriasis_ae!=.
  18,692

. gen new_ae_psa_icd = ae_psa_icd if psoriatic_arthritis_nhsd==0
(33,544 missing values generated)

. gen new_ae_psa_icd_prim = ae_psa_icd_prim if psoriatic_arthritis_nhsd==0
(33,383 missing values generated)

. gen new_ae_psa_snomed = ae_psa_snomed if psoriatic_arthritis_nhsd==0
(33,460 missing values generated)

. gen new_ae_psa_ae = ae_psa_ae if psoriatic_arthritis_nhsd==0
(33,558 missing values generated)

. count if psoriatic_arthritis_nhsd!=0 
  5,231

. count if ae_psa_icd!=. 
  20,867

. count if new_ae_psa_icd!=. 
  18,755

. count if ae_psa_icd_prim!=. 
  20,988

. count if new_ae_psa_icd_prim!=. 
  18,916

. count if ae_psa_snomed!=. 
  20,845

. count if new_ae_psa_snomed!=.
  18,839

. count if ae_psa_ae!=. 
  20,852

. count if new_ae_psa_ae!=.
  18,741

. gen new_ae_axspa_icd = ae_axspa_icd if ankylosing_spondylitis_nhsd==0
(33,542 missing values generated)

. gen new_ae_axspa_icd_prim = ae_axspa_icd_prim if ankylosing_spondylitis_nhsd=
> =0
(33,426 missing values generated)

. gen new_ae_axspa_ctv = ae_axspa_ctv if ankylosing_spondylitis_nhsd==0
(33,407 missing values generated)

. gen new_ae_axspa_ae = ae_axspa_ae if ankylosing_spondylitis_nhsd==0
(33,379 missing values generated)

. count if ankylosing_spondylitis_nhsd!=0 
  5,170

. count if ae_axspa_icd!=. 
  20,825

. count if new_ae_axspa_icd!=.
  18,757

. count if ae_axspa_icd_prim!=. 
  20,940

. count if new_ae_axspa_icd_prim!=.
  18,873

. count if ae_axspa_ctv!=. 
  20,930

. count if new_ae_axspa_ctv!=.
  18,892

. count if ae_axspa_ae!=. 
  20,957

. count if new_ae_axspa_ae!=.
  18,920

. gen new_ae_ibd_icd = ae_ibd_icd if ibd_ctv==0
(33,414 missing values generated)

. gen new_ae_ibd_icd_prim = ae_ibd_icd_prim if ibd_ctv==0
(33,466 missing values generated)

. gen new_ae_ibd_ctv = ae_ibd_ctv if ibd_ctv==0
(33,539 missing values generated)

. gen new_ae_ibd_ae = ae_ibd_ae if ibd_ctv==0
(33,421 missing values generated)

. count if ibd_ctv!=0 
  5,228

. count if ae_ibd_icd!=. 
  20,895

. count if new_ae_ibd_icd!=.
  18,885

. count if ae_ibd_icd_prim!=. 
  20,957

. count if new_ae_ibd_icd_prim!=.
  18,833

. count if ae_ibd_ctv!=. 
  20,882

. count if new_ae_ibd_ctv!=.
  18,760

. count if ae_ibd_ae!=. 
  20,931

. count if new_ae_ibd_ae!=.
  18,878

.         
. *** comparison of ICD admission primary diagnosis and all diagnoses
. count if ae_diverticulitis_icd!=.
  21,066

. count if ae_diverticulitis_icd_prim!=.
  20,921

. count if ae_taste_icd!=.
  20,916

. count if ae_taste_icd_prim!=.
  20,901

. count if ae_rash_icd!=.
  20,962

. count if ae_rash_icd_prim!=.
  20,880

. count if ae_diarrhoea_icd!=.                                    
  20,886

. count if ae_diarrhoea_icd_prim!=.                                       
  20,900

. count if ae_diarrhoeal_icd!=.                                   
  20,846

. count if ae_diarrhoeal_icd_prim!=.      
  20,929

. count if ae_anaphylaxis_icd!=.
  20,910

. count if ae_anaphylaxis_icd_prim!=.
  20,949

. count if ae_severedrug_icd!=.
  20,914

. count if ae_severedrug_icd_prim!=.
  20,854

. count if ae_severedrug_sjs_icd!=.
  21,075

. count if ae_severedrug_sjs_icd_prim!=.
  20,872

. 
. *** combined ae from GP, hosp and A&E
. egen ae_diverticulitis = rmin(ae_diverticulitis_snomed ae_diverticulitis_icd_
> prim ae_diverticulitis_ae)
(11343 missing values generated)

. egen ae_diarrhoea = rmin(ae_diarrhoea_snomed ae_diarrhoea_icd_prim ae_diarrho
> eal_icd_prim)
(11242 missing values generated)

. egen ae_taste = rmin(ae_taste_snomed ae_taste_icd_prim)
(18846 missing values generated)

. egen ae_rash = rmin(ae_rash_snomed ae_rash_icd_prim ae_rash_ae)
(11147 missing values generated)

. egen ae_anaphylaxis = rmin(ae_anaphylaxis_snomed ae_anaphlaxis_ae ae_anaphyla
> xis_icd_prim)
(11282 missing values generated)

. egen ae_severe_drug = rmin(ae_severedrug_icd_prim ae_severedrug_sjs_icd_prim 
> ae_severedrug_snomed ae_severedrug_ae)
(6824 missing values generated)

. egen ae_nonsevere_drug = rmin(ae_nonsevere_drug_snomed ae_nonsevere_drug_ae)
(18795 missing values generated)

. egen ae_ra = rmin(new_ae_ra_snomed new_ae_ra_icd_prim new_ae_ra_ae)
(15591 missing values generated)

. egen ae_sle = rmin(new_ae_sle_ctv new_ae_sle_icd_prim new_ae_sle_ae)
(15583 missing values generated)

. egen ae_psorasis = rmin(new_ae_psoriasis_icd_prim new_ae_psoriasis_snomed new
> _ae_psoriasis_ae)
(15526 missing values generated)

. egen ae_psa = rmin(new_ae_psa_icd_prim new_ae_psa_snomed new_ae_psa_ae)
(15445 missing values generated)

. egen ae_axspa = rmin(new_ae_axspa_icd_prim new_ae_axspa_ctv new_ae_axspa_ae)
(15317 missing values generated)

. egen ae_ibd = rmin(new_ae_ibd_icd_prim new_ae_ibd_ctv new_ae_ibd_ae)
(15356 missing values generated)

. 
. *** global all ae
. global ae_spc_gp                ae_diverticulitis_snomed                ///
>                                                 ae_diarrhoea_snomed          
>                    ///
>                                                 ae_taste_snomed              
>                    ///             
>                                                 ae_rash_snomed               
>                            

. global ae_spc_icd               ae_diverticulitis_icd_prim              ///
>                                                 ae_taste_icd_prim            
>                    ///
>                                                 ae_rash_icd_prim             
>                    ///
>                                                 ae_diarrhoea_icd_prim        
>            ///
>                                                 ae_diarrhoeal_icd_prim

. global ae_spc_emerg             ae_diverticulitis_ae                    ///
>                                                 ae_rash_ae                   
>                                            

. global ae_drug_gp               ae_anaphylaxis_snomed                   ///  
>    
>                                                 ae_severedrug_snomed         
>            ///
>                                                 ae_nonsevere_drug_snomed     
>                            

. global ae_drug_icd              ae_anaphylaxis_icd_prim                 ///
>                                                 ae_severedrug_icd_prim       
>            ///     
>                                                 ae_severedrug_sjs_icd_prim   
>            

. global ae_drug_emerg    ae_anaphlaxis_ae                                ///
>                                                 ae_severedrug_ae             
>                    ///
>                                                 ae_nonsevere_drug_ae         
>                            

. global ae_imae_gp               new_ae_ra_snomed                             
>    ///
>                                                 new_ae_sle_ctv               
>                    ///
>                                                 new_ae_psoriasis_snomed      
>            ///
>                                                 new_ae_psa_snomed            
>                    ///
>                                                 new_ae_axspa_ctv             
>                    ///
>                                                 new_ae_ibd_ctv  

. global ae_imae_icd              new_ae_ra_icd_prim                           
>    ///
>                                                 new_ae_sle_icd_prim          
>                    ///
>                                                 new_ae_psoriasis_icd_prim    
>            ///
>                                                 new_ae_psa_icd_prim          
>                    ///
>                                                 new_ae_axspa_icd_prim        
>            ///
>                                                 new_ae_ibd_icd_prim

. global ae_imae_emerg    new_ae_ra_ae                                    ///
>                                                 new_ae_sle_ae                
>                    ///
>                                                 new_ae_psoriasis_ae          
>                    ///
>                                                 new_ae_psa_ae                
>                    ///
>                                                 new_ae_axspa_ae              
>                    ///
>                                                 new_ae_ibd_ae   

. global ae_disease               ae_diverticulitis                            
>    ///
>                                                 ae_diarrhoea                 
>                    ///
>                                                 ae_taste                     
>                            ///
>                                                 ae_rash                      
>                            ///
>                                                 ae_anaphylaxis               
>                    ///
>                                                 ae_severe_drug               
>                    ///
>                                                 ae_nonsevere_drug            
>                    ///
>                                                 ae_ra                        
>                            ///
>                                                 ae_sle                       
>                            ///
>                                                 ae_psorasis                  
>                    ///
>                                                 ae_psa                       
>                            ///
>                                                 ae_axspa                     
>                            ///
>                                                 ae_ibd                       
>            

.                                                                         
. *remove event if occurred before start
. foreach x in $ae_spc $ae_spc_icd $ae_spc_emerg $ae_drug $ae_drug_icd $ae_drug
> _emerg $ae_imae $ae_imae_icd $ae_imae_emerg $ae_disease{
  2.                                 display "`x'"
  3.                                 count if (`x' > start_date | `x' < start_d
> ate + 28) & `x'!=. 
  4.                                 count if (`x' < start_date | `x' > start_d
> ate + 28) & `x'!=. & drug==0
  5.                                 count if (`x' < start_date | `x' > start_d
> ate + 28) & `x'!=. & drug>0
  6. }
ae_diverticulitis_icd_prim
  20,921
  20,098
  335
ae_taste_icd_prim
  20,901
  20,119
  311
ae_rash_icd_prim
  20,880
  20,078
  337
ae_diarrhoea_icd_prim
  20,900
  20,112
  335
ae_diarrhoeal_icd_prim
  20,929
  20,091
  340
ae_diverticulitis_ae
  20,975
  20,199
  319
ae_rash_ae
  20,925
  20,134
  332
ae_anaphylaxis_icd_prim
  20,949
  20,183
  329
ae_severedrug_icd_prim
  20,854
  20,020
  346
ae_severedrug_sjs_icd_prim
  20,872
  20,106
  320
ae_anaphlaxis_ae
  20,905
  20,122
  320
ae_severedrug_ae
  21,003
  20,220
  326
ae_nonsevere_drug_ae
  20,841
  20,019
  344
new_ae_ra_icd_prim
  18,829
  18,114
  287
new_ae_sle_icd_prim
  18,753
  18,017
  296
new_ae_psoriasis_icd_prim
  18,935
  18,206
  302
new_ae_psa_icd_prim
  18,916
  18,210
  318
new_ae_axspa_icd_prim
  18,873
  18,158
  301
new_ae_ibd_icd_prim
  18,833
  18,103
  301
new_ae_ra_ae
  18,589
  17,878
  295
new_ae_sle_ae
  18,823
  18,091
  322
new_ae_psoriasis_ae
  18,692
  17,972
  302
new_ae_psa_ae
  18,741
  18,022
  297
new_ae_axspa_ae
  18,920
  18,185
  311
new_ae_ibd_ae
  18,878
  18,177
  290
ae_diverticulitis
  40,956
  39,365
  661
ae_diarrhoea
  41,057
  39,483
  651
ae_taste
  33,453
  32,204
  536
ae_rash
  41,152
  39,577
  659
ae_anaphylaxis
  41,017
  39,544
  637
ae_severe_drug
  45,475
  43,731
  729
ae_nonsevere_drug
  33,504
  32,224
  538
ae_ra
  36,708
  35,351
  558
ae_sle
  36,716
  35,313
  599
ae_psorasis
  36,773
  35,398
  590
ae_psa
  36,854
  35,470
  599
ae_axspa
  36,982
  35,632
  572
ae_ibd
  36,943
  35,535
  593

. egen ae_spc_gp = rmin($ae_spc)
(52299 missing values generated)

. egen ae_spc_serious = rmin($ae_spc_icd)
(3950 missing values generated)

. egen ae_spc_emerg = rmin($ae_spc_emerg)
(18796 missing values generated)

. egen ae_spc_all = rmin($ae_spc $ae_spc_icd $ae_spc_emerg)
(1412 missing values generated)

. egen ae_drug_gp = rmin($ae_drug)
(52299 missing values generated)

. egen ae_drug_serious = rmin($ae_drug_icd)
(11366 missing values generated)

. egen ae_drug_emerg = rmin($ae_drug_emerg)
(11348 missing values generated)

. egen ae_drug_all = rmin($ae_drug $ae_drug_icd $ae_drug_emerg)
(2387 missing values generated)

. egen ae_imae_gp = rmin($ae_imae)
(52299 missing values generated)

. egen ae_imae_serious = rmin($ae_imae_icd)
(3580 missing values generated)

. egen ae_imae_emerg = rmin($ae_imae_emerg)
(3619 missing values generated)

. egen ae_imae_all = rmin($ae_imae $ae_imae_icd $ae_imae_emerg)   
(325 missing values generated)

. egen ae_all = rmin($ae_spc $ae_spc_icd $ae_spc_emerg $ae_drug $ae_drug_icd $a
> e_drug_emerg $ae_imae $ae_imae_icd $ae_imae_emerg)
(1 missing value generated)

. egen ae_all_serious = rmin($ae_spc_icd $ae_spc_emerg $ae_drug_icd $ae_drug_em
> erg $ae_imae_icd $ae_imae_emerg)
(1 missing value generated)

. by drug, sort: count if ae_spc_all!=.

-------------------------------------------------------------------------------
-> drug = control
  50,033
-------------------------------------------------------------------------------
-> drug = sotrovimab
  300
-------------------------------------------------------------------------------
-> drug = paxlovid
  287
-------------------------------------------------------------------------------
-> drug = molnupiravir
  267

. by drug, sort: count if ae_drug_all!=.

-------------------------------------------------------------------------------
-> drug = control
  49,081
-------------------------------------------------------------------------------
-> drug = sotrovimab
  291
-------------------------------------------------------------------------------
-> drug = paxlovid
  275
-------------------------------------------------------------------------------
-> drug = molnupiravir
  265

. by drug, sort: count if ae_imae_all!=.

-------------------------------------------------------------------------------
-> drug = control
  51,108
-------------------------------------------------------------------------------
-> drug = sotrovimab
  305
-------------------------------------------------------------------------------
-> drug = paxlovid
  290
-------------------------------------------------------------------------------
-> drug = molnupiravir
  271

. by drug, sort: count if ae_all!=.

-------------------------------------------------------------------------------
-> drug = control
  51,423
-------------------------------------------------------------------------------
-> drug = sotrovimab
  308
-------------------------------------------------------------------------------
-> drug = paxlovid
  293
-------------------------------------------------------------------------------
-> drug = molnupiravir
  274

. 
. *** Secondary outcome - SAEs hospitalisation or death including COVID-19 
. * death
. bys drug: count if died_date_ons!=.

-------------------------------------------------------------------------------
-> drug = control
  30,721
-------------------------------------------------------------------------------
-> drug = sotrovimab
  181
-------------------------------------------------------------------------------
-> drug = paxlovid
  182
-------------------------------------------------------------------------------
-> drug = molnupiravir
  166

. 
. * a&e all admission
. bys drug: count if allcause_emerg_aande!=.

-------------------------------------------------------------------------------
-> drug = control
  2,581
-------------------------------------------------------------------------------
-> drug = sotrovimab
  22
-------------------------------------------------------------------------------
-> drug = paxlovid
  12
-------------------------------------------------------------------------------
-> drug = molnupiravir
  21

. 
. *covid admission
. // checking admission and discharge date; missing admission, missing dischagr
> e, or dischagre preceed admission 
. count if covid_hosp_date!=.&covid_discharge_date==.
  5,199

. count if covid_hosp_date==.&covid_discharge_date!=.
  476

. count if covid_hosp_date!=.&covid_discharge_date!=.&covid_hosp_date==covid_di
> scharge_date
  0

. count if covid_hosp_date!=.&covid_discharge_date!=.&covid_hosp_date<covid_dis
> charge_date
  34

. count if covid_hosp_date!=.&covid_discharge_date!=.&covid_hosp_date>covid_dis
> charge_date
  29

. // all covid hospitalisation
. bys drug: count if covid_hosp_date!=. 

-------------------------------------------------------------------------------
-> drug = control
  5,153
-------------------------------------------------------------------------------
-> drug = sotrovimab
  40
-------------------------------------------------------------------------------
-> drug = paxlovid
  35
-------------------------------------------------------------------------------
-> drug = molnupiravir
  34

. // covid admission on treatment date (control group will not have covid_hosp_
> date0)
. bys drug: count if covid_hosp_date0!=. 

-------------------------------------------------------------------------------
-> drug = control
  507
-------------------------------------------------------------------------------
-> drug = sotrovimab
  5
-------------------------------------------------------------------------------
-> drug = paxlovid
  8
-------------------------------------------------------------------------------
-> drug = molnupiravir
  2

. //  covid admission is the same as date treated 
. bys drug: count if covid_hosp_date0==date_treated&covid_hosp_date0!=.&date_tr
> eated!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==(date_treated+1) &covid_hosp_date1!=.&da
> te_treated!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // covid admission is the same  as date treated and is a daycase
. bys drug: count if covid_hosp_date0==covid_discharge_date0&covid_hosp_date0!=
> .

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_discharge_date1&covid_hosp_date1!=
> .

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // covid admission is the same date as mab
. bys drug: count if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date_mab
> s!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date_mab
> s!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // covid admission is the same date as mab and is a daycase or 24 hour admiss
> ion
. bys drug: count if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date0!=.
> &covid_hosp_date0==covid_discharge_date0

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date1!=.
> &covid_hosp_date1==covid_discharge_date1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date0!=.
> &(covid_discharge_date0 - covid_hosp_date0)==1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date1!=.
> &(covid_discharge_date1 - covid_hosp_date1)==1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // REPLACE - ignore covid admission if admission is the day 0 or day 1 after 
> treatment date treated AND a day case
. replace covid_hosp_date=. if covid_hosp_date0==covid_discharge_date0&covid_ho
> sp_date0!=.
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date1==covid_discharge_date1&covid_ho
> sp_date1!=.  
(0 real changes made)

. // REPLACE - ignore covid admission if admission is the day 0 or day 1 after 
> treatment date AND a mab procedures 
. replace covid_hosp_date=. if covid_hosp_date0==covid_hosp_date_mabs&covid_hos
> p_date0!=.&covid_hosp_date0==covid_discharge_date0
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date1==covid_hosp_date_mabs&covid_hos
> p_date1!=.&covid_hosp_date1==covid_discharge_date1
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date0==covid_hosp_date_mabs&covid_hos
> p_date0!=.&(covid_discharge_date0 - covid_hosp_date0)==1
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date1==covid_hosp_date_mabs&covid_hos
> p_date1!=.&(covid_discharge_date1 - covid_hosp_date1)==1
(0 real changes made)

. 
. *hosp admission
. // checking admission and discharge date; missing admission, missing dischagr
> e, or dischagre preceed admission 
. count if all_hosp_date!=.&hosp_discharge_date==.
  4,639

. count if all_hosp_date==.&hosp_discharge_date!=.
  4,656

. count if all_hosp_date!=.&hosp_discharge_date!=.&all_hosp_date==hosp_discharg
> e_date
  0

. count if all_hosp_date!=.&hosp_discharge_date!=.&all_hosp_date<hosp_discharge
> _date
  282

. count if all_hosp_date!=.&hosp_discharge_date!=.&all_hosp_date>hosp_discharge
> _date
  246

. // all hospitalisation
. bys drug: count if all_hosp_date!=.

-------------------------------------------------------------------------------
-> drug = control
  5,086
-------------------------------------------------------------------------------
-> drug = sotrovimab
  25
-------------------------------------------------------------------------------
-> drug = paxlovid
  24
-------------------------------------------------------------------------------
-> drug = molnupiravir
  32

. // admission on treatment date (control group will not have hosp_date0)
. bys drug: count if all_hosp_date0!=. 

-------------------------------------------------------------------------------
-> drug = control
  517
-------------------------------------------------------------------------------
-> drug = sotrovimab
  3
-------------------------------------------------------------------------------
-> drug = paxlovid
  1
-------------------------------------------------------------------------------
-> drug = molnupiravir
  2

. // admission is the same date as date treated 
. bys drug: count if all_hosp_date0==date_treated&all_hosp_date0!=.&date_treate
> d!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==(date_treated+1) &all_hosp_date1!=.&date_t
> reated!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // admission is the same date as date treated and is a daycase
. bys drug: count if all_hosp_date0==hosp_discharge_date0&all_hosp_date0!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==hosp_discharge_date1&all_hosp_date1!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // admission is for Covid and is the same date as date treated and is a dayca
> se
. bys drug: count if all_hosp_date0==covid_hosp_date0  & all_hosp_date0==hosp_d
> ischarge_date0&all_hosp_date0!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==hosp_di
> scharge_date1&all_hosp_date1!=.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. //  admission is the same date as mab
. bys drug: count if all_hosp_date0==covid_hosp_date_mabs&covid_hosp_date_mabs!
> =.

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date_mabs&covid_hosp_date_mabs!
> =.

-------------------------------------------------------------------------------
-> drug = control
  1
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. //  admission is the same date as mab and is a daycase, 1 day admission
. bys drug: count if all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&all
> _hosp_date0==hosp_discharge_date0

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&all
> _hosp_date1==hosp_discharge_date1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&(ho
> sp_discharge_date0-all_hosp_date0)==1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&(ho
> sp_discharge_date1-all_hosp_date1)==1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. //  admission is is for Covid and the same date as mab and is a daycase, 1 da
> y admission
. bys drug: count if all_hosp_date0==covid_hosp_date0 & all_hosp_date0==covid_h
> osp_date_mabs&all_hosp_date0!=.&all_hosp_date0==hosp_discharge_date0

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==covid_h
> osp_date_mabs&all_hosp_date1!=.&all_hosp_date1==hosp_discharge_date1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date0==covid_hosp_date0 & all_hosp_date0==covid_h
> osp_date_mabs&all_hosp_date0!=.&(hosp_discharge_date0-all_hosp_date0)==1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==covid_h
> osp_date_mabs&all_hosp_date1!=.&(hosp_discharge_date1-all_hosp_date1)==1

-------------------------------------------------------------------------------
-> drug = control
  0
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  0
-------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // REPLACE - ignore covid admission if admission is for covid AND day 0 or da
> y 1 after treatment AND daycase
. replace all_hosp_date=. if all_hosp_date0==covid_hosp_date0 & all_hosp_date0=
> =hosp_discharge_date0 & all_hosp_date0!=.
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date1==covid_hosp_date1 & all_hosp_date1=
> =hosp_discharge_date1 & all_hosp_date1!=.
(0 real changes made)

. // REPLACE - ignore admission if admission is for covid AND day 0 or day 1 af
> ter treatment 
. replace all_hosp_date=. if all_hosp_date0==covid_hosp_date0 & all_hosp_date0=
> =covid_hosp_date_mabs&all_hosp_date0!=.&all_hosp_date0==hosp_discharge_date0
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date1==covid_hosp_date1 & all_hosp_date1=
> =covid_hosp_date_mabs&all_hosp_date1!=.&all_hosp_date1==hosp_discharge_date1
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date0==covid_hosp_date0 & all_hosp_date0=
> =covid_hosp_date_mabs&all_hosp_date0!=.&(hosp_discharge_date0 - all_hosp_date
> 0)==1
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date1==covid_hosp_date1 & all_hosp_date1=
> =covid_hosp_date_mabs&all_hosp_date1!=.&(hosp_discharge_date1 - all_hosp_date
> 1)==1
(0 real changes made)

. 
. foreach var of varlist allcause_emerg_aande covid_hosp_date all_hosp_date die
> d_date_ons{
  2.                                 display "`var'"
  3.                                 bys drug: count if (`var' >= start_date & 
> `var' <= start_date + 28) & `var'!=.                          
  4.                                 bys drug: count if (`var' < start_date | `
> var' > start_date + 28) & `var'!=.                            
  5. }
allcause_emerg_aande

-------------------------------------------------------------------------------
-> drug = control
  55
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  1
-------------------------------------------------------------------------------
-> drug = molnupiravir
  1

-------------------------------------------------------------------------------
-> drug = control
  2,526
-------------------------------------------------------------------------------
-> drug = sotrovimab
  22
-------------------------------------------------------------------------------
-> drug = paxlovid
  11
-------------------------------------------------------------------------------
-> drug = molnupiravir
  20
covid_hosp_date

-------------------------------------------------------------------------------
-> drug = control
  139
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  2
-------------------------------------------------------------------------------
-> drug = molnupiravir
  2

-------------------------------------------------------------------------------
-> drug = control
  5,014
-------------------------------------------------------------------------------
-> drug = sotrovimab
  36
-------------------------------------------------------------------------------
-> drug = paxlovid
  33
-------------------------------------------------------------------------------
-> drug = molnupiravir
  32
all_hosp_date

-------------------------------------------------------------------------------
-> drug = control
  131
-------------------------------------------------------------------------------
-> drug = sotrovimab
  1
-------------------------------------------------------------------------------
-> drug = paxlovid
  2
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3

-------------------------------------------------------------------------------
-> drug = control
  4,955
-------------------------------------------------------------------------------
-> drug = sotrovimab
  24
-------------------------------------------------------------------------------
-> drug = paxlovid
  22
-------------------------------------------------------------------------------
-> drug = molnupiravir
  29
died_date_ons

-------------------------------------------------------------------------------
-> drug = control
  434
-------------------------------------------------------------------------------
-> drug = sotrovimab
  3
-------------------------------------------------------------------------------
-> drug = paxlovid
  7
-------------------------------------------------------------------------------
-> drug = molnupiravir
  4

-------------------------------------------------------------------------------
-> drug = control
  30,287
-------------------------------------------------------------------------------
-> drug = sotrovimab
  178
-------------------------------------------------------------------------------
-> drug = paxlovid
  175
-------------------------------------------------------------------------------
-> drug = molnupiravir
  162

. 
. ****************************
. *       COVARIATES              *
. ****************************
. *Time between 1st positive covid test and treatment*
. gen pre_drug_test=3 if drug>0 & covid_test_positive_date!=. &(date_treated-co
> vid_test_positive_date>0)&(date_treated-covid_test_positive_date<21)
(52,273 missing values generated)

. replace pre_drug_test=2 if drug>0 & covid_test_positive_date!=. &(date_treate
> d-covid_test_positive_date>0)&(date_treated-covid_test_positive_date<=7)
(11 real changes made)

. replace pre_drug_test=1 if drug>0 & covid_test_positive_date!=. &(date_treate
> d-covid_test_positive_date>0)&(date_treated-covid_test_positive_date<=5)
(9 real changes made)

. replace pre_drug_test=0 if drug>0 & covid_test_positive_date!=. &(date_treate
> d-covid_test_positive_date>=0)&(date_treated-covid_test_positive_date<=3)
(5 real changes made)

. replace pre_drug_test=4 if drug>0 & (date_treated-covid_test_positive_date<0)
>  & (date_treated-covid_test_positive_date>-7)
(4 real changes made)

. replace pre_drug_test=5 if drug>0 & (covid_test_positive_date==. | (date_trea
> ted-covid_test_positive_date<=-7) | (date_treated-covid_test_positive_date>=2
> 1)) 
(845 real changes made)

. label define pre_drug_test 0 "<3 days" 1 "3-5 days"  2 "5-7 days" 3 ">7 days 
> & <21 days" 4 "treatment proceeds test <7 days" 5 "no test", replace 

. label values pre_drug_test pre_drug_test

. tab pre_drug_test drug,m

                      |                    drug
        pre_drug_test |   control  sotrovima   paxlovid  molnupira |     Total
----------------------+--------------------------------------------+----------
              <3 days |         0          2          3          0 |         5 
             3-5 days |         0          1          2          1 |         4 
             5-7 days |         0          1          0          1 |         2 
   >7 days & <21 days |         0          6          1          8 |        15 
treatment proceeds te |         0          0          1          3 |         4 
              no test |         0        298        286        261 |       845 
                    . |    51,424          0          0          0 |    51,424 
----------------------+--------------------------------------------+----------
                Total |    51,424        308        293        274 |    52,299 

. 
. * Demographics*
. * Age
. sum age

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     52,299    48.76866    18.97532         18        109

. gen age_group=(age>=40)+(age>=60)

. label define age_group 0 "18-39" 1 "40-59" 2 ">=60" 

. label values age_group age_group

. egen age_5y_band=cut(age), at(18,25,30,35,40,45,50,55,60,65,70,75,80,85,110) 
> label

. tab age_group,m

  age_group |      Freq.     Percent        Cum.
------------+-----------------------------------
      18-39 |     19,106       36.53       36.53
      40-59 |     17,464       33.39       69.92
       >=60 |     15,729       30.08      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. tab age_5y_band,m

age_5y_band |      Freq.     Percent        Cum.
------------+-----------------------------------
        18- |      5,699       10.90       10.90
        25- |      4,634        8.86       19.76
        30- |      4,400        8.41       28.17
        35- |      4,373        8.36       36.53
        40- |      3,955        7.56       44.09
        45- |      4,450        8.51       52.60
        50- |      4,717        9.02       61.62
        55- |      4,342        8.30       69.92
        60- |      3,740        7.15       77.08
        65- |      3,358        6.42       83.50
        70- |      3,189        6.10       89.59
        75- |      2,194        4.20       93.79
        80- |      1,612        3.08       96.87
        85- |      1,636        3.13      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. * Sex
. gen male = 1 if sex == "M"
(26,568 missing values generated)

. replace male = 0 if sex == "F"
(26,568 real changes made)

. rename sex sex_str

. gen sex=0 if sex_str=="M"
(26,568 missing values generated)

. replace sex=1 if sex_str=="F"
(26,568 real changes made)

. label define sex 0 "Male" 1 "Female"

. label values sex sex

. tab sex

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
       Male |     25,731       49.20       49.20
     Female |     26,568       50.80      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. * Ethnicity
. tab ethnicity,m

  ethnicity |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     31,324       59.89       59.89
      Black |      2,182        4.17       64.07
      Mixed |      2,074        3.97       68.03
      Other |      2,039        3.90       71.93
South Asian |      2,165        4.14       76.07
      White |     12,515       23.93      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. rename ethnicity ethnicity_str

. encode  ethnicity_str, gen(ethnicity)

. label list ethnicity
ethnicity:
           1 Black
           2 Mixed
           3 Other
           4 South Asian
           5 White

. replace ethnicity=. if ethnicity==2 
(2,074 real changes made, 2,074 to missing)

. tab ethnicity                           

  ethnicity |      Freq.     Percent        Cum.
------------+-----------------------------------
      Black |      2,182       11.54       11.54
      Other |      2,039       10.79       22.33
South Asian |      2,165       11.45       33.79
      White |     12,515       66.21      100.00
------------+-----------------------------------
      Total |     18,901      100.00

. gen ethnicity_with_missing=ethnicity
(33,398 missing values generated)

. replace ethnicity_with_missing=9 if ethnicity_with_missing==.
(33,398 real changes made)

. label define ethnicity_with_missing 1 "Black" 3 "Mixed" 4 "Other" 5 "South As
> ian" 6 "White" 9 "Missing", replace

. label values ethnicity_with_missing ethnicity_with_missing

. tab ethnicity_with_missing

ethnicity_w |
ith_missing |      Freq.     Percent        Cum.
------------+-----------------------------------
      Black |      2,182        4.17        4.17
      Mixed |      2,039        3.90        8.07
      Other |      2,165        4.14       12.21
South Asian |     12,515       23.93       36.14
    Missing |     33,398       63.86      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. gen White=1 if ethnicity==6
(52,299 missing values generated)

. replace White=0 if ethnicity!=6&ethnicity!=.
(18,901 real changes made)

. tab White

      White |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     18,901      100.00      100.00
------------+-----------------------------------
      Total |     18,901      100.00

. gen White_with_missing=White
(33,398 missing values generated)

. replace White_with_missing=9 if White==.
(33,398 real changes made)

. tab White_with_missing

White_with_ |
    missing |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     18,901       36.14       36.14
          9 |     33,398       63.86      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. * IMD
. tab imdq5,m

             imdQ5 |      Freq.     Percent        Cum.
-------------------+-----------------------------------
 1 (most deprived) |     10,549       20.17       20.17
                 2 |     10,629       20.32       40.49
                 3 |     10,409       19.90       60.40
                 4 |     10,258       19.61       80.01
5 (least deprived) |      9,951       19.03       99.04
           Unknown |        503        0.96      100.00
-------------------+-----------------------------------
             Total |     52,299      100.00

. replace imdq5="." if imdq5=="Unknown" 
(503 real changes made)

. replace imdq5="1" if imdq5=="1 (most deprived)" 
(10,549 real changes made)

. replace imdq5="5" if imdq5=="5 (least deprived)" 
(9,951 real changes made)

. destring imdq5, replace
imdq5: all characters numeric; replaced as byte
(503 missing values generated)

. recode imdq5 5 = 1 4 = 2 3 = 3 2 = 4 1 = 5 // Reverse the order (so 5 is more
>  deprived)
(imdq5: 41387 changes made)

. label define imdq5 1 "1 least deprived" 2 "2" 3 "3" 4 "4" 5 "5 most deprived"
> , replace

. label values imdq5 imdq5

. gen imd_with_missing=imdq5
(503 missing values generated)

. replace imd_with_missing=9 if imdq5==.
(503 real changes made)

. tab imdq5,m

           imdQ5 |      Freq.     Percent        Cum.
-----------------+-----------------------------------
1 least deprived |      9,951       19.03       19.03
               2 |     10,258       19.61       38.64
               3 |     10,409       19.90       58.54
               4 |     10,629       20.32       78.87
 5 most deprived |     10,549       20.17       99.04
               . |        503        0.96      100.00
-----------------+-----------------------------------
           Total |     52,299      100.00

. * Region
. tab region_nhs,m

              region_nhs |      Freq.     Percent        Cum.
-------------------------+-----------------------------------
                    East |      5,288       10.11       10.11
           East Midlands |      5,121        9.79       19.90
                  London |     10,471       20.02       39.92
              North East |      5,272       10.08       50.00
              North West |      5,299       10.13       60.14
              South East |      5,212        9.97       70.10
              South West |      5,153        9.85       79.96
           West Midlands |      5,167        9.88       89.84
Yorkshire and The Humber |      5,316       10.16      100.00
-------------------------+-----------------------------------
                   Total |     52,299      100.00

. tab drug region_nhs

             |                 region_nhs
        drug |      East  East Mi..     London  North E.. |     Total
-------------+--------------------------------------------+----------
     control |     5,194      5,041     10,285      5,179 |    51,424 
  sotrovimab |        29         27         74         33 |       308 
    paxlovid |        32         27         59         31 |       293 
molnupiravir |        33         26         53         29 |       274 
-------------+--------------------------------------------+----------
       Total |     5,288      5,121     10,471      5,272 |    52,299 


             |                 region_nhs
        drug | North W..  South E..  South W..  West Mi.. |     Total
-------------+--------------------------------------------+----------
     control |     5,215      5,127      5,062      5,083 |    51,424 
  sotrovimab |        27         33         36         21 |       308 
    paxlovid |        32         27         31         32 |       293 
molnupiravir |        25         25         24         31 |       274 
-------------+--------------------------------------------+----------
       Total |     5,299      5,212      5,153      5,167 |    52,299 


             | region_nhs
        drug | Yorkshi.. |     Total
-------------+-----------+----------
     control |     5,238 |    51,424 
  sotrovimab |        28 |       308 
    paxlovid |        22 |       293 
molnupiravir |        28 |       274 
-------------+-----------+----------
       Total |     5,316 |    52,299 

. rename region_nhs region_nhs_str 

. encode  region_nhs_str, gen(region_nhs)

. label list region_nhs
region_nhs:
           1 East
           2 East Midlands
           3 London
           4 North East
           5 North West
           6 South East
           7 South West
           8 West Midlands
           9 Yorkshire and The Humber

. tab region_covid_therapeutics,m

region_covid_therapeutic |
                       s |      Freq.     Percent        Cum.
-------------------------+-----------------------------------
                    East |      5,247       10.03       10.03
           East Midlands |      5,224        9.99       20.02
                  London |     10,403       19.89       39.91
              North East |      5,214        9.97       49.88
              North West |      5,172        9.89       59.77
              South East |      5,233       10.01       69.78
              South West |      5,269       10.07       79.85
           West Midlands |      5,228       10.00       89.85
Yorkshire and The Humber |      5,309       10.15      100.00
-------------------------+-----------------------------------
                   Total |     52,299      100.00

. rename region_covid_therapeutics region_covid_therapeutics_str

. encode region_covid_therapeutics_str, gen(region_covid_therapeutics)

. label list region_covid_therapeutics
region_covid_therapeutics:
           1 East
           2 East Midlands
           3 London
           4 North East
           5 North West
           6 South East
           7 South West
           8 West Midlands
           9 Yorkshire and The Humber

. tab stp,m

        stp |      Freq.     Percent        Cum.
------------+-----------------------------------
       STP1 |      5,372       10.27       10.27
      STP10 |      5,301       10.14       20.41
       STP2 |      5,231       10.00       30.41
       STP3 |      5,225        9.99       40.40
       STP4 |      5,213        9.97       50.37
       STP5 |      5,227        9.99       60.36
       STP6 |      5,153        9.85       70.22
       STP7 |      5,249       10.04       80.25
       STP8 |      5,161        9.87       90.12
       STP9 |      5,167        9.88      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. rename stp stp_str

. encode  stp_str,gen(stp)

. label list stp
stp:
           1 STP1
           2 STP10
           3 STP2
           4 STP3
           5 STP4
           6 STP5
           7 STP6
           8 STP7
           9 STP8
          10 STP9

. label values stp stp

. by stp, sort: gen stp_N=_N if stp!=. //combine stps with low N (<100) as "Oth
> er"

. replace stp=99 if stp_N<100
(0 real changes made)

. tab stp,m

        stp |      Freq.     Percent        Cum.
------------+-----------------------------------
       STP1 |      5,372       10.27       10.27
      STP10 |      5,301       10.14       20.41
       STP2 |      5,231       10.00       30.41
       STP3 |      5,225        9.99       40.40
       STP4 |      5,213        9.97       50.37
       STP5 |      5,227        9.99       60.36
       STP6 |      5,153        9.85       70.22
       STP7 |      5,249       10.04       80.25
       STP8 |      5,161        9.87       90.12
       STP9 |      5,167        9.88      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. * BMI
. tabstat bmi, stat(mean p25 p50 p75 min max) 

    variable |      mean       p25       p50       p75       min       max
-------------+------------------------------------------------------------
         bmi |  26.55849  21.52298  27.41202  33.02009 -7.600333   61.7328
--------------------------------------------------------------------------

. replace bmi=. if bmi<10|bmi>60
(3,231 real changes made, 3,231 to missing)

. gen bmi_10y=bmi if bmi_date_measured!=. & bmi_date_measured>=start_date-365*1
> 0 & (age+((bmi_date_measured-start_date)/365)>=18)
(52,299 missing values generated)

. gen bmi_5y=bmi if bmi_date_measured!=. & bmi_date_measured>=start_date-365*5 
> & (age+((bmi_date_measured-start_date)/365)>=18)
(52,299 missing values generated)

. gen bmi_2y=bmi if bmi_date_measured!=. & bmi_date_measured>=start_date-365*2 
> & (age+((bmi_date_measured-start_date)/365)>=18)
(52,299 missing values generated)

. gen bmi_group=(bmi>=18.5)+(bmi>=25.0)+(bmi>=30.0) if bmi!=.
(3,231 missing values generated)

. label define bmi_group 0 "underweight" 1 "normal" 2 "overweight" 3 "obese"

. label values bmi_group bmi_group

. gen bmi_group_with_missing=bmi_group
(3,231 missing values generated)

. replace bmi_group_with_missing=9 if bmi_group==.
(3,231 real changes made)

. gen bmi_25=(bmi>=25) if bmi!=.
(3,231 missing values generated)

. gen bmi_30=(bmi>=30) if bmi!=.
(3,231 missing values generated)

. * Comorbidities
. tab diabetes,m

   diabetes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     47,060       89.98       89.98
          1 |      5,239       10.02      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. tab chronic_cardiac_disease,m

chronic_car |
diac_diseas |
          e |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     47,123       90.10       90.10
          1 |      5,176        9.90      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. tab hypertension,m

hypertensio |
          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     47,121       90.10       90.10
          1 |      5,178        9.90      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. tab chronic_respiratory_disease,m

chronic_res |
piratory_di |
      sease |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     47,129       90.11       90.11
          1 |      5,170        9.89      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. * Vaccination 
. tab vaccination_status,m

       vaccination_status |      Freq.     Percent        Cum.
--------------------------+-----------------------------------
Four or more vaccinations |      5,092        9.74        9.74
          One vaccination |      5,139        9.83       19.56
       Three vaccinations |     26,162       50.02       69.59
         Two vaccinations |      5,299       10.13       79.72
            Un-vaccinated |      5,283       10.10       89.82
 Un-vaccinated (declined) |      5,324       10.18      100.00
--------------------------+-----------------------------------
                    Total |     52,299      100.00

. rename vaccination_status vaccination_status_group

. gen vaccination_status=0 if vaccination_status_g=="Un-vaccinated"|vaccination
> _status_g=="Un-vaccinated (declined)"
(41,692 missing values generated)

. replace vaccination_status=1 if vaccination_status_g=="One vaccination"
(5,139 real changes made)

. replace vaccination_status=2 if vaccination_status_g=="Two vaccinations"
(5,299 real changes made)

. replace vaccination_status=3 if vaccination_status_g=="Three vaccinations"
(26,162 real changes made)

. replace vaccination_status=4 if vaccination_status_g=="Four or more vaccinati
> ons"
(5,092 real changes made)

. label define vaccination_status 0 "Un-vaccinated" 1 "One vaccination" 2 "Two 
> vaccinations" 3 "Three vaccinations" 4 "Four or more vaccinations"

. label values vaccination_status vaccination_status

. gen vaccination_3_plus=1 if vaccination_status==3|vaccination_status==4
(21,045 missing values generated)

. replace vaccination_3_plus=0 if vaccination_status<3
(21,045 real changes made)

. * time between vaccine and covid positive test or treatment
. gen days_vacc_covid=covid_test_positive_date - last_vaccination_date if (covi
> d_test_positive_date>last_vaccination_date & drug==0)
(19,891 missing values generated)

. sum days_vacc_covid,de

                       days_vacc_covid
-------------------------------------------------------------
      Percentiles      Smallest
 1%            9              1
 5%           43              1
10%           87              1       Obs              32,408
25%          217              1       Sum of Wgt.      32,408

50%          428                      Mean           446.1358
                        Largest       Std. Dev.      274.8076
75%          650           1146
90%          836           1146       Variance       75519.21
95%          932           1147       Skewness       .2975739
99%         1056           1148       Kurtosis       2.184216

. gen days_vacc_treat=date_treated - last_vaccination_date if (date_treated>las
> t_vaccination_date & drug>0)
(51,699 missing values generated)

. sum days_vacc_treat,de

                       days_vacc_treat
-------------------------------------------------------------
      Percentiles      Smallest
 1%           19              2
 5%         55.5              7
10%           97             12       Obs                 600
25%        226.5             14       Sum of Wgt.         600

50%          437                      Mean           454.3933
                        Largest       Std. Dev.      271.2942
75%        668.5           1103
90%          817           1110       Variance       73600.55
95%          914           1121       Skewness       .2603259
99%       1077.5           1125       Kurtosis       2.151366

. gen days_vacc_treat_test = days_vacc_covid if drug==0
(19,891 missing values generated)

. replace days_vacc_treat_test = days_vacc_treat if drug>0
(600 real changes made)

. sum days_vacc_treat_test,de

                    days_vacc_treat_test
-------------------------------------------------------------
      Percentiles      Smallest
 1%            9              1
 5%           43              1
10%           87              1       Obs              33,008
25%          217              1       Sum of Wgt.      33,008

50%          428                      Mean           446.2859
                        Largest       Std. Dev.      274.7423
75%          650           1146
90%          835           1146       Variance       75483.32
95%          932           1147       Skewness       .2968748
99%         1056           1148       Kurtosis         2.1836

. gen month_vacc_covid=ceil(days_vacc_treat_test/30)
(19,291 missing values generated)

. tab month_vacc_covid,m

month_vacc_ |
      covid |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      1,163        2.22        2.22
          2 |      1,138        2.18        4.40
          3 |      1,137        2.17        6.57
          4 |      1,159        2.22        8.79
          5 |      1,142        2.18       10.97
          6 |      1,180        2.26       13.23
          7 |      1,098        2.10       15.33
          8 |      1,137        2.17       17.50
          9 |      1,171        2.24       19.74
         10 |      1,165        2.23       21.97
         11 |      1,196        2.29       24.26
         12 |      1,192        2.28       26.54
         13 |      1,174        2.24       28.78
         14 |      1,182        2.26       31.04
         15 |      1,123        2.15       33.19
         16 |      1,154        2.21       35.39
         17 |      1,172        2.24       37.64
         18 |      1,133        2.17       39.80
         19 |      1,194        2.28       42.08
         20 |      1,095        2.09       44.18
         21 |      1,018        1.95       46.13
         22 |        998        1.91       48.03
         23 |        923        1.76       49.80
         24 |        883        1.69       51.49
         25 |        816        1.56       53.05
         26 |        728        1.39       54.44
         27 |        721        1.38       55.82
         28 |        616        1.18       57.00
         29 |        598        1.14       58.14
         30 |        518        0.99       59.13
         31 |        424        0.81       59.94
         32 |        402        0.77       60.71
         33 |        358        0.68       61.39
         34 |        289        0.55       61.95
         35 |        237        0.45       62.40
         36 |        174        0.33       62.73
         37 |        129        0.25       62.98
         38 |         66        0.13       63.10
         39 |          5        0.01       63.11
          . |     19,291       36.89      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. *Calendar time*
. gen day_after_campaign=start_date-mdy(12,15,2021)
(27,524 missing values generated)

. sum day_after_campaign,de

                     day_after_campaign
-------------------------------------------------------------
      Percentiles      Smallest
 1%            1             -3
 5%           25             -3
10%           56             -3       Obs              24,775
25%          145             -3       Sum of Wgt.      24,775

50%          301                      Mean           299.3418
                        Largest       Std. Dev.      175.5918
75%          451            601
90%          541            601       Variance       30832.47
95%          573            601       Skewness      -.0112881
99%          595            601       Kurtosis       1.799207

. gen month_after_campaign=ceil((start_date-mdy(12,15,2021))/30)
(27,524 missing values generated)

. tab month_after_campaign,m

month_after |
  _campaign |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        208        0.40        0.40
          1 |      1,241        2.37        2.77
          2 |      1,246        2.38        5.15
          3 |      1,274        2.44        7.59
          4 |      1,179        2.25        9.84
          5 |      1,247        2.38       12.23
          6 |      1,131        2.16       14.39
          7 |      1,166        2.23       16.62
          8 |      1,222        2.34       18.96
          9 |      1,251        2.39       21.35
         10 |      1,207        2.31       23.66
         11 |      1,199        2.29       25.95
         12 |      1,260        2.41       28.36
         13 |      1,282        2.45       30.81
         14 |      1,189        2.27       33.08
         15 |      1,265        2.42       35.50
         16 |      1,252        2.39       37.90
         17 |      1,179        2.25       40.15
         18 |      1,264        2.42       42.57
         19 |      1,162        2.22       44.79
         20 |      1,317        2.52       47.31
         21 |         34        0.07       47.37
          . |     27,524       52.63      100.00
------------+-----------------------------------
      Total |     52,299      100.00

. tab start_date if month_after_campaign>100
no observations

. drop if month_after_campaign>100
(27,524 observations deleted)

. * Variant
. label define sgtf_new 0 "S gene detected" 1 "confirmed SGTF" 9 "NA"

. label values sgtf_new sgtf_new

. * Prior infection / check Bang code
. tab prior_covid, m

prior_covid |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     17,300       69.83       69.83
          1 |      7,475       30.17      100.00
------------+-----------------------------------
      Total |     24,775      100.00

. gen prior_covid_index=1 if prior_covid==1 & prior_covid_date<campaign_start
(24,737 missing values generated)

. tab prior_covid_index,m

prior_covid |
     _index |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         38        0.15        0.15
          . |     24,737       99.85      100.00
------------+-----------------------------------
      Total |     24,775      100.00

. replace prior_covid_index=0 if prior_covid_index==.
(24,737 real changes made)

. *Contraindications for Pax*
. tab drug if organ_transplant==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      7,683       96.78       96.78
  sotrovimab |         84        1.06       97.83
    paxlovid |         95        1.20       99.03
molnupiravir |         77        0.97      100.00
-------------+-----------------------------------
       Total |      7,939      100.00

. tab drug if liver_disease_nhsd_icd10==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      2,436       96.90       96.90
  sotrovimab |         27        1.07       97.97
    paxlovid |         27        1.07       99.05
molnupiravir |         24        0.95      100.00
-------------+-----------------------------------
       Total |      2,514      100.00

. tab drug if renal_disease==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      8,578       96.45       96.45
  sotrovimab |        102        1.15       97.59
    paxlovid |        113        1.27       98.86
molnupiravir |        101        1.14      100.00
-------------+-----------------------------------
       Total |      8,894      100.00

. * Calculating egfr: adapted from https://github.com/opensafely/COVID-19-vacci
> ne-breakthrough/blob/updates-feb/analysis/data_process.R*
. tabstat creatinine_ctv3, stat(mean p25 p50 p75 min max) 

    variable |      mean       p25       p50       p75       min       max
-------------+------------------------------------------------------------
creat~e_ctv3 |  56.97051  47.86221  59.08639  69.40342         0  115.9269
--------------------------------------------------------------------------

. replace creatinine_ctv3=. if !inrange(creatinine_ctv3, 20, 3000)|creatinine_c
> tv3_date>start_date
(12,378 real changes made, 12,378 to missing)

. tabstat creatinine_ctv3, stat(mean p25 p50 p75 min max) 

    variable |      mean       p25       p50       p75       min       max
-------------+------------------------------------------------------------
creat~e_ctv3 |  60.06832  49.95346  60.02153  70.03149  20.05616  115.9269
--------------------------------------------------------------------------

. replace creatinine_ctv3 = creatinine_ctv3/88.4
(12,397 real changes made)

. gen min_creatinine_ctv3=.
(24,775 missing values generated)

. replace min_creatinine_ctv3 = (creatinine_ctv3/0.7)^-0.329 if sex==1
(6,224 real changes made)

. replace min_creatinine_ctv3 = (creatinine_ctv3/0.9)^-0.411 if sex==0
(6,173 real changes made)

. replace min_creatinine_ctv3 = 1 if min_creatinine_ctv3<1
(3,407 real changes made)

. gen max_creatinine_ctv3=.
(24,775 missing values generated)

. replace max_creatinine_ctv3 = (creatinine_ctv3/0.7)^-1.209 if sex==1
(6,224 real changes made)

. replace max_creatinine_ctv3 = (creatinine_ctv3/0.9)^-1.209 if sex==0
(6,173 real changes made)

. replace max_creatinine_ctv3 = 1 if max_creatinine_ctv3>1
(21,368 real changes made)

. gen egfr_creatinine_ctv3 = min_creatinine_ctv3*max_creatinine_ctv3*141*(0.993
> ^age_creatinine_ctv3) if age_creatinine_ctv3>0&age_creatinine_ctv3<=120
(12,528 missing values generated)

. replace egfr_creatinine_ctv3 = egfr_creatinine_ctv3*1.018 if sex==1
(6,157 real changes made)

. tabstat creatinine_snomed, stat(mean p25 p50 p75 min max) 

    variable |      mean       p25       p50       p75       min       max
-------------+------------------------------------------------------------
cre~e_snomed |  22.40502         0         0  44.83115 -36.65901  117.7373
--------------------------------------------------------------------------

. replace creatinine_snomed = . if !inrange(creatinine_snomed, 20, 3000)| creat
> inine_snomed_date>start_date
(18,967 real changes made, 18,967 to missing)

. replace creatinine_snomed_date = creatinine_short_snomed_date if missing(crea
> tinine_snomed)
(12,793 real changes made, 3,307 to missing)

. replace creatinine_operator_snomed = creatinine_operator_short_snomed if miss
> ing(creatinine_snomed)
(10,491 real changes made)

. replace age_creatinine_snomed = age_creatinine_short_snomed if missing(creati
> nine_snomed)
(18,770 real changes made)

. replace creatinine_snomed = creatinine_short_snomed if missing(creatinine_sno
> med)
(18,967 real changes made)

. replace creatinine_snomed = . if !inrange(creatinine_snomed, 20, 3000)| creat
> inine_snomed_date>start_date
(14,803 real changes made, 14,803 to missing)

. replace creatinine_snomed = creatinine_snomed/88.4
(9,972 real changes made)

. gen min_creatinine_snomed=.
(24,775 missing values generated)

. replace min_creatinine_snomed = (creatinine_snomed/0.7)^-0.329 if sex==1
(5,083 real changes made)

. replace min_creatinine_snomed = (creatinine_snomed/0.9)^-0.411 if sex==0
(4,889 real changes made)

. replace min_creatinine_snomed = 1 if min_creatinine_snomed<1
(1,349 real changes made)

. gen max_creatinine_snomed=.
(24,775 missing values generated)

. replace max_creatinine_snomed = (creatinine_snomed/0.7)^-1.209 if sex==1
(5,083 real changes made)

. replace max_creatinine_snomed = (creatinine_snomed/0.9)^-1.209 if sex==0
(4,889 real changes made)

. replace max_creatinine_snomed = 1 if max_creatinine_snomed>1
(23,426 real changes made)

. gen egfr_creatinine_snomed = min_creatinine_snomed*max_creatinine_snomed*141*
> (0.993^age_creatinine_snomed) if age_creatinine_snomed>0&age_creatinine_snome
> d<=120
(14,899 missing values generated)

. replace egfr_creatinine_snomed = egfr_creatinine_snomed*1.018 if sex==1
(5,026 real changes made)

. gen egfr_60 = 1 if (egfr_creatinine_ctv3<60&creatinine_operator_ctv3!="<")|(e
> gfr_creatinine_snomed<60&creatinine_operator_snomed!="<")|(egfr_record<60&egf
> r_record>0&egfr_operator!=">"&egfr_operator!=">=")|(egfr_short_record<60&egfr
> _short_record>0&egfr_short_operator!=">"&egfr_short_operator!=">=")
(21,549 missing values generated)

. gen egfr_30 = 1 if (egfr_creatinine_ctv3<30&creatinine_operator_ctv3!="<")|(e
> gfr_creatinine_snomed<30&creatinine_operator_snomed!="<")|(egfr_record<30&egf
> r_record>0&egfr_operator!=">"&egfr_operator!=">=")|(egfr_short_record<30&egfr
> _short_record>0&egfr_short_operator!=">"&egfr_short_operator!=">=")
(24,027 missing values generated)

. tab drug if egfr_60==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      3,111       96.44       96.44
  sotrovimab |         37        1.15       97.58
    paxlovid |         35        1.08       98.67
molnupiravir |         43        1.33      100.00
-------------+-----------------------------------
       Total |      3,226      100.00

. tab drug if egfr_30==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        725       96.93       96.93
  sotrovimab |          7        0.94       97.86
    paxlovid |          7        0.94       98.80
molnupiravir |          9        1.20      100.00
-------------+-----------------------------------
       Total |        748      100.00

. *drug interactions*
. tab drug if drugs_paxlovid_interaction<=start_date

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        638       97.85       97.85
  sotrovimab |          4        0.61       98.47
    paxlovid |          5        0.77       99.23
molnupiravir |          5        0.77      100.00
-------------+-----------------------------------
       Total |        652      100.00

. tab drug if drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction
> >=(start_date-3*365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        638       97.85       97.85
  sotrovimab |          4        0.61       98.47
    paxlovid |          5        0.77       99.23
molnupiravir |          5        0.77      100.00
-------------+-----------------------------------
       Total |        652      100.00

. tab drug if drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction
> >=(start_date-365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        528       97.96       97.96
  sotrovimab |          3        0.56       98.52
    paxlovid |          4        0.74       99.26
molnupiravir |          4        0.74      100.00
-------------+-----------------------------------
       Total |        539      100.00

. tab drug if drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction
> >=(start_date-180)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        304       98.06       98.06
    paxlovid |          4        1.29       99.35
molnupiravir |          2        0.65      100.00
-------------+-----------------------------------
       Total |        310      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        629       95.16       95.16
  sotrovimab |         12        1.82       96.97
    paxlovid |         12        1.82       98.79
molnupiravir |          8        1.21      100.00
-------------+-----------------------------------
       Total |        661      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date&drugs_nirmatrelvir_int
> eraction>=(start_date-3*365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        629       95.16       95.16
  sotrovimab |         12        1.82       96.97
    paxlovid |         12        1.82       98.79
molnupiravir |          8        1.21      100.00
-------------+-----------------------------------
       Total |        661      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date&drugs_nirmatrelvir_int
> eraction>=(start_date-365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        523       94.75       94.75
  sotrovimab |         12        2.17       96.92
    paxlovid |         11        1.99       98.91
molnupiravir |          6        1.09      100.00
-------------+-----------------------------------
       Total |        552      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date&drugs_nirmatrelvir_int
> eraction>=(start_date-180)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        292       93.59       93.59
  sotrovimab |          8        2.56       96.15
    paxlovid |          7        2.24       98.40
molnupiravir |          5        1.60      100.00
-------------+-----------------------------------
       Total |        312      100.00

. gen paxlovid_interaction=(drugs_paxlovid_interaction<=start_date&drugs_paxlov
> id_interaction>=(start_date-180))  

. gen nirmatrelvir_interaction=(drugs_nirmatrelvir_interaction<=start_date&drug
> s_nirmatrelvir_interaction>=(start_date-180))

. * Drug contraindicated 
. gen paxlovid_contraindicated = 1 if egfr_30==1 | dialysis==1
(21,539 missing values generated)

. replace paxlovid_contraindicated = 1 if liver_disease==1 
(4,214 real changes made)

. replace paxlovid_contraindicated = 1 if organ_transplant==1 
(5,664 real changes made)

. replace paxlovid_contraindicated = 1 if drugs_paxlovid_interaction<=start_dat
> e&drugs_paxlovid_interaction>=(start_date-180)
(147 real changes made)

. recode paxlovid_contraindicated . = 0
(paxlovid_contraindicated: 11514 changes made)

. by drug, sort: count if paxlovid_contraindicated==1

-------------------------------------------------------------------------------
-> drug = control
  12,833
-------------------------------------------------------------------------------
-> drug = sotrovimab
  141
-------------------------------------------------------------------------------
-> drug = paxlovid
  154
-------------------------------------------------------------------------------
-> drug = molnupiravir
  133

. 
. ****************************
. *       COX MODEL               *
. ****************************
. global ae               ae_spc_all                              ///
>                                 ae_drug_all                             ///  
>            
>                                 ae_imae_all                     ///          
>                    
>                                 ae_all                                  ///
>                                 allcause_emerg_aande    ///
>                                 covid_hosp_date                 ///
>                                 all_hosp_date                   ///
>                                 died_date_ons

. 
. * Generate failure 
. foreach x in    $ae $ae_disease ///
>                                 $ae_spc $ae_spc_icd $ae_spc_emerg ///
>                                 $ae_drug $ae_drug_icd $ae_drug_emerg ///
>                                 $ae_imae $ae_imae_icd $ae_imae_emerg ///
>                                 {
  2.         display "`x'"
  3.         by drug, sort: count if `x'!=.
  4.         by drug, sort: count if `x'>=start_date & `x'!=.
  5.         by drug, sort: count if `x'>=start_date & `x'<start_date_29 &`x'!=
> .
  6.         gen fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, paxl
> ovid, molnupiravir)) if drug==1
  7.         replace fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, 
> sotrovimab, molnupiravir)) if drug==2
  8.         replace fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, 
> sotrovimab, paxlovid)) if drug==3
  9.         replace fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, 
> sotrovimab, paxlovid, molnupiravir)) if drug==0
 10.         tab drug fail_`x', m
 11. }
ae_spc_all

-------------------------------------------------------------------------------
-> drug = control
  23,249
-------------------------------------------------------------------------------
-> drug = sotrovimab
  300
-------------------------------------------------------------------------------
-> drug = paxlovid
  287
-------------------------------------------------------------------------------
-> drug = molnupiravir
  267

-------------------------------------------------------------------------------
-> drug = control
  6,887
-------------------------------------------------------------------------------
-> drug = sotrovimab
  94
-------------------------------------------------------------------------------
-> drug = paxlovid
  78
-------------------------------------------------------------------------------
-> drug = molnupiravir
  66

-------------------------------------------------------------------------------
-> drug = control
  1,051
-------------------------------------------------------------------------------
-> drug = sotrovimab
  12
-------------------------------------------------------------------------------
-> drug = paxlovid
  8
-------------------------------------------------------------------------------
-> drug = molnupiravir
  6
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |    fail_ae_spc_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     6,457     17,443 |    23,900 
  sotrovimab |        88        220 |       308 
    paxlovid |        75        218 |       293 
molnupiravir |        67        207 |       274 
-------------+----------------------+----------
       Total |     6,687     18,088 |    24,775 
ae_drug_all

-------------------------------------------------------------------------------
-> drug = control
  22,792
-------------------------------------------------------------------------------
-> drug = sotrovimab
  291
-------------------------------------------------------------------------------
-> drug = paxlovid
  275
-------------------------------------------------------------------------------
-> drug = molnupiravir
  265

-------------------------------------------------------------------------------
-> drug = control
  7,335
-------------------------------------------------------------------------------
-> drug = sotrovimab
  107
-------------------------------------------------------------------------------
-> drug = paxlovid
  83
-------------------------------------------------------------------------------
-> drug = molnupiravir
  84

-------------------------------------------------------------------------------
-> drug = control
  1,048
-------------------------------------------------------------------------------
-> drug = sotrovimab
  14
-------------------------------------------------------------------------------
-> drug = paxlovid
  13
-------------------------------------------------------------------------------
-> drug = molnupiravir
  13
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |   fail_ae_drug_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     7,360     16,540 |    23,900 
  sotrovimab |       110        198 |       308 
    paxlovid |        86        207 |       293 
molnupiravir |        80        194 |       274 
-------------+----------------------+----------
       Total |     7,636     17,139 |    24,775 
ae_imae_all

-------------------------------------------------------------------------------
-> drug = control
  23,760
-------------------------------------------------------------------------------
-> drug = sotrovimab
  305
-------------------------------------------------------------------------------
-> drug = paxlovid
  290
-------------------------------------------------------------------------------
-> drug = molnupiravir
  271

-------------------------------------------------------------------------------
-> drug = control
  5,186
-------------------------------------------------------------------------------
-> drug = sotrovimab
  66
-------------------------------------------------------------------------------
-> drug = paxlovid
  64
-------------------------------------------------------------------------------
-> drug = molnupiravir
  55

-------------------------------------------------------------------------------
-> drug = control
  1,028
-------------------------------------------------------------------------------
-> drug = sotrovimab
  20
-------------------------------------------------------------------------------
-> drug = paxlovid
  21
-------------------------------------------------------------------------------
-> drug = molnupiravir
  13
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |   fail_ae_imae_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     4,258     19,642 |    23,900 
  sotrovimab |        49        259 |       308 
    paxlovid |        46        247 |       293 
molnupiravir |        45        229 |       274 
-------------+----------------------+----------
       Total |     4,398     20,377 |    24,775 
ae_all

-------------------------------------------------------------------------------
-> drug = control
  23,900
-------------------------------------------------------------------------------
-> drug = sotrovimab
  308
-------------------------------------------------------------------------------
-> drug = paxlovid
  293
-------------------------------------------------------------------------------
-> drug = molnupiravir
  274

-------------------------------------------------------------------------------
-> drug = control
  2,691
-------------------------------------------------------------------------------
-> drug = sotrovimab
  39
-------------------------------------------------------------------------------
-> drug = paxlovid
  34
-------------------------------------------------------------------------------
-> drug = molnupiravir
  24

-------------------------------------------------------------------------------
-> drug = control
  996
-------------------------------------------------------------------------------
-> drug = sotrovimab
  19
-------------------------------------------------------------------------------
-> drug = paxlovid
  15
-------------------------------------------------------------------------------
-> drug = molnupiravir
  7
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |      fail_ae_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     1,660     22,240 |    23,900 
  sotrovimab |        20        288 |       308 
    paxlovid |        18        275 |       293 
molnupiravir |        17        257 |       274 
-------------+----------------------+----------
       Total |     1,715     23,060 |    24,775 
allcause_emerg_aande

-------------------------------------------------------------------------------
-> drug = control
  1,230
-------------------------------------------------------------------------------
-> drug = sotrovimab
  22
-------------------------------------------------------------------------------
-> drug = paxlovid
  12
-------------------------------------------------------------------------------
-> drug = molnupiravir
  21

-------------------------------------------------------------------------------
-> drug = control
  725
-------------------------------------------------------------------------------
-> drug = sotrovimab
  13
-------------------------------------------------------------------------------
-> drug = paxlovid
  6
-------------------------------------------------------------------------------
-> drug = molnupiravir
  10

-------------------------------------------------------------------------------
-> drug = control
  55
-------------------------------------------------------------------------------
-> drug = sotrovimab
  0
-------------------------------------------------------------------------------
-> drug = paxlovid
  1
-------------------------------------------------------------------------------
-> drug = molnupiravir
  1
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_allcause_emerg_a
             |         ande
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    23,339        561 |    23,900 
  sotrovimab |       299          9 |       308 
    paxlovid |       286          7 |       293 
molnupiravir |       262         12 |       274 
-------------+----------------------+----------
       Total |    24,186        589 |    24,775 
covid_hosp_date

-------------------------------------------------------------------------------
-> drug = control
  2,421
-------------------------------------------------------------------------------
-> drug = sotrovimab
  40
-------------------------------------------------------------------------------
-> drug = paxlovid
  35
-------------------------------------------------------------------------------
-> drug = molnupiravir
  34

-------------------------------------------------------------------------------
-> drug = control
  1,361
-------------------------------------------------------------------------------
-> drug = sotrovimab
  25
-------------------------------------------------------------------------------
-> drug = paxlovid
  24
-------------------------------------------------------------------------------
-> drug = molnupiravir
  17

-------------------------------------------------------------------------------
-> drug = control
  139
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  2
-------------------------------------------------------------------------------
-> drug = molnupiravir
  2
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_covid_hosp_date
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    22,693      1,207 |    23,900 
  sotrovimab |       289         19 |       308 
    paxlovid |       280         13 |       293 
molnupiravir |       255         19 |       274 
-------------+----------------------+----------
       Total |    23,517      1,258 |    24,775 
all_hosp_date

-------------------------------------------------------------------------------
-> drug = control
  2,366
-------------------------------------------------------------------------------
-> drug = sotrovimab
  25
-------------------------------------------------------------------------------
-> drug = paxlovid
  24
-------------------------------------------------------------------------------
-> drug = molnupiravir
  32

-------------------------------------------------------------------------------
-> drug = control
  1,359
-------------------------------------------------------------------------------
-> drug = sotrovimab
  20
-------------------------------------------------------------------------------
-> drug = paxlovid
  18
-------------------------------------------------------------------------------
-> drug = molnupiravir
  19

-------------------------------------------------------------------------------
-> drug = control
  131
-------------------------------------------------------------------------------
-> drug = sotrovimab
  1
-------------------------------------------------------------------------------
-> drug = paxlovid
  2
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |  fail_all_hosp_date
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    22,759      1,141 |    23,900 
  sotrovimab |       302          6 |       308 
    paxlovid |       285          8 |       293 
molnupiravir |       258         16 |       274 
-------------+----------------------+----------
       Total |    23,604      1,171 |    24,775 
died_date_ons

-------------------------------------------------------------------------------
-> drug = control
  14,256
-------------------------------------------------------------------------------
-> drug = sotrovimab
  181
-------------------------------------------------------------------------------
-> drug = paxlovid
  182
-------------------------------------------------------------------------------
-> drug = molnupiravir
  166

-------------------------------------------------------------------------------
-> drug = control
  4,579
-------------------------------------------------------------------------------
-> drug = sotrovimab
  49
-------------------------------------------------------------------------------
-> drug = paxlovid
  49
-------------------------------------------------------------------------------
-> drug = molnupiravir
  47

-------------------------------------------------------------------------------
-> drug = control
  434
-------------------------------------------------------------------------------
-> drug = sotrovimab
  3
-------------------------------------------------------------------------------
-> drug = paxlovid
  7
-------------------------------------------------------------------------------
-> drug = molnupiravir
  4
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |  fail_died_date_ons
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    13,775     10,125 |    23,900 
  sotrovimab |       173        135 |       308 
    paxlovid |       153        140 |       293 
molnupiravir |       150        124 |       274 
-------------+----------------------+----------
       Total |    14,251     10,524 |    24,775 
ae_diverticulitis

-------------------------------------------------------------------------------
-> drug = control
  18,734
-------------------------------------------------------------------------------
-> drug = sotrovimab
  236
-------------------------------------------------------------------------------
-> drug = paxlovid
  238
-------------------------------------------------------------------------------
-> drug = molnupiravir
  214

-------------------------------------------------------------------------------
-> drug = control
  7,953
-------------------------------------------------------------------------------
-> drug = sotrovimab
  94
-------------------------------------------------------------------------------
-> drug = paxlovid
  95
-------------------------------------------------------------------------------
-> drug = molnupiravir
  81

-------------------------------------------------------------------------------
-> drug = control
  903
-------------------------------------------------------------------------------
-> drug = sotrovimab
  12
-------------------------------------------------------------------------------
-> drug = paxlovid
  9
-------------------------------------------------------------------------------
-> drug = molnupiravir
  6
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_diverticuliti
             |           s
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    12,196     11,704 |    23,900 
  sotrovimab |       153        155 |       308 
    paxlovid |       141        152 |       293 
molnupiravir |       135        139 |       274 
-------------+----------------------+----------
       Total |    12,625     12,150 |    24,775 
ae_diarrhoea

-------------------------------------------------------------------------------
-> drug = control
  18,774
-------------------------------------------------------------------------------
-> drug = sotrovimab
  238
-------------------------------------------------------------------------------
-> drug = paxlovid
  227
-------------------------------------------------------------------------------
-> drug = molnupiravir
  218

-------------------------------------------------------------------------------
-> drug = control
  7,973
-------------------------------------------------------------------------------
-> drug = sotrovimab
  120
-------------------------------------------------------------------------------
-> drug = paxlovid
  93
-------------------------------------------------------------------------------
-> drug = molnupiravir
  82

-------------------------------------------------------------------------------
-> drug = control
  891
-------------------------------------------------------------------------------
-> drug = sotrovimab
  12
-------------------------------------------------------------------------------
-> drug = paxlovid
  9
-------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |   fail_ae_diarrhoea
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    12,187     11,713 |    23,900 
  sotrovimab |       177        131 |       308 
    paxlovid |       149        144 |       293 
molnupiravir |       127        147 |       274 
-------------+----------------------+----------
       Total |    12,640     12,135 |    24,775 
ae_taste

-------------------------------------------------------------------------------
-> drug = control
  15,227
-------------------------------------------------------------------------------
-> drug = sotrovimab
  200
-------------------------------------------------------------------------------
-> drug = paxlovid
  173
-------------------------------------------------------------------------------
-> drug = molnupiravir
  180

-------------------------------------------------------------------------------
-> drug = control
  7,055
-------------------------------------------------------------------------------
-> drug = sotrovimab
  91
-------------------------------------------------------------------------------
-> drug = paxlovid
  73
-------------------------------------------------------------------------------
-> drug = molnupiravir
  66

-------------------------------------------------------------------------------
-> drug = control
  696
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  4
-------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |     fail_ae_taste
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    15,001      8,899 |    23,900 
  sotrovimab |       193        115 |       308 
    paxlovid |       188        105 |       293 
molnupiravir |       151        123 |       274 
-------------+----------------------+----------
       Total |    15,533      9,242 |    24,775 
ae_rash

-------------------------------------------------------------------------------
-> drug = control
  18,790
-------------------------------------------------------------------------------
-> drug = sotrovimab
  238
-------------------------------------------------------------------------------
-> drug = paxlovid
  234
-------------------------------------------------------------------------------
-> drug = molnupiravir
  211

-------------------------------------------------------------------------------
-> drug = control
  7,936
-------------------------------------------------------------------------------
-> drug = sotrovimab
  98
-------------------------------------------------------------------------------
-> drug = paxlovid
  99
-------------------------------------------------------------------------------
-> drug = molnupiravir
  86

-------------------------------------------------------------------------------
-> drug = control
  892
-------------------------------------------------------------------------------
-> drug = sotrovimab
  10
-------------------------------------------------------------------------------
-> drug = paxlovid
  8
-------------------------------------------------------------------------------
-> drug = molnupiravir
  6
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |     fail_ae_rash
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    12,129     11,771 |    23,900 
  sotrovimab |       158        150 |       308 
    paxlovid |       150        143 |       293 
molnupiravir |       143        131 |       274 
-------------+----------------------+----------
       Total |    12,580     12,195 |    24,775 
ae_anaphylaxis

-------------------------------------------------------------------------------
-> drug = control
  18,767
-------------------------------------------------------------------------------
-> drug = sotrovimab
  223
-------------------------------------------------------------------------------
-> drug = paxlovid
  229
-------------------------------------------------------------------------------
-> drug = molnupiravir
  215

-------------------------------------------------------------------------------
-> drug = control
  7,968
-------------------------------------------------------------------------------
-> drug = sotrovimab
  93
-------------------------------------------------------------------------------
-> drug = paxlovid
  88
-------------------------------------------------------------------------------
-> drug = molnupiravir
  87

-------------------------------------------------------------------------------
-> drug = control
  806
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  15
-------------------------------------------------------------------------------
-> drug = molnupiravir
  8
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |  fail_ae_anaphylaxis
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    12,273     11,627 |    23,900 
  sotrovimab |       171        137 |       308 
    paxlovid |       137        156 |       293 
molnupiravir |       138        136 |       274 
-------------+----------------------+----------
       Total |    12,719     12,056 |    24,775 
ae_severe_drug

-------------------------------------------------------------------------------
-> drug = control
  20,781
-------------------------------------------------------------------------------
-> drug = sotrovimab
  264
-------------------------------------------------------------------------------
-> drug = paxlovid
  251
-------------------------------------------------------------------------------
-> drug = molnupiravir
  247

-------------------------------------------------------------------------------
-> drug = control
  8,015
-------------------------------------------------------------------------------
-> drug = sotrovimab
  113
-------------------------------------------------------------------------------
-> drug = paxlovid
  97
-------------------------------------------------------------------------------
-> drug = molnupiravir
  86

-------------------------------------------------------------------------------
-> drug = control
  982
-------------------------------------------------------------------------------
-> drug = sotrovimab
  15
-------------------------------------------------------------------------------
-> drug = paxlovid
  11
-------------------------------------------------------------------------------
-> drug = molnupiravir
  7
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |  fail_ae_severe_drug
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    10,113     13,787 |    23,900 
  sotrovimab |       142        166 |       308 
    paxlovid |       128        165 |       293 
molnupiravir |       106        168 |       274 
-------------+----------------------+----------
       Total |    10,489     14,286 |    24,775 
ae_nonsevere_drug

-------------------------------------------------------------------------------
-> drug = control
  15,328
-------------------------------------------------------------------------------
-> drug = sotrovimab
  189
-------------------------------------------------------------------------------
-> drug = paxlovid
  206
-------------------------------------------------------------------------------
-> drug = molnupiravir
  172

-------------------------------------------------------------------------------
-> drug = control
  7,039
-------------------------------------------------------------------------------
-> drug = sotrovimab
  94
-------------------------------------------------------------------------------
-> drug = paxlovid
  79
-------------------------------------------------------------------------------
-> drug = molnupiravir
  80

-------------------------------------------------------------------------------
-> drug = control
  713
-------------------------------------------------------------------------------
-> drug = sotrovimab
  8
-------------------------------------------------------------------------------
-> drug = paxlovid
  10
-------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_nonsevere_dru
             |           g
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    14,876      9,024 |    23,900 
  sotrovimab |       205        103 |       308 
    paxlovid |       153        140 |       293 
molnupiravir |       171        103 |       274 
-------------+----------------------+----------
       Total |    15,405      9,370 |    24,775 
ae_ra

-------------------------------------------------------------------------------
-> drug = control
  16,799
-------------------------------------------------------------------------------
-> drug = sotrovimab
  218
-------------------------------------------------------------------------------
-> drug = paxlovid
  187
-------------------------------------------------------------------------------
-> drug = molnupiravir
  178

-------------------------------------------------------------------------------
-> drug = control
  7,014
-------------------------------------------------------------------------------
-> drug = sotrovimab
  88
-------------------------------------------------------------------------------
-> drug = paxlovid
  68
-------------------------------------------------------------------------------
-> drug = molnupiravir
  79

-------------------------------------------------------------------------------
-> drug = control
  774
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  8
-------------------------------------------------------------------------------
-> drug = molnupiravir
  13
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |      fail_ae_ra
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    13,306     10,594 |    23,900 
  sotrovimab |       174        134 |       308 
    paxlovid |       166        127 |       293 
molnupiravir |       162        112 |       274 
-------------+----------------------+----------
       Total |    13,808     10,967 |    24,775 
ae_sle

-------------------------------------------------------------------------------
-> drug = control
  16,753
-------------------------------------------------------------------------------
-> drug = sotrovimab
  219
-------------------------------------------------------------------------------
-> drug = paxlovid
  215
-------------------------------------------------------------------------------
-> drug = molnupiravir
  198

-------------------------------------------------------------------------------
-> drug = control
  7,083
-------------------------------------------------------------------------------
-> drug = sotrovimab
  93
-------------------------------------------------------------------------------
-> drug = paxlovid
  91
-------------------------------------------------------------------------------
-> drug = molnupiravir
  69

-------------------------------------------------------------------------------
-> drug = control
  771
-------------------------------------------------------------------------------
-> drug = sotrovimab
  12
-------------------------------------------------------------------------------
-> drug = paxlovid
  13
-------------------------------------------------------------------------------
-> drug = molnupiravir
  8
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |      fail_ae_sle
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    13,438     10,462 |    23,900 
  sotrovimab |       170        138 |       308 
    paxlovid |       156        137 |       293 
molnupiravir |       137        137 |       274 
-------------+----------------------+----------
       Total |    13,901     10,874 |    24,775 
ae_psorasis

-------------------------------------------------------------------------------
-> drug = control
  16,764
-------------------------------------------------------------------------------
-> drug = sotrovimab
  213
-------------------------------------------------------------------------------
-> drug = paxlovid
  204
-------------------------------------------------------------------------------
-> drug = molnupiravir
  202

-------------------------------------------------------------------------------
-> drug = control
  7,122
-------------------------------------------------------------------------------
-> drug = sotrovimab
  86
-------------------------------------------------------------------------------
-> drug = paxlovid
  83
-------------------------------------------------------------------------------
-> drug = molnupiravir
  72

-------------------------------------------------------------------------------
-> drug = control
  756
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  15
-------------------------------------------------------------------------------
-> drug = molnupiravir
  7
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |   fail_ae_psorasis
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    13,479     10,421 |    23,900 
  sotrovimab |       174        134 |       308 
    paxlovid |       157        136 |       293 
molnupiravir |       137        137 |       274 
-------------+----------------------+----------
       Total |    13,947     10,828 |    24,775 
ae_psa

-------------------------------------------------------------------------------
-> drug = control
  16,841
-------------------------------------------------------------------------------
-> drug = sotrovimab
  210
-------------------------------------------------------------------------------
-> drug = paxlovid
  206
-------------------------------------------------------------------------------
-> drug = molnupiravir
  205

-------------------------------------------------------------------------------
-> drug = control
  7,142
-------------------------------------------------------------------------------
-> drug = sotrovimab
  93
-------------------------------------------------------------------------------
-> drug = paxlovid
  89
-------------------------------------------------------------------------------
-> drug = molnupiravir
  87

-------------------------------------------------------------------------------
-> drug = control
  763
-------------------------------------------------------------------------------
-> drug = sotrovimab
  10
-------------------------------------------------------------------------------
-> drug = paxlovid
  7
-------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |      fail_ae_psa
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    13,412     10,488 |    23,900 
  sotrovimab |       181        127 |       308 
    paxlovid |       169        124 |       293 
molnupiravir |       151        123 |       274 
-------------+----------------------+----------
       Total |    13,913     10,862 |    24,775 
ae_axspa

-------------------------------------------------------------------------------
-> drug = control
  16,944
-------------------------------------------------------------------------------
-> drug = sotrovimab
  213
-------------------------------------------------------------------------------
-> drug = paxlovid
  199
-------------------------------------------------------------------------------
-> drug = molnupiravir
  195

-------------------------------------------------------------------------------
-> drug = control
  7,241
-------------------------------------------------------------------------------
-> drug = sotrovimab
  90
-------------------------------------------------------------------------------
-> drug = paxlovid
  74
-------------------------------------------------------------------------------
-> drug = molnupiravir
  95

-------------------------------------------------------------------------------
-> drug = control
  743
-------------------------------------------------------------------------------
-> drug = sotrovimab
  12
-------------------------------------------------------------------------------
-> drug = paxlovid
  14
-------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |     fail_ae_axspa
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    13,425     10,475 |    23,900 
  sotrovimab |       173        135 |       308 
    paxlovid |       154        139 |       293 
molnupiravir |       165        109 |       274 
-------------+----------------------+----------
       Total |    13,917     10,858 |    24,775 
ae_ibd

-------------------------------------------------------------------------------
-> drug = control
  16,887
-------------------------------------------------------------------------------
-> drug = sotrovimab
  221
-------------------------------------------------------------------------------
-> drug = paxlovid
  204
-------------------------------------------------------------------------------
-> drug = molnupiravir
  199

-------------------------------------------------------------------------------
-> drug = control
  7,155
-------------------------------------------------------------------------------
-> drug = sotrovimab
  94
-------------------------------------------------------------------------------
-> drug = paxlovid
  86
-------------------------------------------------------------------------------
-> drug = molnupiravir
  86

-------------------------------------------------------------------------------
-> drug = control
  784
-------------------------------------------------------------------------------
-> drug = sotrovimab
  11
-------------------------------------------------------------------------------
-> drug = paxlovid
  9
-------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |      fail_ae_ibd
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    13,370     10,530 |    23,900 
  sotrovimab |       170        138 |       308 
    paxlovid |       166        127 |       293 
molnupiravir |       150        124 |       274 
-------------+----------------------+----------
       Total |    13,856     10,919 |    24,775 
ae_diverticulitis_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,602
-------------------------------------------------------------------------------
-> drug = sotrovimab
  128
-------------------------------------------------------------------------------
-> drug = paxlovid
  113
-------------------------------------------------------------------------------
-> drug = molnupiravir
  109

-------------------------------------------------------------------------------
-> drug = control
  4,847
-------------------------------------------------------------------------------
-> drug = sotrovimab
  62
-------------------------------------------------------------------------------
-> drug = paxlovid
  52
-------------------------------------------------------------------------------
-> drug = molnupiravir
  53

-------------------------------------------------------------------------------
-> drug = control
  473
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  5
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_diverticuliti
             |      s_icd_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,659      5,241 |    23,900 
  sotrovimab |       234         74 |       308 
    paxlovid |       227         66 |       293 
molnupiravir |       215         59 |       274 
-------------+----------------------+----------
       Total |    19,335      5,440 |    24,775 
ae_taste_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,517
-------------------------------------------------------------------------------
-> drug = sotrovimab
  117
-------------------------------------------------------------------------------
-> drug = paxlovid
  106
-------------------------------------------------------------------------------
-> drug = molnupiravir
  100

-------------------------------------------------------------------------------
-> drug = control
  4,777
-------------------------------------------------------------------------------
-> drug = sotrovimab
  58
-------------------------------------------------------------------------------
-> drug = paxlovid
  52
-------------------------------------------------------------------------------
-> drug = molnupiravir
  47

-------------------------------------------------------------------------------
-> drug = control
  459
-------------------------------------------------------------------------------
-> drug = sotrovimab
  3
-------------------------------------------------------------------------------
-> drug = paxlovid
  3
-------------------------------------------------------------------------------
-> drug = molnupiravir
  6
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_taste_icd_pri
             |           m
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,682      5,218 |    23,900 
  sotrovimab |       244         64 |       308 
    paxlovid |       236         57 |       293 
molnupiravir |       215         59 |       274 
-------------+----------------------+----------
       Total |    19,377      5,398 |    24,775 
ae_rash_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,530
-------------------------------------------------------------------------------
-> drug = sotrovimab
  123
-------------------------------------------------------------------------------
-> drug = paxlovid
  122
-------------------------------------------------------------------------------
-> drug = molnupiravir
  107

-------------------------------------------------------------------------------
-> drug = control
  4,757
-------------------------------------------------------------------------------
-> drug = sotrovimab
  66
-------------------------------------------------------------------------------
-> drug = paxlovid
  58
-------------------------------------------------------------------------------
-> drug = molnupiravir
  49

-------------------------------------------------------------------------------
-> drug = control
  450
-------------------------------------------------------------------------------
-> drug = sotrovimab
  5
-------------------------------------------------------------------------------
-> drug = paxlovid
  5
-------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_rash_icd_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,665      5,235 |    23,900 
  sotrovimab |       246         62 |       308 
    paxlovid |       224         69 |       293 
molnupiravir |       211         63 |       274 
-------------+----------------------+----------
       Total |    19,346      5,429 |    24,775 
ae_diarrhoea_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,546
-------------------------------------------------------------------------------
-> drug = sotrovimab
  127
-------------------------------------------------------------------------------
-> drug = paxlovid
  122
-------------------------------------------------------------------------------
-> drug = molnupiravir
  100

-------------------------------------------------------------------------------
-> drug = control
  4,823
-------------------------------------------------------------------------------
-> drug = sotrovimab
  79
-------------------------------------------------------------------------------
-> drug = paxlovid
  55
-------------------------------------------------------------------------------
-> drug = molnupiravir
  47

-------------------------------------------------------------------------------
-> drug = control
  439
-------------------------------------------------------------------------------
-> drug = sotrovimab
  6
-------------------------------------------------------------------------------
-> drug = paxlovid
  5
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_diarrhoea_icd
             |         _prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,721      5,179 |    23,900 
  sotrovimab |       253         55 |       308 
    paxlovid |       220         73 |       293 
molnupiravir |       218         56 |       274 
-------------+----------------------+----------
       Total |    19,412      5,363 |    24,775 
ae_diarrhoeal_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,590
-------------------------------------------------------------------------------
-> drug = sotrovimab
  125
-------------------------------------------------------------------------------
-> drug = paxlovid
  122
-------------------------------------------------------------------------------
-> drug = molnupiravir
  112

-------------------------------------------------------------------------------
-> drug = control
  4,827
-------------------------------------------------------------------------------
-> drug = sotrovimab
  71
-------------------------------------------------------------------------------
-> drug = paxlovid
  63
-------------------------------------------------------------------------------
-> drug = molnupiravir
  47

-------------------------------------------------------------------------------
-> drug = control
  479
-------------------------------------------------------------------------------
-> drug = sotrovimab
  11
-------------------------------------------------------------------------------
-> drug = paxlovid
  4
-------------------------------------------------------------------------------
-> drug = molnupiravir
  4
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_diarrhoeal_ic
             |        d_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,649      5,251 |    23,900 
  sotrovimab |       243         65 |       308 
    paxlovid |       230         63 |       293 
molnupiravir |       205         69 |       274 
-------------+----------------------+----------
       Total |    19,327      5,448 |    24,775 
ae_diverticulitis_ae

-------------------------------------------------------------------------------
-> drug = control
  9,519
-------------------------------------------------------------------------------
-> drug = sotrovimab
  107
-------------------------------------------------------------------------------
-> drug = paxlovid
  117
-------------------------------------------------------------------------------
-> drug = molnupiravir
  111

-------------------------------------------------------------------------------
-> drug = control
  4,751
-------------------------------------------------------------------------------
-> drug = sotrovimab
  54
-------------------------------------------------------------------------------
-> drug = paxlovid
  53
-------------------------------------------------------------------------------
-> drug = molnupiravir
  42

-------------------------------------------------------------------------------
-> drug = control
  441
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  6
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_diverticuliti
             |         s_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,676      5,224 |    23,900 
  sotrovimab |       248         60 |       308 
    paxlovid |       223         70 |       293 
molnupiravir |       202         72 |       274 
-------------+----------------------+----------
       Total |    19,349      5,426 |    24,775 
ae_rash_ae

-------------------------------------------------------------------------------
-> drug = control
  9,526
-------------------------------------------------------------------------------
-> drug = sotrovimab
  120
-------------------------------------------------------------------------------
-> drug = paxlovid
  109
-------------------------------------------------------------------------------
-> drug = molnupiravir
  109

-------------------------------------------------------------------------------
-> drug = control
  4,808
-------------------------------------------------------------------------------
-> drug = sotrovimab
  46
-------------------------------------------------------------------------------
-> drug = paxlovid
  57
-------------------------------------------------------------------------------
-> drug = molnupiravir
  53

-------------------------------------------------------------------------------
-> drug = control
  453
-------------------------------------------------------------------------------
-> drug = sotrovimab
  2
-------------------------------------------------------------------------------
-> drug = paxlovid
  1
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |    fail_ae_rash_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,716      5,184 |    23,900 
  sotrovimab |       232         76 |       308 
    paxlovid |       240         53 |       293 
molnupiravir |       215         59 |       274 
-------------+----------------------+----------
       Total |    19,403      5,372 |    24,775 
ae_anaphylaxis_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,565
-------------------------------------------------------------------------------
-> drug = sotrovimab
  113
-------------------------------------------------------------------------------
-> drug = paxlovid
  123
-------------------------------------------------------------------------------
-> drug = molnupiravir
  109

-------------------------------------------------------------------------------
-> drug = control
  4,881
-------------------------------------------------------------------------------
-> drug = sotrovimab
  57
-------------------------------------------------------------------------------
-> drug = paxlovid
  58
-------------------------------------------------------------------------------
-> drug = molnupiravir
  52

-------------------------------------------------------------------------------
-> drug = control
  421
-------------------------------------------------------------------------------
-> drug = sotrovimab
  2
-------------------------------------------------------------------------------
-> drug = paxlovid
  7
-------------------------------------------------------------------------------
-> drug = molnupiravir
  7
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_anaphylaxis_i
             |        cd_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,786      5,114 |    23,900 
  sotrovimab |       250         58 |       308 
    paxlovid |       221         72 |       293 
molnupiravir |       210         64 |       274 
-------------+----------------------+----------
       Total |    19,467      5,308 |    24,775 
ae_severedrug_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,511
-------------------------------------------------------------------------------
-> drug = sotrovimab
  116
-------------------------------------------------------------------------------
-> drug = paxlovid
  113
-------------------------------------------------------------------------------
-> drug = molnupiravir
  130

-------------------------------------------------------------------------------
-> drug = control
  4,822
-------------------------------------------------------------------------------
-> drug = sotrovimab
  65
-------------------------------------------------------------------------------
-> drug = paxlovid
  60
-------------------------------------------------------------------------------
-> drug = molnupiravir
  69

-------------------------------------------------------------------------------
-> drug = control
  475
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  1
-------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_severedrug_ic
             |        d_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,725      5,175 |    23,900 
  sotrovimab |       250         58 |       308 
    paxlovid |       239         54 |       293 
molnupiravir |       208         66 |       274 
-------------+----------------------+----------
       Total |    19,422      5,353 |    24,775 
ae_severedrug_sjs_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  9,545
-------------------------------------------------------------------------------
-> drug = sotrovimab
  120
-------------------------------------------------------------------------------
-> drug = paxlovid
  101
-------------------------------------------------------------------------------
-> drug = molnupiravir
  112

-------------------------------------------------------------------------------
-> drug = control
  4,676
-------------------------------------------------------------------------------
-> drug = sotrovimab
  60
-------------------------------------------------------------------------------
-> drug = paxlovid
  53
-------------------------------------------------------------------------------
-> drug = molnupiravir
  62

-------------------------------------------------------------------------------
-> drug = control
  433
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  4
-------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_severedrug_sj
             |      s_icd_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,578      5,322 |    23,900 
  sotrovimab |       244         64 |       308 
    paxlovid |       240         53 |       293 
molnupiravir |       219         55 |       274 
-------------+----------------------+----------
       Total |    19,281      5,494 |    24,775 
ae_anaphlaxis_ae

-------------------------------------------------------------------------------
-> drug = control
  9,582
-------------------------------------------------------------------------------
-> drug = sotrovimab
  111
-------------------------------------------------------------------------------
-> drug = paxlovid
  121
-------------------------------------------------------------------------------
-> drug = molnupiravir
  103

-------------------------------------------------------------------------------
-> drug = control
  4,908
-------------------------------------------------------------------------------
-> drug = sotrovimab
  52
-------------------------------------------------------------------------------
-> drug = paxlovid
  54
-------------------------------------------------------------------------------
-> drug = molnupiravir
  49

-------------------------------------------------------------------------------
-> drug = control
  448
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  5
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_anaphlaxis_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,764      5,136 |    23,900 
  sotrovimab |       242         66 |       308 
    paxlovid |       221         72 |       293 
molnupiravir |       217         57 |       274 
-------------+----------------------+----------
       Total |    19,444      5,331 |    24,775 
ae_severedrug_ae

-------------------------------------------------------------------------------
-> drug = control
  9,640
-------------------------------------------------------------------------------
-> drug = sotrovimab
  134
-------------------------------------------------------------------------------
-> drug = paxlovid
  100
-------------------------------------------------------------------------------
-> drug = molnupiravir
  114

-------------------------------------------------------------------------------
-> drug = control
  4,844
-------------------------------------------------------------------------------
-> drug = sotrovimab
  71
-------------------------------------------------------------------------------
-> drug = paxlovid
  51
-------------------------------------------------------------------------------
-> drug = molnupiravir
  45

-------------------------------------------------------------------------------
-> drug = control
  435
-------------------------------------------------------------------------------
-> drug = sotrovimab
  8
-------------------------------------------------------------------------------
-> drug = paxlovid
  11
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_severedrug_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,651      5,249 |    23,900 
  sotrovimab |       237         71 |       308 
    paxlovid |       232         61 |       293 
molnupiravir |       202         72 |       274 
-------------+----------------------+----------
       Total |    19,322      5,453 |    24,775 
ae_nonsevere_drug_ae

-------------------------------------------------------------------------------
-> drug = control
  9,488
-------------------------------------------------------------------------------
-> drug = sotrovimab
  117
-------------------------------------------------------------------------------
-> drug = paxlovid
  136
-------------------------------------------------------------------------------
-> drug = molnupiravir
  112

-------------------------------------------------------------------------------
-> drug = control
  4,815
-------------------------------------------------------------------------------
-> drug = sotrovimab
  56
-------------------------------------------------------------------------------
-> drug = paxlovid
  53
-------------------------------------------------------------------------------
-> drug = molnupiravir
  55

-------------------------------------------------------------------------------
-> drug = control
  457
-------------------------------------------------------------------------------
-> drug = sotrovimab
  5
-------------------------------------------------------------------------------
-> drug = paxlovid
  8
-------------------------------------------------------------------------------
-> drug = molnupiravir
  8
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_ae_nonsevere_dru
             |         g_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    18,758      5,142 |    23,900 
  sotrovimab |       242         66 |       308 
    paxlovid |       199         94 |       293 
molnupiravir |       209         65 |       274 
-------------+----------------------+----------
       Total |    19,408      5,367 |    24,775 
new_ae_ra_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  8,645
-------------------------------------------------------------------------------
-> drug = sotrovimab
  121
-------------------------------------------------------------------------------
-> drug = paxlovid
  92
-------------------------------------------------------------------------------
-> drug = molnupiravir
  88

-------------------------------------------------------------------------------
-> drug = control
  4,384
-------------------------------------------------------------------------------
-> drug = sotrovimab
  65
-------------------------------------------------------------------------------
-> drug = paxlovid
  42
-------------------------------------------------------------------------------
-> drug = molnupiravir
  45

-------------------------------------------------------------------------------
-> drug = control
  414
-------------------------------------------------------------------------------
-> drug = sotrovimab
  3
-------------------------------------------------------------------------------
-> drug = paxlovid
  7
-------------------------------------------------------------------------------
-> drug = molnupiravir
  4
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_ra_icd_pr
             |          im
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,207      4,693 |    23,900 
  sotrovimab |       248         60 |       308 
    paxlovid |       236         57 |       293 
molnupiravir |       227         47 |       274 
-------------+----------------------+----------
       Total |    19,918      4,857 |    24,775 
new_ae_sle_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  8,558
-------------------------------------------------------------------------------
-> drug = sotrovimab
  110
-------------------------------------------------------------------------------
-> drug = paxlovid
  110
-------------------------------------------------------------------------------
-> drug = molnupiravir
  93

-------------------------------------------------------------------------------
-> drug = control
  4,292
-------------------------------------------------------------------------------
-> drug = sotrovimab
  62
-------------------------------------------------------------------------------
-> drug = paxlovid
  51
-------------------------------------------------------------------------------
-> drug = molnupiravir
  40

-------------------------------------------------------------------------------
-> drug = control
  423
-------------------------------------------------------------------------------
-> drug = sotrovimab
  9
-------------------------------------------------------------------------------
-> drug = paxlovid
  5
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_sle_icd_p
             |          rim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,200      4,700 |    23,900 
  sotrovimab |       251         57 |       308 
    paxlovid |       229         64 |       293 
molnupiravir |       218         56 |       274 
-------------+----------------------+----------
       Total |    19,898      4,877 |    24,775 
new_ae_psoriasis_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  8,611
-------------------------------------------------------------------------------
-> drug = sotrovimab
  106
-------------------------------------------------------------------------------
-> drug = paxlovid
  109
-------------------------------------------------------------------------------
-> drug = molnupiravir
  104

-------------------------------------------------------------------------------
-> drug = control
  4,338
-------------------------------------------------------------------------------
-> drug = sotrovimab
  47
-------------------------------------------------------------------------------
-> drug = paxlovid
  65
-------------------------------------------------------------------------------
-> drug = molnupiravir
  54

-------------------------------------------------------------------------------
-> drug = control
  410
-------------------------------------------------------------------------------
-> drug = sotrovimab
  1
-------------------------------------------------------------------------------
-> drug = paxlovid
  11
-------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_psoriasis
             |       _icd_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,204      4,696 |    23,900 
  sotrovimab |       248         60 |       308 
    paxlovid |       238         55 |       293 
molnupiravir |       219         55 |       274 
-------------+----------------------+----------
       Total |    19,909      4,866 |    24,775 
new_ae_psa_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  8,583
-------------------------------------------------------------------------------
-> drug = sotrovimab
  108
-------------------------------------------------------------------------------
-> drug = paxlovid
  115
-------------------------------------------------------------------------------
-> drug = molnupiravir
  108

-------------------------------------------------------------------------------
-> drug = control
  4,366
-------------------------------------------------------------------------------
-> drug = sotrovimab
  48
-------------------------------------------------------------------------------
-> drug = paxlovid
  58
-------------------------------------------------------------------------------
-> drug = molnupiravir
  48

-------------------------------------------------------------------------------
-> drug = control
  375
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  4
-------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_psa_icd_p
             |          rim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,293      4,607 |    23,900 
  sotrovimab |       244         64 |       308 
    paxlovid |       232         61 |       293 
molnupiravir |       209         65 |       274 
-------------+----------------------+----------
       Total |    19,978      4,797 |    24,775 
new_ae_axspa_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  8,626
-------------------------------------------------------------------------------
-> drug = sotrovimab
  103
-------------------------------------------------------------------------------
-> drug = paxlovid
  112
-------------------------------------------------------------------------------
-> drug = molnupiravir
  103

-------------------------------------------------------------------------------
-> drug = control
  4,340
-------------------------------------------------------------------------------
-> drug = sotrovimab
  50
-------------------------------------------------------------------------------
-> drug = paxlovid
  56
-------------------------------------------------------------------------------
-> drug = molnupiravir
  56

-------------------------------------------------------------------------------
-> drug = control
  397
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  9
-------------------------------------------------------------------------------
-> drug = molnupiravir
  4
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_axspa_icd
             |         _prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,197      4,703 |    23,900 
  sotrovimab |       251         57 |       308 
    paxlovid |       228         65 |       293 
molnupiravir |       223         51 |       274 
-------------+----------------------+----------
       Total |    19,899      4,876 |    24,775 
new_ae_ibd_icd_prim

-------------------------------------------------------------------------------
-> drug = control
  8,549
-------------------------------------------------------------------------------
-> drug = sotrovimab
  115
-------------------------------------------------------------------------------
-> drug = paxlovid
  109
-------------------------------------------------------------------------------
-> drug = molnupiravir
  93

-------------------------------------------------------------------------------
-> drug = control
  4,256
-------------------------------------------------------------------------------
-> drug = sotrovimab
  60
-------------------------------------------------------------------------------
-> drug = paxlovid
  51
-------------------------------------------------------------------------------
-> drug = molnupiravir
  44

-------------------------------------------------------------------------------
-> drug = control
  413
-------------------------------------------------------------------------------
-> drug = sotrovimab
  11
-------------------------------------------------------------------------------
-> drug = paxlovid
  3
-------------------------------------------------------------------------------
-> drug = molnupiravir
  2
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_ibd_icd_p
             |          rim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,181      4,719 |    23,900 
  sotrovimab |       242         66 |       308 
    paxlovid |       231         62 |       293 
molnupiravir |       223         51 |       274 
-------------+----------------------+----------
       Total |    19,877      4,898 |    24,775 
new_ae_ra_ae

-------------------------------------------------------------------------------
-> drug = control
  8,504
-------------------------------------------------------------------------------
-> drug = sotrovimab
  103
-------------------------------------------------------------------------------
-> drug = paxlovid
  114
-------------------------------------------------------------------------------
-> drug = molnupiravir
  89

-------------------------------------------------------------------------------
-> drug = control
  4,215
-------------------------------------------------------------------------------
-> drug = sotrovimab
  46
-------------------------------------------------------------------------------
-> drug = paxlovid
  55
-------------------------------------------------------------------------------
-> drug = molnupiravir
  37

-------------------------------------------------------------------------------
-> drug = control
  405
-------------------------------------------------------------------------------
-> drug = sotrovimab
  3
-------------------------------------------------------------------------------
-> drug = paxlovid
  5
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |   fail_new_ae_ra_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,192      4,708 |    23,900 
  sotrovimab |       248         60 |       308 
    paxlovid |       229         64 |       293 
molnupiravir |       219         55 |       274 
-------------+----------------------+----------
       Total |    19,888      4,887 |    24,775 
new_ae_sle_ae

-------------------------------------------------------------------------------
-> drug = control
  8,540
-------------------------------------------------------------------------------
-> drug = sotrovimab
  122
-------------------------------------------------------------------------------
-> drug = paxlovid
  125
-------------------------------------------------------------------------------
-> drug = molnupiravir
  94

-------------------------------------------------------------------------------
-> drug = control
  4,243
-------------------------------------------------------------------------------
-> drug = sotrovimab
  62
-------------------------------------------------------------------------------
-> drug = paxlovid
  67
-------------------------------------------------------------------------------
-> drug = molnupiravir
  41

-------------------------------------------------------------------------------
-> drug = control
  391
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  9
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |  fail_new_ae_sle_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,198      4,702 |    23,900 
  sotrovimab |       241         67 |       308 
    paxlovid |       226         67 |       293 
molnupiravir |       218         56 |       274 
-------------+----------------------+----------
       Total |    19,883      4,892 |    24,775 
new_ae_psoriasis_ae

-------------------------------------------------------------------------------
-> drug = control
  8,448
-------------------------------------------------------------------------------
-> drug = sotrovimab
  116
-------------------------------------------------------------------------------
-> drug = paxlovid
  109
-------------------------------------------------------------------------------
-> drug = molnupiravir
  99

-------------------------------------------------------------------------------
-> drug = control
  4,258
-------------------------------------------------------------------------------
-> drug = sotrovimab
  58
-------------------------------------------------------------------------------
-> drug = paxlovid
  54
-------------------------------------------------------------------------------
-> drug = molnupiravir
  44

-------------------------------------------------------------------------------
-> drug = control
  396
-------------------------------------------------------------------------------
-> drug = sotrovimab
  7
-------------------------------------------------------------------------------
-> drug = paxlovid
  6
-------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_psoriasis
             |          _ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,304      4,596 |    23,900 
  sotrovimab |       243         65 |       308 
    paxlovid |       232         61 |       293 
molnupiravir |       209         65 |       274 
-------------+----------------------+----------
       Total |    19,988      4,787 |    24,775 
new_ae_psa_ae

-------------------------------------------------------------------------------
-> drug = control
  8,563
-------------------------------------------------------------------------------
-> drug = sotrovimab
  108
-------------------------------------------------------------------------------
-> drug = paxlovid
  111
-------------------------------------------------------------------------------
-> drug = molnupiravir
  95

-------------------------------------------------------------------------------
-> drug = control
  4,330
-------------------------------------------------------------------------------
-> drug = sotrovimab
  66
-------------------------------------------------------------------------------
-> drug = paxlovid
  58
-------------------------------------------------------------------------------
-> drug = molnupiravir
  54

-------------------------------------------------------------------------------
-> drug = control
  405
-------------------------------------------------------------------------------
-> drug = sotrovimab
  9
-------------------------------------------------------------------------------
-> drug = paxlovid
  3
-------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |  fail_new_ae_psa_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,247      4,653 |    23,900 
  sotrovimab |       257         51 |       308 
    paxlovid |       237         56 |       293 
molnupiravir |       228         46 |       274 
-------------+----------------------+----------
       Total |    19,969      4,806 |    24,775 
new_ae_axspa_ae

-------------------------------------------------------------------------------
-> drug = control
  8,665
-------------------------------------------------------------------------------
-> drug = sotrovimab
  111
-------------------------------------------------------------------------------
-> drug = paxlovid
  114
-------------------------------------------------------------------------------
-> drug = molnupiravir
  103

-------------------------------------------------------------------------------
-> drug = control
  4,390
-------------------------------------------------------------------------------
-> drug = sotrovimab
  56
-------------------------------------------------------------------------------
-> drug = paxlovid
  59
-------------------------------------------------------------------------------
-> drug = molnupiravir
  54

-------------------------------------------------------------------------------
-> drug = control
  407
-------------------------------------------------------------------------------
-> drug = sotrovimab
  4
-------------------------------------------------------------------------------
-> drug = paxlovid
  10
-------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             | fail_new_ae_axspa_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,208      4,692 |    23,900 
  sotrovimab |       249         59 |       308 
    paxlovid |       228         65 |       293 
molnupiravir |       222         52 |       274 
-------------+----------------------+----------
       Total |    19,907      4,868 |    24,775 
new_ae_ibd_ae

-------------------------------------------------------------------------------
-> drug = control
  8,612
-------------------------------------------------------------------------------
-> drug = sotrovimab
  110
-------------------------------------------------------------------------------
-> drug = paxlovid
  91
-------------------------------------------------------------------------------
-> drug = molnupiravir
  106

-------------------------------------------------------------------------------
-> drug = control
  4,278
-------------------------------------------------------------------------------
-> drug = sotrovimab
  59
-------------------------------------------------------------------------------
-> drug = paxlovid
  45
-------------------------------------------------------------------------------
-> drug = molnupiravir
  46

-------------------------------------------------------------------------------
-> drug = control
  394
-------------------------------------------------------------------------------
-> drug = sotrovimab
  5
-------------------------------------------------------------------------------
-> drug = paxlovid
  3
-------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(24,467 missing values generated)
(293 real changes made)
(274 real changes made)
(23,900 real changes made)

             |  fail_new_ae_ibd_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,163      4,737 |    23,900 
  sotrovimab |       252         56 |       308 
    paxlovid |       244         49 |       293 
molnupiravir |       205         69 |       274 
-------------+----------------------+----------
       Total |    19,864      4,911 |    24,775 

. 
. * Add half-day buffer if outcome on indexdate
. foreach x in    $ae $ae_disease ///
>                                 $ae_spc $ae_spc_icd $ae_spc_emerg ///
>                                 $ae_drug $ae_drug_icd $ae_drug_emerg ///
>                                 $ae_imae $ae_imae_icd $ae_imae_emerg ///
>                                 {
  2.         display "`x'"
  3.         replace `x'=`x'+0.75 if `x'==start_date
  4. }
ae_spc_all
(41 real changes made)
ae_drug_all
(38 real changes made)
ae_imae_all
(32 real changes made)
ae_all
(44 real changes made)
allcause_emerg_aande
(2 real changes made)
covid_hosp_date
(3 real changes made)
all_hosp_date
(3 real changes made)
died_date_ons
(10 real changes made)
ae_diverticulitis
(35 real changes made)
ae_diarrhoea
(40 real changes made)
ae_taste
(29 real changes made)
ae_rash
(40 real changes made)
ae_anaphylaxis
(35 real changes made)
ae_severe_drug
(30 real changes made)
ae_nonsevere_drug
(18 real changes made)
ae_ra
(25 real changes made)
ae_sle
(33 real changes made)
ae_psorasis
(31 real changes made)
ae_psa
(25 real changes made)
ae_axspa
(30 real changes made)
ae_ibd
(20 real changes made)
ae_diverticulitis_icd_prim
(25 real changes made)
ae_taste_icd_prim
(18 real changes made)
ae_rash_icd_prim
(15 real changes made)
ae_diarrhoea_icd_prim
(19 real changes made)
ae_diarrhoeal_icd_prim
(18 real changes made)
ae_diverticulitis_ae
(12 real changes made)
ae_rash_ae
(18 real changes made)
ae_anaphylaxis_icd_prim
(22 real changes made)
ae_severedrug_icd_prim
(20 real changes made)
ae_severedrug_sjs_icd_prim
(13 real changes made)
ae_anaphlaxis_ae
(16 real changes made)
ae_severedrug_ae
(10 real changes made)
ae_nonsevere_drug_ae
(16 real changes made)
new_ae_ra_icd_prim
(13 real changes made)
new_ae_sle_icd_prim
(14 real changes made)
new_ae_psoriasis_icd_prim
(19 real changes made)
new_ae_psa_icd_prim
(11 real changes made)
new_ae_axspa_icd_prim
(21 real changes made)
new_ae_ibd_icd_prim
(8 real changes made)
new_ae_ra_ae
(11 real changes made)
new_ae_sle_ae
(14 real changes made)
new_ae_psoriasis_ae
(13 real changes made)
new_ae_psa_ae
(15 real changes made)
new_ae_axspa_ae
(16 real changes made)
new_ae_ibd_ae
(12 real changes made)

. 
. *Generate censor date
. foreach x in    $ae $ae_disease ///
>                                 $ae_spc $ae_spc_icd $ae_spc_emerg ///
>                                 $ae_drug $ae_drug_icd $ae_drug_emerg ///
>                                 $ae_imae $ae_imae_icd $ae_imae_emerg ///
>                                 {
  2.         gen stop_`x'=`x' if fail_`x'==1
  3.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_da
> te_29,paxlovid,molnupiravir) if fail_`x'==0&drug==1
  4.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_da
> te_29,sotrovimab,molnupiravir) if fail_`x'==0&drug==2
  5.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_da
> te_29,sotrovimab,paxlovid) if fail_`x'==0&drug==3
  6.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_da
> te_29,sotrovimab,paxlovid,molnupiravir) if fail_`x'==0&drug==0
  7.         format %td stop_`x'
  8. }
(6,687 missing values generated)
(88 real changes made)
(75 real changes made)
(67 real changes made)
(6,457 real changes made)
(7,636 missing values generated)
(110 real changes made)
(86 real changes made)
(80 real changes made)
(7,360 real changes made)
(4,398 missing values generated)
(49 real changes made)
(46 real changes made)
(45 real changes made)
(4,258 real changes made)
(1,715 missing values generated)
(20 real changes made)
(18 real changes made)
(17 real changes made)
(1,660 real changes made)
(24,186 missing values generated)
(299 real changes made)
(286 real changes made)
(262 real changes made)
(23,339 real changes made)
(23,517 missing values generated)
(289 real changes made)
(280 real changes made)
(255 real changes made)
(22,693 real changes made)
(23,604 missing values generated)
(302 real changes made)
(285 real changes made)
(258 real changes made)
(22,759 real changes made)
(14,251 missing values generated)
(173 real changes made)
(153 real changes made)
(150 real changes made)
(13,775 real changes made)
(12,625 missing values generated)
(153 real changes made)
(141 real changes made)
(135 real changes made)
(12,196 real changes made)
(12,640 missing values generated)
(177 real changes made)
(149 real changes made)
(127 real changes made)
(12,187 real changes made)
(15,533 missing values generated)
(193 real changes made)
(188 real changes made)
(151 real changes made)
(15,001 real changes made)
(12,580 missing values generated)
(158 real changes made)
(150 real changes made)
(143 real changes made)
(12,129 real changes made)
(12,719 missing values generated)
(171 real changes made)
(137 real changes made)
(138 real changes made)
(12,273 real changes made)
(10,489 missing values generated)
(142 real changes made)
(128 real changes made)
(106 real changes made)
(10,113 real changes made)
(15,405 missing values generated)
(205 real changes made)
(153 real changes made)
(171 real changes made)
(14,876 real changes made)
(13,808 missing values generated)
(174 real changes made)
(166 real changes made)
(162 real changes made)
(13,306 real changes made)
(13,901 missing values generated)
(170 real changes made)
(156 real changes made)
(137 real changes made)
(13,438 real changes made)
(13,947 missing values generated)
(174 real changes made)
(157 real changes made)
(137 real changes made)
(13,479 real changes made)
(13,913 missing values generated)
(181 real changes made)
(169 real changes made)
(151 real changes made)
(13,412 real changes made)
(13,917 missing values generated)
(173 real changes made)
(154 real changes made)
(165 real changes made)
(13,425 real changes made)
(13,856 missing values generated)
(170 real changes made)
(166 real changes made)
(150 real changes made)
(13,370 real changes made)
(19,335 missing values generated)
(234 real changes made)
(227 real changes made)
(215 real changes made)
(18,659 real changes made)
(19,377 missing values generated)
(244 real changes made)
(236 real changes made)
(215 real changes made)
(18,682 real changes made)
(19,346 missing values generated)
(246 real changes made)
(224 real changes made)
(211 real changes made)
(18,665 real changes made)
(19,412 missing values generated)
(253 real changes made)
(220 real changes made)
(218 real changes made)
(18,721 real changes made)
(19,327 missing values generated)
(243 real changes made)
(230 real changes made)
(205 real changes made)
(18,649 real changes made)
(19,349 missing values generated)
(248 real changes made)
(223 real changes made)
(202 real changes made)
(18,676 real changes made)
(19,403 missing values generated)
(232 real changes made)
(240 real changes made)
(215 real changes made)
(18,716 real changes made)
(19,467 missing values generated)
(250 real changes made)
(221 real changes made)
(210 real changes made)
(18,786 real changes made)
(19,422 missing values generated)
(250 real changes made)
(239 real changes made)
(208 real changes made)
(18,725 real changes made)
(19,281 missing values generated)
(244 real changes made)
(240 real changes made)
(219 real changes made)
(18,578 real changes made)
(19,444 missing values generated)
(242 real changes made)
(221 real changes made)
(217 real changes made)
(18,764 real changes made)
(19,322 missing values generated)
(237 real changes made)
(232 real changes made)
(202 real changes made)
(18,651 real changes made)
(19,408 missing values generated)
(242 real changes made)
(199 real changes made)
(209 real changes made)
(18,758 real changes made)
(19,918 missing values generated)
(248 real changes made)
(236 real changes made)
(227 real changes made)
(19,207 real changes made)
(19,898 missing values generated)
(251 real changes made)
(229 real changes made)
(218 real changes made)
(19,200 real changes made)
(19,909 missing values generated)
(248 real changes made)
(238 real changes made)
(219 real changes made)
(19,204 real changes made)
(19,978 missing values generated)
(244 real changes made)
(232 real changes made)
(209 real changes made)
(19,293 real changes made)
(19,899 missing values generated)
(251 real changes made)
(228 real changes made)
(223 real changes made)
(19,197 real changes made)
(19,877 missing values generated)
(242 real changes made)
(231 real changes made)
(223 real changes made)
(19,181 real changes made)
(19,888 missing values generated)
(248 real changes made)
(229 real changes made)
(219 real changes made)
(19,192 real changes made)
(19,883 missing values generated)
(241 real changes made)
(226 real changes made)
(218 real changes made)
(19,198 real changes made)
(19,988 missing values generated)
(243 real changes made)
(232 real changes made)
(209 real changes made)
(19,304 real changes made)
(19,969 missing values generated)
(257 real changes made)
(237 real changes made)
(228 real changes made)
(19,247 real changes made)
(19,907 missing values generated)
(249 real changes made)
(228 real changes made)
(222 real changes made)
(19,208 real changes made)
(19,864 missing values generated)
(252 real changes made)
(244 real changes made)
(205 real changes made)
(19,163 real changes made)

. 
. * Follow-up time
. stset stop_ae_all, id(patient_id) origin(time start_date) enter(time start_da
> te) failure(fail_ae_all==1) 

                id:  patient_id
     failure event:  fail_ae_all == 1
obs. time interval:  (stop_ae_all[_n-1], stop_ae_all]
 enter on or after:  time start_date
 exit on or before:  failure
    t for analysis:  (time-origin)
            origin:  time start_date

------------------------------------------------------------------------------
     24,775  total observations
     21,994  observations end on or before enter()
------------------------------------------------------------------------------
      2,781  observations remaining, representing
      2,781  subjects
      1,073  failures in single-failure-per-subject data
     62,632  total analysis time at risk and under observation
                                                at risk from t =         0
                                     earliest observed entry t =         0
                                          last observed exit t =        29

. *count censored due to second therapy*
. count if fail_ae_all==0&drug==1&min(paxlovid,molnupiravir)==stop_ae_all
  0

. count if fail_ae_all==0&drug==2&min(sotrovimab,molnupiravir)==stop_ae_all
  0

. count if fail_ae_all==0&drug==3&min(sotrovimab,paxlovid)==stop_ae_all
  0

. count if fail_ae_all==0&drug==0&min(sotrovimab,paxlovid,molnupiravir)==stop_a
> e_all
  0

. tab _st  // keep if _st==1 -> removes observations that end on or before ente
> r 

1 if record |
   is to be |
    used; 0 |
  otherwise |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     21,994       88.77       88.77
          1 |      2,781       11.23      100.00
------------+-----------------------------------
      Total |     24,775      100.00

. count if start_date>=stop_ae_all & _st==0
  21,994

. count if start_date==stop_ae_all & _st==0
  7

. tab _t,m

   analysis |
  time when |
record ends |      Freq.     Percent        Cum.
------------+-----------------------------------
        .75 |         44        0.18        0.18
          1 |         49        0.20        0.38
          2 |         48        0.19        0.57
          3 |         39        0.16        0.73
          4 |         49        0.20        0.92
          5 |         52        0.21        1.13
          6 |         57        0.23        1.36
          7 |         52        0.21        1.57
          8 |         40        0.16        1.74
          9 |         38        0.15        1.89
         10 |         41        0.17        2.05
         11 |         34        0.14        2.19
         12 |         45        0.18        2.37
         13 |         39        0.16        2.53
         14 |         40        0.16        2.69
         15 |         20        0.08        2.77
         16 |         43        0.17        2.95
         17 |         27        0.11        3.06
         18 |         38        0.15        3.21
         19 |         31        0.13        3.33
         20 |         37        0.15        3.48
         21 |         26        0.10        3.59
         22 |         24        0.10        3.69
         23 |         30        0.12        3.81
         24 |         27        0.11        3.92
         25 |         28        0.11        4.03
         26 |         27        0.11        4.14
         27 |         25        0.10        4.24
         28 |         26        0.10        4.34
         29 |      1,705        6.88       11.23
          . |     21,994       88.77      100.00
------------+-----------------------------------
      Total |     24,775      100.00

. tab _t drug,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  analysis |
 time when |
    record |                    drug
      ends |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
       .75 |        43          0          0          1 |        44 
           |      0.18       0.00       0.00       0.36 |      0.18 
-----------+--------------------------------------------+----------
         1 |        46          2          1          0 |        49 
           |      0.19       0.65       0.34       0.00 |      0.20 
-----------+--------------------------------------------+----------
         2 |        47          0          1          0 |        48 
           |      0.20       0.00       0.34       0.00 |      0.19 
-----------+--------------------------------------------+----------
         3 |        34          3          2          0 |        39 
           |      0.14       0.97       0.68       0.00 |      0.16 
-----------+--------------------------------------------+----------
         4 |        48          1          0          0 |        49 
           |      0.20       0.32       0.00       0.00 |      0.20 
-----------+--------------------------------------------+----------
         5 |        51          0          0          1 |        52 
           |      0.21       0.00       0.00       0.36 |      0.21 
-----------+--------------------------------------------+----------
         6 |        56          1          0          0 |        57 
           |      0.23       0.32       0.00       0.00 |      0.23 
-----------+--------------------------------------------+----------
         7 |        51          1          0          0 |        52 
           |      0.21       0.32       0.00       0.00 |      0.21 
-----------+--------------------------------------------+----------
         8 |        38          0          1          1 |        40 
           |      0.16       0.00       0.34       0.36 |      0.16 
-----------+--------------------------------------------+----------
         9 |        36          0          1          1 |        38 
           |      0.15       0.00       0.34       0.36 |      0.15 
-----------+--------------------------------------------+----------
        10 |        41          0          0          0 |        41 
           |      0.17       0.00       0.00       0.00 |      0.17 
-----------+--------------------------------------------+----------
        11 |        32          2          0          0 |        34 
           |      0.13       0.65       0.00       0.00 |      0.14 
-----------+--------------------------------------------+----------
        12 |        44          0          0          1 |        45 
           |      0.18       0.00       0.00       0.36 |      0.18 
-----------+--------------------------------------------+----------
        13 |        36          2          1          0 |        39 
           |      0.15       0.65       0.34       0.00 |      0.16 
-----------+--------------------------------------------+----------
        14 |        39          1          0          0 |        40 
           |      0.16       0.32       0.00       0.00 |      0.16 
-----------+--------------------------------------------+----------
        15 |        19          1          0          0 |        20 
           |      0.08       0.32       0.00       0.00 |      0.08 
-----------+--------------------------------------------+----------
        16 |        41          1          0          1 |        43 
           |      0.17       0.32       0.00       0.36 |      0.17 
-----------+--------------------------------------------+----------
        17 |        27          0          0          0 |        27 
           |      0.11       0.00       0.00       0.00 |      0.11 
-----------+--------------------------------------------+----------
        18 |        37          1          0          0 |        38 
           |      0.15       0.32       0.00       0.00 |      0.15 
-----------+--------------------------------------------+----------
        19 |        29          1          1          0 |        31 
           |      0.12       0.32       0.34       0.00 |      0.13 
-----------+--------------------------------------------+----------
        20 |        36          1          0          0 |        37 
           |      0.15       0.32       0.00       0.00 |      0.15 
-----------+--------------------------------------------+----------
        21 |        25          0          1          0 |        26 
           |      0.10       0.00       0.34       0.00 |      0.10 
-----------+--------------------------------------------+----------
        22 |        24          0          0          0 |        24 
           |      0.10       0.00       0.00       0.00 |      0.10 
-----------+--------------------------------------------+----------
        23 |        29          0          1          0 |        30 
           |      0.12       0.00       0.34       0.00 |      0.12 
-----------+--------------------------------------------+----------
        24 |        24          0          3          0 |        27 
           |      0.10       0.00       1.02       0.00 |      0.11 
-----------+--------------------------------------------+----------
        25 |        26          1          1          0 |        28 
           |      0.11       0.32       0.34       0.00 |      0.11 
-----------+--------------------------------------------+----------
        26 |        27          0          0          0 |        27 
           |      0.11       0.00       0.00       0.00 |      0.11 
-----------+--------------------------------------------+----------
        27 |        24          0          0          1 |        25 
           |      0.10       0.00       0.00       0.36 |      0.10 
-----------+--------------------------------------------+----------
        28 |        25          0          1          0 |        26 
           |      0.10       0.00       0.34       0.00 |      0.10 
-----------+--------------------------------------------+----------
        29 |     1,649         20         19         17 |     1,705 
           |      6.90       6.49       6.48       6.20 |      6.88 
-----------+--------------------------------------------+----------
         . |    21,216        269        259        250 |    21,994 
           |     88.77      87.34      88.40      91.24 |     88.77 
-----------+--------------------------------------------+----------
     Total |    23,900        308        293        274 |    24,775 
           |    100.00     100.00     100.00     100.00 |    100.00 

. tab _t drug if fail_ae_all==1,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  analysis |
 time when |
    record |                    drug
      ends |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
       .75 |        43          0          0          1 |        44 
           |      0.19       0.00       0.00       0.39 |      0.19 
-----------+--------------------------------------------+----------
         1 |        40          2          1          0 |        43 
           |      0.18       0.69       0.36       0.00 |      0.19 
-----------+--------------------------------------------+----------
         2 |        36          0          1          0 |        37 
           |      0.16       0.00       0.36       0.00 |      0.16 
-----------+--------------------------------------------+----------
         3 |        30          3          2          0 |        35 
           |      0.13       1.04       0.73       0.00 |      0.15 
-----------+--------------------------------------------+----------
         4 |        39          1          0          0 |        40 
           |      0.18       0.35       0.00       0.00 |      0.17 
-----------+--------------------------------------------+----------
         5 |        48          0          0          1 |        49 
           |      0.22       0.00       0.00       0.39 |      0.21 
-----------+--------------------------------------------+----------
         6 |        52          1          0          0 |        53 
           |      0.23       0.35       0.00       0.00 |      0.23 
-----------+--------------------------------------------+----------
         7 |        49          1          0          0 |        50 
           |      0.22       0.35       0.00       0.00 |      0.22 
-----------+--------------------------------------------+----------
         8 |        38          0          1          1 |        40 
           |      0.17       0.00       0.36       0.39 |      0.17 
-----------+--------------------------------------------+----------
         9 |        36          0          1          1 |        38 
           |      0.16       0.00       0.36       0.39 |      0.16 
-----------+--------------------------------------------+----------
        10 |        41          0          0          0 |        41 
           |      0.18       0.00       0.00       0.00 |      0.18 
-----------+--------------------------------------------+----------
        11 |        32          2          0          0 |        34 
           |      0.14       0.69       0.00       0.00 |      0.15 
-----------+--------------------------------------------+----------
        12 |        44          0          0          1 |        45 
           |      0.20       0.00       0.00       0.39 |      0.20 
-----------+--------------------------------------------+----------
        13 |        36          2          1          0 |        39 
           |      0.16       0.69       0.36       0.00 |      0.17 
-----------+--------------------------------------------+----------
        14 |        39          1          0          0 |        40 
           |      0.18       0.35       0.00       0.00 |      0.17 
-----------+--------------------------------------------+----------
        15 |        19          1          0          0 |        20 
           |      0.09       0.35       0.00       0.00 |      0.09 
-----------+--------------------------------------------+----------
        16 |        41          1          0          1 |        43 
           |      0.18       0.35       0.00       0.39 |      0.19 
-----------+--------------------------------------------+----------
        17 |        27          0          0          0 |        27 
           |      0.12       0.00       0.00       0.00 |      0.12 
-----------+--------------------------------------------+----------
        18 |        37          1          0          0 |        38 
           |      0.17       0.35       0.00       0.00 |      0.16 
-----------+--------------------------------------------+----------
        19 |        29          1          1          0 |        31 
           |      0.13       0.35       0.36       0.00 |      0.13 
-----------+--------------------------------------------+----------
        20 |        36          1          0          0 |        37 
           |      0.16       0.35       0.00       0.00 |      0.16 
-----------+--------------------------------------------+----------
        21 |        25          0          1          0 |        26 
           |      0.11       0.00       0.36       0.00 |      0.11 
-----------+--------------------------------------------+----------
        22 |        24          0          0          0 |        24 
           |      0.11       0.00       0.00       0.00 |      0.10 
-----------+--------------------------------------------+----------
        23 |        29          0          1          0 |        30 
           |      0.13       0.00       0.36       0.00 |      0.13 
-----------+--------------------------------------------+----------
        24 |        24          0          3          0 |        27 
           |      0.11       0.00       1.09       0.00 |      0.12 
-----------+--------------------------------------------+----------
        25 |        26          1          1          0 |        28 
           |      0.12       0.35       0.36       0.00 |      0.12 
-----------+--------------------------------------------+----------
        26 |        27          0          0          0 |        27 
           |      0.12       0.00       0.00       0.00 |      0.12 
-----------+--------------------------------------------+----------
        27 |        24          0          0          1 |        25 
           |      0.11       0.00       0.00       0.39 |      0.11 
-----------+--------------------------------------------+----------
        28 |        25          0          1          0 |        26 
           |      0.11       0.00       0.36       0.00 |      0.11 
-----------+--------------------------------------------+----------
        29 |        35          0          1          0 |        36 
           |      0.16       0.00       0.36       0.00 |      0.16 
-----------+--------------------------------------------+----------
         . |    21,209        269        259        250 |    21,987 
           |     95.36      93.40      94.18      97.28 |     95.35 
-----------+--------------------------------------------+----------
     Total |    22,240        288        275        257 |    23,060 
           |    100.00     100.00     100.00     100.00 |    100.00 

. tab _t drug if fail_ae_all==1&stop_ae_all==ae_all

  analysis |
 time when |
    record |                    drug
      ends |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
       .75 |        43          0          0          1 |        44 
         1 |        40          2          1          0 |        43 
         2 |        36          0          1          0 |        37 
         3 |        30          3          2          0 |        35 
         4 |        39          1          0          0 |        40 
         5 |        48          0          0          1 |        49 
         6 |        52          1          0          0 |        53 
         7 |        49          1          0          0 |        50 
         8 |        38          0          1          1 |        40 
         9 |        36          0          1          1 |        38 
        10 |        41          0          0          0 |        41 
        11 |        32          2          0          0 |        34 
        12 |        44          0          0          1 |        45 
        13 |        36          2          1          0 |        39 
        14 |        39          1          0          0 |        40 
        15 |        19          1          0          0 |        20 
        16 |        41          1          0          1 |        43 
        17 |        27          0          0          0 |        27 
        18 |        37          1          0          0 |        38 
        19 |        29          1          1          0 |        31 
        20 |        36          1          0          0 |        37 
        21 |        25          0          1          0 |        26 
        22 |        24          0          0          0 |        24 
        23 |        29          0          1          0 |        30 
        24 |        24          0          3          0 |        27 
        25 |        26          1          1          0 |        28 
        26 |        27          0          0          0 |        27 
        27 |        24          0          0          1 |        25 
        28 |        25          0          1          0 |        26 
        29 |        35          0          1          0 |        36 
-----------+--------------------------------------------+----------
     Total |     1,031         19         16          7 |     1,073 

. tab fail_ae_all drug,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

fail_ae_al |                    drug
         l |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
         0 |     1,660         20         18         17 |     1,715 
           |      6.95       6.49       6.14       6.20 |      6.92 
-----------+--------------------------------------------+----------
         1 |    22,240        288        275        257 |    23,060 
           |     93.05      93.51      93.86      93.80 |     93.08 
-----------+--------------------------------------------+----------
     Total |    23,900        308        293        274 |    24,775 
           |    100.00     100.00     100.00     100.00 |    100.00 

. *check censor reasons*
. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==ae_all,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==death_date,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  analysis |
 time when |
    record |    drug
      ends |   control |     Total
-----------+-----------+----------
         1 |         2 |         2 
           |     11.11 |     11.11 
-----------+-----------+----------
         2 |         6 |         6 
           |     33.33 |     33.33 
-----------+-----------+----------
         3 |         1 |         1 
           |      5.56 |      5.56 
-----------+-----------+----------
         4 |         2 |         2 
           |     11.11 |     11.11 
-----------+-----------+----------
         5 |         2 |         2 
           |     11.11 |     11.11 
-----------+-----------+----------
         6 |         3 |         3 
           |     16.67 |     16.67 
-----------+-----------+----------
         7 |         2 |         2 
           |     11.11 |     11.11 
-----------+-----------+----------
     Total |        18 |        18 
           |    100.00 |    100.00 

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==dereg_date,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  analysis |
 time when |
    record |    drug
      ends |   control |     Total
-----------+-----------+----------
         1 |         4 |         4 
           |     19.05 |     19.05 
-----------+-----------+----------
         2 |         5 |         5 
           |     23.81 |     23.81 
-----------+-----------+----------
         3 |         3 |         3 
           |     14.29 |     14.29 
-----------+-----------+----------
         4 |         7 |         7 
           |     33.33 |     33.33 
-----------+-----------+----------
         5 |         1 |         1 
           |      4.76 |      4.76 
-----------+-----------+----------
         6 |         1 |         1 
           |      4.76 |      4.76 
-----------+-----------+----------
     Total |        21 |        21 
           |    100.00 |    100.00 

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(paxlovid,molnupiravir)&d
> rug==1,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(sotrovimab,molnupiravir)
> &drug==2,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(sotrovimab,paxlovid)&dru
> g==3,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(sotrovimab,paxlovid,moln
> upiravir)&drug==0,m col
no observations

. 
. 
. save "$projectdir/output/data/main.dta", replace
(note: file /workspace/output/data/main.dta not found)
file /workspace/output/data/main.dta saved

. 
. log close
      name:  <unnamed>
       log:  /workspace/logs/cleaning_dataset_combine.log
  log type:  text
 closed on:   8 Aug 2023, 14:43:53
-------------------------------------------------------------------------------

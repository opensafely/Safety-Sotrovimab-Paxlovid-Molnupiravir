-------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and antivir
> als\Safety-Sotrovimab-Paxlovid-Molnupiravir/logs/cleaning_dataset.log
  log type:  text
 opened on:   3 Jul 2023, 09:43:46

. 
. *Set Ado file path
. adopath + "$projectdir/analysis/ado"
  [1]  (BASE)      "C:\Program Files\Stata17\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata17\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "C:\users\PUBLIC\documents/"
  [5]  (PLUS)      "C:\users\PUBLIC\documents/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and 
> antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir/analysis/ado"

. 
. *       Import control dataset
. import delimited "$projectdir/output/input_control.csv", clear
(encoding automatically selected: ISO-8859-1)
(211 vars, 50,000 obs)

. gen control_dataset=1

. *       Convert control strings to dates     * 
. foreach var of varlist   covid_test_positive_date                               ///
>                                                  covid_test_positive_date2                           
>    ///
>                                                  covid_test_positive_date3                           
>    ///
>                                                  covid_test_positive_treat                           
>    ///
>                                                  prior_covid_date                                    
>    ///
>                                                  sotrovimab                                          
>                    ///
>                                                  molnupiravir                                        
>            /// 
>                                                  paxlovid                                            
>                    ///
>                                                  remdesivir                                          
>                    ///
>                                                  casirivimab                                         
>            ///
>                                                  sotrovimab_not_start                                
>    ///
>                                                  molnupiravir_not_start                              
>    ///
>                                                  paxlovid_not_start                                  
>            ///
>                                                  date_treated                                        
>            ///
>                                                  start_date                                          
>                    ///
>                                                  drugs_paxlovid_interaction                          
>    ///
>                                                  drugs_nirmatrelvir_interaction                 ///
>                                                  last_vaccination_date                               
>    ///
>                                                  death_date                                          
>                    ///
>                                                  dereg_date                                          
>            ///
>                                                  bmi_date_measured                                   
>            ///
>                                                  creatinine_ctv3_date                                
>    ///
>                                                  creatinine_snomed_date                              
>    ///
>                                                  creatinine_short_snomed_date                   ///
>                                                  ae_diverticulitis_icd                               
>    ///
>                                                  ae_diverticulitis_snomed                            
>    ///
>                                                  ae_diarrhoea_snomed                                 
>    ///
>                                                  ae_taste_snomed                                     
>            ///
>                                                  ae_taste_icd                                        
>            ///
>                                                  ae_rash_snomed                                      
>            ///
>                                                  ae_anaphylaxis_icd                                  
>            ///
>                                                  ae_anaphylaxis_snomed                               
>    ///
>                                                  ae_anaphlaxis_ae                                    
>            ///
>                                                  ae_drugreact_ae                                     
>            ///
>                                                  ae_allergic_ae                                      
>            ///
>                                                  ae_rheumatoid_arthritis_snomed                 ///
>                                                  ae_rheumatoid_arthritis_icd                    ///
>                                                  ae_sle_ctv                                          
>                    ///
>                                                  ae_sle_icd                                          
>                    ///
>                                                  ae_psoriasis_snomed                                 
>    ///
>                                                  ae_psoriatic_arthritis_snomed                  ///
>                                                  ae_ankylosing_spondylitis_ctv                  ///
>                                                  ae_ibd_snomed                                       
>            ///
>                                                  ae_diverticulitis_ae                                
>    ///
>                                                  ae_rheumatoid_arthritis_ae                          
>    ///
>                                                  ae_sle_ae                                           
>                    ///
>                                                  ae_psoriasis_ae                                     
>            ///
>                                                  ae_psoriatic_arthritis_ae                           
>    ///
>                                                  ae_ankylosing_spondylitis_ae                   ///
>                                                  ae_ibd_ae                                           
>                    ///
>                                                  rheumatoid_arthritis_nhsd_snomed               ///
>                                                  rheumatoid_arthritis_nhsd_icd10                ///
>                                                  sle_nhsd_ctv                                        
>            ///
>                                                  sle_nhsd_icd10                                      
>            ///
>                                                  psoriasis_nhsd                                      
>            ///
>                                                  psoriatic_arthritis_nhsd                            
>    ///
>                                                  ankylosing_spondylitis_nhsd                    ///
>                                                  ibd_ctv                                             
>                    ///
>                                                  allcause_emerg_aande                                
>    ///
>                                                  all_hosp_date                                       
>            ///
>                                                  all_hosp_date0                                      
>            ///
>                                                  all_hosp_date1                                      
>            ///
>                                                  all_hosp_date2                                      
>            ///
>                                                  hosp_discharge_date                                 
>    ///
>                                                  hosp_discharge_date0                                
>    ///
>                                                  hosp_discharge_date1                                
>    ///
>                                                  hosp_discharge_date2                                
>    ///
>                                                  covid_hosp_date                                     
>            ///
>                                                  covid_hosp_date0                                    
>            ///
>                                                  covid_hosp_date1                                    
>            ///
>                                                  covid_hosp_date2                                    
>            ///                                             
>                                                  covid_discharge_date                                
>    ///
>                                                  covid_discharge_date0                               
>    ///                                             
>                                                  covid_discharge_date1                               
>    /// 
>                                                  covid_discharge_date2                               
>    /// 
>                                                  any_covid_hosp_discharge                            
>    ///                     
>                                                  covid_hosp_date_mabs                                
>    /// 
>                                                  covid_hosp_date_mabs_not_primary               /// 
>                                                  died_date_ons                                       
>            ///
>                                                  died_ons_covid                                      
>            ///
>                                                  pre_diverticulitis_icd                              
>    ///
>                                                  pre_diverticulitis_snomed                           
>    ///
>                                                  pre_diverticulitis_ae                               
>    ///
>                                                  pre_diarrhoea_snomed                                
>    ///
>                                                  pre_taste_snomed                                    
>            ///
>                                                  pre_taste_icd                                       
>            ///
>                                                  pre_rash_snomed                                     
>            ///
>                                                  pre_anaphylaxis_icd                                 
>    ///
>                                                  pre_anaphylaxis_snomed                              
>    ///
>                                                  pre_anaphlaxis_ae                                   
>            ///
>                                                  pre_drugreact_ae                                    
>            ///
>                                                  pre_allergic_ae                                     
>            ///
>                                                  pre_anaphlaxis_ae                                   
>            ///
>                                                  pre_rheumatoid_arthritis_ae                    ///
>                                                  pre_rheumatoid_arthritis_snomed                ///
>                                                  pre_rheumatoid_arthritis_icd                   ///
>                                                  pre_ankylosing_spondylitis_ctv                 ///
>                                                  pre_ankylosing_spondylitis_ae                  ///
>                                                  pre_psoriasis_snomed                                
>    ///
>                                                  pre_psoriasis_ae                                    
>            ///
>                                                  pre_psoriatic_arthritis_ae                          
>    ///
>                                                  pre_psoriatic_arthritis_snomed                 ///
>                                                  pre_sle_ctv                                         
>            ///
>                                                  pre_sle_icd                                         
>            ///
>                                                  pre_sle_ae                                          
>                    ///
>                                                  pre_ibd_ae                                          
>                    ///
>                                                  pre_ibd_snomed {                                    
>     
  2.         capture confirm string variable `var'
  3.         if _rc==0 {
  4.         rename `var' a
  5.         gen `var' = date(a, "YMD")
  6.         drop a
  7.         format %td `var'
  8.  }
  9. }
(4,999 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(30,000 missing values generated)
(4,999 missing values generated)
(49,950 missing values generated)
(49,950 missing values generated)
(49,950 missing values generated)
(49,950 missing values generated)
(49,950 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,751 missing values generated)
(47,500 missing values generated)
(47,500 missing values generated)
(2,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(2,500 missing values generated)
(25,000 missing values generated)
(25,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(20,000 missing values generated)
(20,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)

. save "$projectdir/output/data/control.dta", replace 
file C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and
    antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir/output/data/control.dta saved

. 
. * import treatment dataset
. import delimited "$projectdir/output/input_treatment.csv", clear
(encoding automatically selected: ISO-8859-1)
(211 vars, 50,000 obs)

. gen treatment_dataset=1

. *       Convert control strings to dates     * 
. foreach var of varlist   covid_test_positive_date                               ///
>                                                  covid_test_positive_date2                           
>    ///
>                                                  covid_test_positive_date3                           
>    ///
>                                                  covid_test_positive_treat                           
>    ///
>                                                  prior_covid_date                                    
>    ///
>                                                  sotrovimab                                          
>                    ///
>                                                  molnupiravir                                        
>            /// 
>                                                  paxlovid                                            
>                    ///
>                                                  remdesivir                                          
>                    ///
>                                                  casirivimab                                         
>            ///
>                                                  sotrovimab_not_start                                
>    ///
>                                                  molnupiravir_not_start                              
>    ///
>                                                  paxlovid_not_start                                  
>            ///
>                                                  date_treated                                        
>            ///
>                                                  start_date                                          
>                    ///
>                                                  drugs_paxlovid_interaction                          
>    ///
>                                                  drugs_nirmatrelvir_interaction                 ///
>                                                  last_vaccination_date                               
>    ///
>                                                  death_date                                          
>                    ///
>                                                  dereg_date                                          
>            ///
>                                                  bmi_date_measured                                   
>            ///
>                                                  creatinine_ctv3_date                                
>    ///
>                                                  creatinine_snomed_date                              
>    ///
>                                                  creatinine_short_snomed_date                   ///
>                                                  ae_diverticulitis_icd                               
>    ///
>                                                  ae_diverticulitis_snomed                            
>    ///
>                                                  ae_diarrhoea_snomed                                 
>    ///
>                                                  ae_taste_snomed                                     
>            ///
>                                                  ae_taste_icd                                        
>            ///
>                                                  ae_rash_snomed                                      
>            ///
>                                                  ae_anaphylaxis_icd                                  
>            ///
>                                                  ae_anaphylaxis_snomed                               
>    ///
>                                                  ae_anaphlaxis_ae                                    
>            ///
>                                                  ae_drugreact_ae                                     
>            ///
>                                                  ae_allergic_ae                                      
>            ///
>                                                  ae_rheumatoid_arthritis_snomed                 ///
>                                                  ae_rheumatoid_arthritis_icd                    ///
>                                                  ae_sle_ctv                                          
>                    ///
>                                                  ae_sle_icd                                          
>                    ///
>                                                  ae_psoriasis_snomed                                 
>    ///
>                                                  ae_psoriatic_arthritis_snomed                  ///
>                                                  ae_ankylosing_spondylitis_ctv                  ///
>                                                  ae_ibd_snomed                                       
>            ///
>                                                  ae_diverticulitis_ae                                
>    ///
>                                                  ae_rheumatoid_arthritis_ae                          
>    ///
>                                                  ae_sle_ae                                           
>                    ///
>                                                  ae_psoriasis_ae                                     
>            ///
>                                                  ae_psoriatic_arthritis_ae                           
>    ///
>                                                  ae_ankylosing_spondylitis_ae                   ///
>                                                  ae_ibd_ae                                           
>                    ///
>                                                  rheumatoid_arthritis_nhsd_snomed               ///
>                                                  rheumatoid_arthritis_nhsd_icd10                ///
>                                                  sle_nhsd_ctv                                        
>            ///
>                                                  sle_nhsd_icd10                                      
>            ///
>                                                  psoriasis_nhsd                                      
>            ///
>                                                  psoriatic_arthritis_nhsd                            
>    ///
>                                                  ankylosing_spondylitis_nhsd                    ///
>                                                  ibd_ctv                                             
>                    ///
>                                                  allcause_emerg_aande                                
>    ///
>                                                  all_hosp_date                                       
>            ///
>                                                  all_hosp_date0                                      
>            ///
>                                                  all_hosp_date1                                      
>            ///
>                                                  all_hosp_date2                                      
>            ///
>                                                  hosp_discharge_date                                 
>    ///
>                                                  hosp_discharge_date0                                
>    ///
>                                                  hosp_discharge_date1                                
>    ///
>                                                  hosp_discharge_date2                                
>    ///
>                                                  covid_hosp_date                                     
>            ///
>                                                  covid_hosp_date0                                    
>            ///
>                                                  covid_hosp_date1                                    
>            ///
>                                                  covid_hosp_date2                                    
>            ///                                             
>                                                  covid_discharge_date                                
>    ///
>                                                  covid_discharge_date0                               
>    ///                                             
>                                                  covid_discharge_date1                               
>    /// 
>                                                  covid_discharge_date2                               
>    /// 
>                                                  any_covid_hosp_discharge                            
>    ///                     
>                                                  covid_hosp_date_mabs                                
>    /// 
>                                                  covid_hosp_date_mabs_not_primary               /// 
>                                                  died_date_ons                                       
>            ///
>                                                  died_ons_covid                                      
>            ///
>                                                  pre_diverticulitis_icd                              
>    ///
>                                                  pre_diverticulitis_snomed                           
>    ///
>                                                  pre_diverticulitis_ae                               
>    ///
>                                                  pre_diarrhoea_snomed                                
>    ///
>                                                  pre_taste_snomed                                    
>            ///
>                                                  pre_taste_icd                                       
>            ///
>                                                  pre_rash_snomed                                     
>            ///
>                                                  pre_anaphylaxis_icd                                 
>    ///
>                                                  pre_anaphylaxis_snomed                              
>    ///
>                                                  pre_anaphlaxis_ae                                   
>            ///
>                                                  pre_drugreact_ae                                    
>            ///
>                                                  pre_allergic_ae                                     
>            ///
>                                                  pre_anaphlaxis_ae                                   
>            ///
>                                                  pre_rheumatoid_arthritis_ae                    ///
>                                                  pre_rheumatoid_arthritis_snomed                ///
>                                                  pre_rheumatoid_arthritis_icd                   ///
>                                                  pre_ankylosing_spondylitis_ctv                 ///
>                                                  pre_ankylosing_spondylitis_ae                  ///
>                                                  pre_psoriasis_snomed                                
>    ///
>                                                  pre_psoriasis_ae                                    
>            ///
>                                                  pre_psoriatic_arthritis_ae                          
>    ///
>                                                  pre_psoriatic_arthritis_snomed                 ///
>                                                  pre_sle_ctv                                         
>            ///
>                                                  pre_sle_icd                                         
>            ///
>                                                  pre_sle_ae                                          
>                    ///
>                                                  pre_ibd_ae                                          
>                    ///
>                                                  pre_ibd_snomed {                                    
>     
  2.         capture confirm string variable `var'
  3.         if _rc==0 {
  4.         rename `var' a
  5.         gen `var' = date(a, "YMD")
  6.         drop a
  7.         format %td `var'
  8.  }
  9. }
(4,999 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(30,000 missing values generated)
(4,999 missing values generated)
(40,000 missing values generated)
(40,000 missing values generated)
(40,000 missing values generated)
(40,000 missing values generated)
(40,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(25,515 missing values generated)
(25,515 missing values generated)
(47,500 missing values generated)
(47,500 missing values generated)
(2,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(2,500 missing values generated)
(25,000 missing values generated)
(25,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(20,000 missing values generated)
(20,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)

. 
end of do-file

. exit, clear

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir/logs/cleaning_dataset_combine_2.log
  log type:  text
 opened on:   1 Aug 2023, 14:03:03

. 
. *Set Ado file path
. adopath + "$projectdir/analysis/ado"
  [1]  (BASE)      "C:\Program Files\Stata17\ado\base/"
  [2]  (SITE)      "C:\Program Files\Stata17\ado\site/"
  [3]              "."
  [4]  (PERSONAL)  "C:\users\PUBLIC\documents/"
  [5]  (PLUS)      "C:\users\PUBLIC\documents/"
  [6]  (OLDPLACE)  "c:\ado/"
  [7]              "C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir\analysis/analysis/ado"
  [8]              "C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir/analysis/ado"

. 
. *       Import control dataset
. import delimited "$projectdir/output/input_control.csv", clear
(encoding automatically selected: ISO-8859-1)
(221 vars, 50,000 obs)

. gen control_dataset=1

. *       Convert control strings to dates     * 
. foreach var of varlist   covid_test_positive_date                               ///
>                                                  covid_test_positive_date2                              ///
>                                                  covid_test_positive_date3                              ///
>                                                  covid_test_positive_treat                              ///
>                                                  prior_covid_date                                       ///
>                                                  sotrovimab                                                             ///
>                                                  molnupiravir                                                   /// 
>                                                  paxlovid                                                               ///
>                                                  remdesivir                                                             ///
>                                                  casirivimab                                                    ///
>                                                  sotrovimab_not_start                                   ///
>                                                  molnupiravir_not_start                                 ///
>                                                  paxlovid_not_start                                             ///
>                                                  date_treated                                                   ///
>                                                  start_date                                                             ///
>                                                  drugs_paxlovid_interaction                             ///
>                                                  drugs_nirmatrelvir_interaction                 ///
>                                                  last_vaccination_date                                  ///
>                                                  death_date                                                             ///
>                                                  dereg_date                                                     ///
>                                                  bmi_date_measured                                              ///
>                                                  creatinine_ctv3_date                                   ///
>                                                  creatinine_snomed_date                                 ///
>                                                  creatinine_short_snomed_date                   ///
>                                                  ae_diverticulitis_icd                                  ///
>                                                  ae_diverticulitis_snomed                               ///
>                                                  ae_diarrhoea_snomed                                    ///
>                                                  ae_taste_snomed                                                ///
>                                                  ae_taste_icd                                                   ///
>                                                  ae_rash_snomed                                                 ///
>                                                  ae_anaphylaxis_icd                                             ///
>                                                  ae_anaphylaxis_snomed                                  ///
>                                                  ae_anaphlaxis_ae                                               ///
>                                                  ae_drugreact_ae                                                ///
>                                                  ae_allergic_ae                                                 ///
>                                                  ae_rheumatoid_arthritis_snomed                 ///
>                                                  ae_rheumatoid_arthritis_icd                    ///
>                                                  ae_sle_ctv                                                             ///
>                                                  ae_sle_icd                                                             ///
>                                                  ae_psoriasis_snomed                                    ///
>                                                  ae_psoriatic_arthritis_snomed                  ///
>                                                  ae_ankylosing_spondylitis_ctv                  ///
>                                                  ae_ibd_snomed                                                  ///
>                                                  ae_diverticulitis_ae                                   ///
>                                                  ae_rheumatoid_arthritis_ae                             ///
>                                                  ae_sle_ae                                                              ///
>                                                  ae_psoriasis_ae                                                ///
>                                                  ae_psoriatic_arthritis_ae                              ///
>                                                  ae_ankylosing_spondylitis_ae                   ///
>                                                  ae_ibd_ae                                                              ///
>                                                  ae_diverticulitis_icd_prim                             ///     
>                                                  ae_taste_icd_prim                                              ///
>                                                  ae_anaphylaxis_icd_prim                                ///
>                                                  ae_rheumatoid_arthritis_icd_prim               ///
>                                                  ae_sle_icd_prim                                                ///
>                                                  pre_diverticulitis_icd_prim                    ///
>                                                  pre_taste_icd_prim                                             ///
>                                                  pre_anaphylaxis_icd_prim                               ///
>                                                  pre_sle_icd_prim                                               ///
>                                                  pre_rheumatoid_icd_prim                                ///
>                                                  rheumatoid_arthritis_nhsd_snomed               ///
>                                                  rheumatoid_arthritis_nhsd_icd10                ///
>                                                  sle_nhsd_ctv                                                   ///
>                                                  sle_nhsd_icd10                                                 ///
>                                                  psoriasis_nhsd                                                 ///
>                                                  psoriatic_arthritis_nhsd                               ///
>                                                  ankylosing_spondylitis_nhsd                    ///
>                                                  ibd_ctv                                                                ///
>                                                  allcause_emerg_aande                                   ///
>                                                  all_hosp_date                                                  ///
>                                                  all_hosp_date0                                                 ///
>                                                  all_hosp_date1                                                 ///
>                                                  all_hosp_date2                                                 ///
>                                                  hosp_discharge_date                                    ///
>                                                  hosp_discharge_date0                                   ///
>                                                  hosp_discharge_date1                                   ///
>                                                  hosp_discharge_date2                                   ///
>                                                  covid_hosp_date                                                ///
>                                                  covid_hosp_date0                                               ///
>                                                  covid_hosp_date1                                               ///
>                                                  covid_hosp_date2                                               ///                                             
>                                                  covid_discharge_date                                   ///
>                                                  covid_discharge_date0                                  ///                                             
>                                                  covid_discharge_date1                                  /// 
>                                                  covid_discharge_date2                                  /// 
>                                                  any_covid_hosp_discharge                               ///                     
>                                                  covid_hosp_date_mabs                                   /// 
>                                                  covid_hosp_date_mabs_not_primary               /// 
>                                                  died_date_ons                                                  ///
>                                                  died_ons_covid                                                 ///
>                                                  pre_diverticulitis_icd                                 ///
>                                                  pre_diverticulitis_snomed                              ///
>                                                  pre_diverticulitis_ae                                  ///
>                                                  pre_diarrhoea_snomed                                   ///
>                                                  pre_taste_snomed                                               ///
>                                                  pre_taste_icd                                                  ///
>                                                  pre_rash_snomed                                                ///
>                                                  pre_anaphylaxis_icd                                    ///
>                                                  pre_anaphylaxis_snomed                                 ///
>                                                  pre_anaphlaxis_ae                                              ///
>                                                  pre_drugreact_ae                                               ///
>                                                  pre_allergic_ae                                                ///
>                                                  pre_anaphlaxis_ae                                              ///
>                                                  pre_rheumatoid_arthritis_ae                    ///
>                                                  pre_rheumatoid_arthritis_snomed                ///
>                                                  pre_rheumatoid_arthritis_icd                   ///
>                                                  pre_ankylosing_spondylitis_ctv                 ///
>                                                  pre_ankylosing_spondylitis_ae                  ///
>                                                  pre_psoriasis_snomed                                   ///
>                                                  pre_psoriasis_ae                                               ///
>                                                  pre_psoriatic_arthritis_ae                             ///
>                                                  pre_psoriatic_arthritis_snomed                 ///
>                                                  pre_sle_ctv                                                    ///
>                                                  pre_sle_icd                                                    ///
>                                                  pre_sle_ae                                                             ///
>                                                  pre_ibd_ae                                                             ///
>                                                  pre_ibd_snomed {                                        
  2.         capture confirm string variable `var'
  3.         if _rc==0 {
  4.         rename `var' a
  5.         gen `var' = date(a, "YMD")
  6.         drop a
  7.         format %td `var'
  8.  }
  9. }
(4,999 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(30,000 missing values generated)
(4,999 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,558 missing values generated)
(47,500 missing values generated)
(47,500 missing values generated)
(2,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(2,500 missing values generated)
(25,000 missing values generated)
(25,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(20,000 missing values generated)
(20,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)

. tab control_dataset

control_dat |
       aset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     50,000      100.00      100.00
------------+-----------------------------------
      Total |     50,000      100.00

. save "$projectdir/output/data/control.dta", replace 
file C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir/output/data/control.dta saved

. //                                               //                             ///
. 
. * import treatment dataset
. import delimited "$projectdir/output/input_treatment.csv", clear
(encoding automatically selected: ISO-8859-1)
(221 vars, 50,000 obs)

. gen treatment_dataset=1

. *       Convert control strings to dates     * 
. foreach var of varlist   covid_test_positive_date                               ///
>                                                  covid_test_positive_date2                              ///
>                                                  covid_test_positive_date3                              ///
>                                                  covid_test_positive_treat                              ///
>                                                  prior_covid_date                                       ///
>                                                  sotrovimab                                                             ///
>                                                  molnupiravir                                                   /// 
>                                                  paxlovid                                                               ///
>                                                  remdesivir                                                             ///
>                                                  casirivimab                                                    ///
>                                                  sotrovimab_not_start                                   ///
>                                                  molnupiravir_not_start                                 ///
>                                                  paxlovid_not_start                                             ///
>                                                  date_treated                                                   ///
>                                                  start_date                                                             ///
>                                                  drugs_paxlovid_interaction                             ///
>                                                  drugs_nirmatrelvir_interaction                 ///
>                                                  last_vaccination_date                                  ///
>                                                  death_date                                                             ///
>                                                  dereg_date                                                     ///
>                                                  bmi_date_measured                                              ///
>                                                  creatinine_ctv3_date                                   ///
>                                                  creatinine_snomed_date                                 ///
>                                                  creatinine_short_snomed_date                   ///
>                                                  ae_diverticulitis_icd                                  ///
>                                                  ae_diverticulitis_snomed                               ///
>                                                  ae_diarrhoea_snomed                                    ///
>                                                  ae_taste_snomed                                                ///
>                                                  ae_taste_icd                                                   ///
>                                                  ae_rash_snomed                                                 ///
>                                                  ae_anaphylaxis_icd                                             ///
>                                                  ae_anaphylaxis_snomed                                  ///
>                                                  ae_anaphlaxis_ae                                               ///
>                                                  ae_drugreact_ae                                                ///
>                                                  ae_allergic_ae                                                 ///
>                                                  ae_rheumatoid_arthritis_snomed                 ///
>                                                  ae_rheumatoid_arthritis_icd                    ///
>                                                  ae_sle_ctv                                                             ///
>                                                  ae_sle_icd                                                             ///
>                                                  ae_psoriasis_snomed                                    ///
>                                                  ae_psoriatic_arthritis_snomed                  ///
>                                                  ae_ankylosing_spondylitis_ctv                  ///
>                                                  ae_ibd_snomed                                                  ///
>                                                  ae_diverticulitis_ae                                   ///
>                                                  ae_rheumatoid_arthritis_ae                             ///
>                                                  ae_sle_ae                                                              ///
>                                                  ae_psoriasis_ae                                                ///
>                                                  ae_psoriatic_arthritis_ae                              ///
>                                                  ae_ankylosing_spondylitis_ae                   ///
>                                                  ae_ibd_ae                                                              ///
>                                                  ae_diverticulitis_icd_prim                             ///     
>                                                  ae_taste_icd_prim                                              ///
>                                                  ae_anaphylaxis_icd_prim                                ///
>                                                  ae_rheumatoid_arthritis_icd_pri                ///
>                                                  ae_sle_icd_prim                                                ///
>                                                  pre_diverticulitis_icd_prim                    ///
>                                                  pre_taste_icd_prim                                             ///
>                                                  pre_anaphylaxis_icd_prim                               ///
>                                                  pre_rheumatoid_icd_prim                                ///
>                                                  pre_sle_icd_prim                                               ///
>                                                  rheumatoid_arthritis_nhsd_snomed               ///
>                                                  rheumatoid_arthritis_nhsd_icd10                ///
>                                                  sle_nhsd_ctv                                                   ///
>                                                  sle_nhsd_icd10                                                 ///
>                                                  psoriasis_nhsd                                                 ///
>                                                  psoriatic_arthritis_nhsd                               ///
>                                                  ankylosing_spondylitis_nhsd                    ///
>                                                  ibd_ctv                                                                ///
>                                                  allcause_emerg_aande                                   ///
>                                                  all_hosp_date                                                  ///
>                                                  all_hosp_date0                                                 ///
>                                                  all_hosp_date1                                                 ///
>                                                  all_hosp_date2                                                 ///
>                                                  hosp_discharge_date                                    ///
>                                                  hosp_discharge_date0                                   ///
>                                                  hosp_discharge_date1                                   ///
>                                                  hosp_discharge_date2                                   ///
>                                                  covid_hosp_date                                                ///
>                                                  covid_hosp_date0                                               ///
>                                                  covid_hosp_date1                                               ///
>                                                  covid_hosp_date2                                               ///                                             
>                                                  covid_discharge_date                                   ///
>                                                  covid_discharge_date0                                  ///                                             
>                                                  covid_discharge_date1                                  /// 
>                                                  covid_discharge_date2                                  /// 
>                                                  any_covid_hosp_discharge                               ///                     
>                                                  covid_hosp_date_mabs                                   /// 
>                                                  covid_hosp_date_mabs_not_primary               /// 
>                                                  died_date_ons                                                  ///
>                                                  died_ons_covid                                                 ///
>                                                  pre_diverticulitis_icd                                 ///
>                                                  pre_diverticulitis_snomed                              ///
>                                                  pre_diverticulitis_ae                                  ///
>                                                  pre_diarrhoea_snomed                                   ///
>                                                  pre_taste_snomed                                               ///
>                                                  pre_taste_icd                                                  ///
>                                                  pre_rash_snomed                                                ///
>                                                  pre_anaphylaxis_icd                                    ///
>                                                  pre_anaphylaxis_snomed                                 ///
>                                                  pre_anaphlaxis_ae                                              ///
>                                                  pre_drugreact_ae                                               ///
>                                                  pre_allergic_ae                                                ///
>                                                  pre_anaphlaxis_ae                                              ///
>                                                  pre_rheumatoid_arthritis_ae                    ///
>                                                  pre_rheumatoid_arthritis_snomed                ///
>                                                  pre_rheumatoid_arthritis_icd                   ///
>                                                  pre_ankylosing_spondylitis_ctv                 ///
>                                                  pre_ankylosing_spondylitis_ae                  ///
>                                                  pre_psoriasis_snomed                                   ///
>                                                  pre_psoriasis_ae                                               ///
>                                                  pre_psoriatic_arthritis_ae                             ///
>                                                  pre_psoriatic_arthritis_snomed                 ///
>                                                  pre_sle_ctv                                                    ///
>                                                  pre_sle_icd                                                    ///
>                                                  pre_sle_ae                                                             ///
>                                                  pre_ibd_ae                                                             ///
>                                                  pre_ibd_snomed {                                        
  2.         capture confirm string variable `var'
  3.         if _rc==0 {
  4.         rename `var' a
  5.         gen `var' = date(a, "YMD")
  6.         drop a
  7.         format %td `var'
  8.  }
  9. }
(4,999 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(30,000 missing values generated)
(4,999 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,544 missing values generated)
(48,518 missing values generated)
(47,500 missing values generated)
(47,500 missing values generated)
(2,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(2,500 missing values generated)
(25,000 missing values generated)
(25,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(30,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(45,000 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(49,500 missing values generated)
(47,500 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(20,000 missing values generated)
(20,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)
(45,000 missing values generated)

. tab treatment_dataset

treatment_d |
     ataset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     50,000      100.00      100.00
------------+-----------------------------------
      Total |     50,000      100.00

. *********************************
. *  Append control & treatment datasets     *
. ********************************* 
. append using "$projectdir/output/data/control.dta"

. duplicates tag patient_id, gen(duplicate_patient_id)

Duplicates in terms of patient_id

. bys patient_id (treatment_dataset duplicate_patient_id): gen n=_n

. tab n

          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     95,013       95.01       95.01
          2 |      4,987        4.99      100.00
------------+-----------------------------------
      Total |    100,000      100.00

. drop if n>1  // drops duplicate patient id and in control group
(4,987 observations deleted)

. tab control_dataset,m

control_dat |
       aset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     45,013       47.38       47.38
          . |     50,000       52.62      100.00
------------+-----------------------------------
      Total |     95,013      100.00

. tab treatment_dataset,m

treatment_d |
     ataset |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     50,000       52.62       52.62
          . |     45,013       47.38      100.00
------------+-----------------------------------
      Total |     95,013      100.00

. count if start_date==.
  48,518

. count if start_date!=date_treated & treatment_dataset==1
  984

. count if start_date!=covid_test_positive_date & control_dataset==1
  44,939

. gen dataset = 0 if control_dataset==1
(50,000 missing values generated)

. replace dataset= 1 if treatment_dataset==1
(50,000 real changes made)

. label define dataset 0 "control" 1 "drug" 

. label values dataset dataset

. 
. ****************************
. *       INCLUSION               *
. ****************************
. ** inclusion criteria*
. keep if age>=18 & age<110
(20,258 observations deleted)

. keep if sex=="F"|sex=="M"
(0 observations deleted)

. keep if has_died==0
(3,738 observations deleted)

. ** exclusion criteria*
. count if start_date>dereg_date & start_date!=.
  3,446

. count if start_date>death_date & start_date!=.
  3,476

. drop if start_date>death_date | start_date>dereg_date
(13,457 observations deleted)

. 
. ** high risk cohort from blueteq therapeutics datafor drug arms
. tab high_risk_cohort_therapeutics dataset,m //should be 0 in control group

high_risk_cohort_ther |        dataset
             apeutics |   control       drug |     Total
----------------------+----------------------+----------
       Downs syndrome |     2,705      3,018 |     5,723 
          HIV or AIDS |     1,333      1,543 |     2,876 
                 IMID |     2,795      2,933 |     5,728 
    IMID,solid cancer |     2,693      3,124 |     5,817 
                   NA |     1,416      1,454 |     2,870 
haematological dise.. |     1,326      1,475 |     2,801 
haematological mali.. |     1,403      1,560 |     2,963 
        liver disease |     1,353      1,520 |     2,873 
primary immune defi.. |     2,708      2,975 |     5,683 
sickle cell disease.. |     2,853      3,048 |     5,901 
         solid cancer |     2,742      3,033 |     5,775 
solid organ transpl.. |     2,668      2,937 |     5,605 
stem cell transplan.. |     1,376      1,569 |     2,945 
----------------------+----------------------+----------
                Total |    27,371     30,189 |    57,560 

. gen downs_syndrome_therap= 1 if strpos(high_risk_cohort_therapeutics, "Downs syndrome")
(51,837 missing values generated)

. gen solid_cancer_therap=1 if strpos(high_risk_cohort_therapeutics, "solid cancer")
(45,968 missing values generated)

. gen haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "haematological malignancies")
(54,597 missing values generated)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "haematologic malignancy")
(0 real changes made)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "sickle cell disease")
(5,901 real changes made)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "haematological diseases")
(2,801 real changes made)

. replace haem_disease_therap=1 if strpos(high_risk_cohort_therapeutics, "stem cell transplant")
(2,945 real changes made)

. gen renal_disease_therap= 1 if strpos(high_risk_cohort_therapeutics, "renal disease")
(51,955 missing values generated)

. gen liver_disease_therap= 1 if strpos(high_risk_cohort_therapeutics, "liver disease")
(54,687 missing values generated)

. gen imid_on_drug_therap= 1 if strpos(high_risk_cohort_therapeutics, "IMID")
(46,015 missing values generated)

. gen immunosupression_therap= 1 if strpos(high_risk_cohort_therapeutics, "primary immune deficiencies")
(51,877 missing values generated)

. gen hiv_aids_therap= 1 if strpos(high_risk_cohort_therapeutics, "HIV or AIDS")
(54,684 missing values generated)

. gen organ_transplant_therap= 1 if strpos(high_risk_cohort_therapeutics, "solid organ recipients")
(57,560 missing values generated)

. replace organ_transplant_therap= 1 if strpos(high_risk_cohort_therapeutics, "solid organ transplant")
(5,605 real changes made)

. gen rare_neuro_therap= 1 if strpos(high_risk_cohort_therapeutics, "rare neurological conditions")
(51,659 missing values generated)

. count if high_risk_cohort_therapeutics!=""&high_risk_cohort_therapeutics!="other"& min(downs_syndrome_therap,solid_cancer_therap,haem_disease_therap,renal_disease_therap,liver_disease_therap,imid_on_drug_therap,immunosupression_therap,hiv_aids_therap
> ,organ_transplant_therap,rare_neuro_therap)==. //check if all diseases have been captured
  2,870

. tab high_risk_cohort_therapeutics if high_risk_cohort_therapeutics!=""&high_risk_cohort_therapeutics!="other"& min(downs_syndrome_therap,solid_cancer_therap,haem_disease_therap,renal_disease_therap,liver_disease_therap,imid_on_drug_therap,immunosupre
> ssion_therap,hiv_aids_therap,organ_transplant_therap,rare_neuro_therap)==.

          high_risk_cohort_therapeutics |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                                     NA |      2,870      100.00      100.00
----------------------------------------+-----------------------------------
                                  Total |      2,870      100.00

. gen high_risk_cohort_ther= 1 if high_risk_cohort_therapeutics!=""&high_risk_cohort_therapeutics!="other"

. foreach var of varlist high_risk_cohort_ther downs_syndrome_therap solid_cancer_therap haem_disease_therap renal_disease_therap liver_disease_therap imid_on_drug_therap immunosupression_therap hiv_aids_therap organ_transplant_therap rare_neuro_therap
> {
  2.         replace `var'=0 if `var'==. 
  3. }
(0 real changes made)
(51,837 real changes made)
(45,968 real changes made)
(42,950 real changes made)
(51,955 real changes made)
(54,687 real changes made)
(46,015 real changes made)
(51,877 real changes made)
(54,684 real changes made)
(51,955 real changes made)
(51,659 real changes made)

. tab high_risk_cohort_ther

high_risk_c |
 ohort_ther |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |     57,560      100.00      100.00
------------+-----------------------------------
      Total |     57,560      100.00

. tab high_risk_cohort_ther dataset

high_risk_ |
cohort_the |        dataset
         r |   control       drug |     Total
-----------+----------------------+----------
         1 |    27,371     30,189 |    57,560 
-----------+----------------------+----------
     Total |    27,371     30,189 |    57,560 

. 
. ** high risk cohort from open codelist from control group
. tab high_risk_cohort_nhsd,m 

high_risk_c |
 ohort_nhsd |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,244        2.16        2.16
          1 |     56,316       97.84      100.00
------------+-----------------------------------
      Total |     57,560      100.00

. count if downs_syndrome==1
  10,955

. count if solid_cancer==1
  5,722

. count if haem_disease==1
  27,098

. count if renal_disease==1
  19,903

. count if liver_disease==1
  10,927

. count if imid_on_drug==1
  28,912

. count if hiv_aids==1
  10,966

. count if organ_transplant==1
  18,160

. count if rare_neuro==1
  32,760

. count if imid_on_drug==1 & imid_nhsd==1 & imid_drug==0 //should be 0
  15,646

. count if imid_on_drug==1 & imid_nhsd==0 & imid_drug==1 //should be 0
  609

. count if imid_on_drug==1 & imid_nhsd==1 & imid_drug==1 & downs_syndrome==0 &solid_cancer==0 &haem_disease==0 &renal_disease==0 &liver_disease==0 &immunosupression==0 &hiv_aids==0 &organ_transplant==0 &rare_neuro==0
  39

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1
  570

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 &immunosuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate==0 
  552

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 &immunosuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate==0 &imid_on_drug==1
  266

. count if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 &immunosuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate==0 &imid_on_drug==1 &downs_syndrome==0 &solid_cancer==0 &haem_disease==0 &renal_disease==0 &liver_disease==0 &
> immunosupression==0 &hiv_aids==0 &organ_transplant==0 &rare_neuro==0
  12

. replace imid_drug=0 if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 &immunosuppresant==0 &methotrexate==0 &ciclosporin==0 &mycophenolate==0 &imid_on_drug==1 //ignore if steriods<4 scripts in 6m & not coded other imid drug 
(266 real changes made)

. replace oral_steroid_drugs_nhsd=0 if oral_steroid_drug_nhsd_6m_count<4 &oral_steroid_drugs_nhsd==1 //ignore if steriods<4 scripts in 6m
(570 real changes made)

. count if imid_on_drug==1 & imid_nhsd==1 & imid_drug==0 
  15,804

. replace imid_on_drug=0 if imid_nhsd==1 & imid_drug==0 //ignore if steriods<4 & not coded other imid drug 
(15,804 real changes made)

. replace imid_on_drug=0 if imid_nhsd==0 & imid_drug==1 
(501 real changes made)

. gen high_risk_cohort_codelist=((downs_syndrome + solid_cancer + haem_disease + renal_disease + liver_disease + imid_on_drug + immunosupression + hiv_aids + organ_transplant + rare_neuro )>0)

. tab high_risk_cohort_codelist dataset,m 

high_risk_ |
cohort_cod |        dataset
     elist |   control       drug |     Total
-----------+----------------------+----------
         0 |       893      1,037 |     1,930 
         1 |    26,478     29,152 |    55,630 
-----------+----------------------+----------
     Total |    27,371     30,189 |    57,560 

. drop if high_risk_cohort_codelist==. & dataset==0 //should be same number dropped as change above 
(0 observations deleted)

. tab high_risk_cohort_codelist dataset

high_risk_ |
cohort_cod |        dataset
     elist |   control       drug |     Total
-----------+----------------------+----------
         0 |       893      1,037 |     1,930 
         1 |    26,478     29,152 |    55,630 
-----------+----------------------+----------
     Total |    27,371     30,189 |    57,560 

. bys dataset:count if high_risk_cohort_codelist==. & high_risk_cohort_ther==.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> dataset = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> dataset = drug
  0

. 
. ** combine two high risk cohorts into one 
. foreach var of varlist downs_syndrome solid_cancer haem_disease renal_disease liver_disease imid_on_drug immunosupression hiv_aids organ_transplant rare_neuro {
  2.         gen `var'_comb = `var'
  3.         replace `var'_comb = 1 if `var'_therap==1 
  4.         tab `var' `var'_therap 
  5.         tab dataset `var'_comb 
  6. }
(4,626 real changes made)

downs_synd | downs_syndrome_therap
      rome |         0          1 |     Total
-----------+----------------------+----------
         0 |    41,979      4,626 |    46,605 
         1 |     9,858      1,097 |    10,955 
-----------+----------------------+----------
     Total |    51,837      5,723 |    57,560 

           |  downs_syndrome_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    20,002      7,369 |    27,371 
      drug |    21,977      8,212 |    30,189 
-----------+----------------------+----------
     Total |    41,979     15,581 |    57,560 
(10,436 real changes made)

solid_canc |  solid_cancer_therap
        er |         0          1 |     Total
-----------+----------------------+----------
         0 |    41,402     10,436 |    51,838 
         1 |     4,566      1,156 |     5,722 
-----------+----------------------+----------
     Total |    45,968     11,592 |    57,560 

           |   solid_cancer_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    19,762      7,609 |    27,371 
      drug |    21,640      8,549 |    30,189 
-----------+----------------------+----------
     Total |    41,402     16,158 |    57,560 
(7,745 real changes made)

haem_disea |  haem_disease_therap
        se |         0          1 |     Total
-----------+----------------------+----------
         0 |    22,717      7,745 |    30,462 
         1 |    20,233      6,865 |    27,098 
-----------+----------------------+----------
     Total |    42,950     14,610 |    57,560 

           |   haem_disease_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    10,848     16,523 |    27,371 
      drug |    11,869     18,320 |    30,189 
-----------+----------------------+----------
     Total |    22,717     34,843 |    57,560 
(3,655 real changes made)

renal_dise | renal_disease_therap
       ase |         0          1 |     Total
-----------+----------------------+----------
         0 |    34,002      3,655 |    37,657 
         1 |    17,953      1,950 |    19,903 
-----------+----------------------+----------
     Total |    51,955      5,605 |    57,560 

           |  renal_disease_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    16,076     11,295 |    27,371 
      drug |    17,926     12,263 |    30,189 
-----------+----------------------+----------
     Total |    34,002     23,558 |    57,560 
(2,347 real changes made)

liver_dise | liver_disease_therap
       ase |         0          1 |     Total
-----------+----------------------+----------
         0 |    44,286      2,347 |    46,633 
         1 |    10,401        526 |    10,927 
-----------+----------------------+----------
     Total |    54,687      2,873 |    57,560 

           |  liver_disease_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    21,075      6,296 |    27,371 
      drug |    23,211      6,978 |    30,189 
-----------+----------------------+----------
     Total |    44,286     13,274 |    57,560 
(9,053 real changes made)

imid_on_dr |  imid_on_drug_therap
        ug |         0          1 |     Total
-----------+----------------------+----------
         0 |    35,900      9,053 |    44,953 
         1 |    10,115      2,492 |    12,607 
-----------+----------------------+----------
     Total |    46,015     11,545 |    57,560 

           |   imid_on_drug_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    17,077     10,294 |    27,371 
      drug |    18,823     11,366 |    30,189 
-----------+----------------------+----------
     Total |    35,900     21,660 |    57,560 
(5,118 real changes made)

           | immunosupression_ther
immunosupr |          ap
    ession |         0          1 |     Total
-----------+----------------------+----------
         0 |    46,719      5,118 |    51,837 
         1 |     5,158        565 |     5,723 
-----------+----------------------+----------
     Total |    51,877      5,683 |    57,560 

           | immunosupression_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    22,193      5,178 |    27,371 
      drug |    24,526      5,663 |    30,189 
-----------+----------------------+----------
     Total |    46,719     10,841 |    57,560 
(2,309 real changes made)

           |    hiv_aids_therap
  hiv_aids |         0          1 |     Total
-----------+----------------------+----------
         0 |    44,285      2,309 |    46,594 
         1 |    10,399        567 |    10,966 
-----------+----------------------+----------
     Total |    54,684      2,876 |    57,560 

           |     hiv_aids_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    21,086      6,285 |    27,371 
      drug |    23,199      6,990 |    30,189 
-----------+----------------------+----------
     Total |    44,285     13,275 |    57,560 
(3,849 real changes made)

           | organ_transplant_ther
organ_tran |          ap
    splant |         0          1 |     Total
-----------+----------------------+----------
         0 |    35,551      3,849 |    39,400 
         1 |    16,404      1,756 |    18,160 
-----------+----------------------+----------
     Total |    51,955      5,605 |    57,560 

           | organ_transplant_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    16,985     10,386 |    27,371 
      drug |    18,566     11,623 |    30,189 
-----------+----------------------+----------
     Total |    35,551     22,009 |    57,560 
(2,552 real changes made)

           |   rare_neuro_therap
rare_neuro |         0          1 |     Total
-----------+----------------------+----------
         0 |    22,248      2,552 |    24,800 
         1 |    29,411      3,349 |    32,760 
-----------+----------------------+----------
     Total |    51,659      5,901 |    57,560 

           |    rare_neuro_comb
   dataset |         0          1 |     Total
-----------+----------------------+----------
   control |    10,633     16,738 |    27,371 
      drug |    11,615     18,574 |    30,189 
-----------+----------------------+----------
     Total |    22,248     35,312 |    57,560 

. 
. ****************************
. *       EXPOSURE                *
. ****************************
. ** removing individuals who did not start therapy
. foreach var of varlist sotrovimab molnupiravir paxlovid {
  2.     display "`var'"
  3.         count if `var'!=.
  4.         count if `var'==date_treated & `var'!=. & date_treated!=.
  5.         count if `var'==date_treated & `var'!=. & date_treated!=. & `var'_not_start!=.
  6.         gen `var'_start = 1 if `var'==date_treated & `var'!=. & date_treated!=. & `var'_not_start==.
  7.         replace `var'_start = 0 if `var'==date_treated & `var'!=. & date_treated!=. & `var'_not_start!=.
  8.         tab `var'_start, m  //number on treatment, first drug given, and drug was started
  9. }
sotrovimab
  552
  543
  7
(57,024 missing values generated)
(7 real changes made)

sotrovimab_ |
      start |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |          7        0.01        0.01
          1 |        536        0.93        0.94
          . |     57,017       99.06      100.00
------------+-----------------------------------
      Total |     57,560      100.00
molnupiravir
  564
  555
  5
(57,010 missing values generated)
(5 real changes made)

molnupiravi |
    r_start |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |          5        0.01        0.01
          1 |        550        0.96        0.96
          . |     57,005       99.04      100.00
------------+-----------------------------------
      Total |     57,560      100.00
paxlovid
  561
  549
  5
(57,016 missing values generated)
(5 real changes made)

paxlovid_st |
        art |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |          5        0.01        0.01
          1 |        544        0.95        0.95
          . |     57,011       99.05      100.00
------------+-----------------------------------
      Total |     57,560      100.00

. gen drug=7 if remdesivir==date_treated&remdesivir!=.&date_treated!=.
(56,997 missing values generated)

. replace drug=8 if casirivimab==date_treated&casirivimab!=.&date_treated!=.
(550 real changes made)

. tab drug,m 

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          7 |        563        0.98        0.98
          8 |        550        0.96        1.93
          . |     56,447       98.07      100.00
------------+-----------------------------------
      Total |     57,560      100.00

. replace drug=1 if sotrovimab_start==1 
(536 real changes made)

. replace drug=2 if paxlovid_start==1
(544 real changes made)

. replace drug=3 if molnupiravir_start==1
(550 real changes made)

. tab drug,m 

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        536        0.93        0.93
          2 |        544        0.95        1.88
          3 |        550        0.96        2.83
          7 |        563        0.98        3.81
          8 |        550        0.96        4.77
          . |     54,817       95.23      100.00
------------+-----------------------------------
      Total |     57,560      100.00

. replace drug=4 if sotrovimab==date_treated & sotrovimab_start==0 
(7 real changes made)

. replace drug=5 if paxlovid==date_treated & paxlovid_start==0 
(5 real changes made)

. replace drug=6 if molnupiravir==date_treated & molnupiravir_start==0 
(5 real changes made)

. tab drug,m 

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        536        0.93        0.93
          2 |        544        0.95        1.88
          3 |        550        0.96        2.83
          4 |          7        0.01        2.84
          5 |          5        0.01        2.85
          6 |          5        0.01        2.86
          7 |        563        0.98        3.84
          8 |        550        0.96        4.79
          . |     54,800       95.21      100.00
------------+-----------------------------------
      Total |     57,560      100.00

. bys dataset: tab drug,m

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> dataset = control

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        261        0.95        0.95
          2 |        262        0.96        1.91
          3 |        260        0.95        2.86
          4 |          3        0.01        2.87
          5 |          1        0.00        2.88
          7 |        281        1.03        3.90
          8 |        261        0.95        4.86
          . |     26,042       95.14      100.00
------------+-----------------------------------
      Total |     27,371      100.00

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> dataset = drug

       drug |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |        275        0.91        0.91
          2 |        282        0.93        1.85
          3 |        290        0.96        2.81
          4 |          4        0.01        2.82
          5 |          4        0.01        2.83
          6 |          5        0.02        2.85
          7 |        282        0.93        3.78
          8 |        289        0.96        4.74
          . |     28,758       95.26      100.00
------------+-----------------------------------
      Total |     30,189      100.00


. replace drug=0 if drug==.
(54,800 real changes made)

. label define drug 0 "control" 1 "sotrovimab" 2 "paxlovid" 3"molnupiravir", replace

. label values drug drug

. tab drug, m

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |     54,800       95.21       95.21
  sotrovimab |        536        0.93       96.14
    paxlovid |        544        0.95       97.08
molnupiravir |        550        0.96       98.04
           4 |          7        0.01       98.05
           5 |          5        0.01       98.06
           6 |          5        0.01       98.07
           7 |        563        0.98       99.04
           8 |        550        0.96      100.00
-------------+-----------------------------------
       Total |     57,560      100.00

. drop if drug>3
(1,130 observations deleted)

. 
. ** start date is date treatment for treatment arms and date of covid test for control arm 
. count if start_date==. //should be 0
  28,758

. count if start_date!=covid_test_positive_date & drug==0  //should be 0
  51,893

. count if start_date!=date_treated & drug>0 //should be 0
  782

. 
. ** check number of positive covid tests prior to drug in treatment arms
. bys drug:count if covid_test_positive_date==. // should be 0 in control arm

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,431
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  58
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  65
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  55

. bys drug:count if covid_test_positive_date!=. 

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  49,369
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  478
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  479
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  495

. bys drug:count if covid_test_positive_date!=.&date_treated!=.& date_treated>covid_test_positive_date //test prior to treatment

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  228
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  262
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  234

. bys drug:count if covid_test_positive_date!=.&date_treated!=.& (date_treated-covid_test_positive_date>0)&(date_treated-covid_test_positive_date<=5) //test <5d

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  3
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  3

. bys drug:count if covid_test_positive_date2!=.&date_treated!=.& date_treated>covid_test_positive_date2 //2nd covid episode prior to treatment 

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  23
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  27
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  25

. bys drug:count if covid_test_positive_date2!=.&date_treated!=.& (date_treated-covid_test_positive_date2>0)&(date_treated-covid_test_positive_date2<=5) //test <5d

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug:count if covid_test_positive_date3!=.&date_treated!=.& date_treated>covid_test_positive_date3 //3rd covid episode prior to treatment 

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  23
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  27
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  35

. bys drug:count if covid_test_positive_date3!=.&date_treated!=.& (date_treated-covid_test_positive_date3>0)&(date_treated-covid_test_positive_date3<=5) //test <5d

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  1

. ** check in control group that covid positive, and not repeat covid test after an infection within 30 days prior
. tab covid_test_positive covid_positive_previous_30_days if drug==0

           | covid_positive_previo
covid_test |      us_30_days
 _positive |         0          1 |     Total
-----------+----------------------+----------
         0 |     5,183        261 |     5,444 
         1 |    46,810      2,546 |    49,356 
-----------+----------------------+----------
     Total |    51,993      2,807 |    54,800 

. drop if drug==0 & covid_test_positive==1 & covid_positive_previous_30_days==1
(2,546 observations deleted)

. ** gen study start and study end date
. gen campaign_start=mdy(12,16,2021)

. gen study_end_date=mdy(09,01,2023)

. gen start_date_29=start_date + 29
(27,415 missing values generated)

. format campaign_start study_end_date start_date_29 %td

. 
. 
. 
. ****************************
. *       OUTCOME         *
. ****************************
. *** AESI, IMAE and some Drug reaction (need to add further IMAE and DRESS, SJS, TEN) 
. gen new_ae_ra_icd = ae_rheumatoid_arthritis_icd if rheumatoid_arthritis_nhsd_snomed==0 & rheumatoid_arthritis_nhsd_icd10==0  
(36,303 missing values generated)

. gen new_ae_ra_icd_prim = ae_rheumatoid_arthritis_icd_prim if rheumatoid_arthritis_nhsd_snomed==0 & rheumatoid_arthritis_nhsd_icd10==0  
(36,426 missing values generated)

. gen new_ae_ra_snomed = ae_rheumatoid_arthritis_snomed if rheumatoid_arthritis_nhsd_snomed==0 & rheumatoid_arthritis_nhsd_icd10==0
(36,491 missing values generated)

. gen new_ae_ra_ae = ae_rheumatoid_arthritis_ae if rheumatoid_arthritis_nhsd_snomed==0 & rheumatoid_arthritis_nhsd_icd10==0  
(36,519 missing values generated)

. count if rheumatoid_arthritis_nhsd_snomed!=0 | rheumatoid_arthritis_nhsd_icd10!=0
  10,338

. count if ae_rheumatoid_arthritis_icd!=. 
  21,608

. count if new_ae_ra_icd!=.
  17,581

. count if ae_rheumatoid_arthritis_icd_prim!=. 
  21,604

. count if new_ae_ra_icd_prim!=.
  17,458

. count if ae_rheumatoid_arthritis_snomed!=. 
  21,520

. count if new_ae_ra_snomed!=.
  17,393

. count if ae_rheumatoid_arthritis_ae!=. 
  21,501

. count if new_ae_ra_ae!=.
  17,365

. gen new_ae_sle_icd = ae_sle_icd if sle_nhsd_ctv==0 & sle_nhsd_icd10==0
(36,444 missing values generated)

. gen new_ae_sle_icd_prim = ae_sle_icd_prim if sle_nhsd_ctv==0 & sle_nhsd_icd10==0
(36,410 missing values generated)

. gen new_ae_sle_ctv = ae_sle_ctv if sle_nhsd_ctv==0 & sle_nhsd_icd10==0
(36,477 missing values generated)

. gen new_ae_sle_ae = ae_sle_ae if sle_nhsd_ctv==0 & sle_nhsd_icd10==0
(36,400 missing values generated)

. count if sle_nhsd_ctv!=0 | sle_nhsd_icd10!=0
  10,221

. count if ae_sle_icd!=. 
  21,508

. count if new_ae_sle_icd!=.
  17,440

. count if ae_sle_icd_prim!=. 
  21,541

. count if new_ae_sle_icd_prim!=.
  17,474

. count if ae_sle_ctv!=. 
  21,501

. count if new_ae_sle_ctv!=.
  17,407

. count if ae_sle_ae!=. 
  21,564

. count if new_ae_sle_ae!=.
  17,484

. gen new_ae_psoriasis_snomed = ae_psoriasis_snomed if psoriasis_nhsd==0
(34,479 missing values generated)

. gen new_ae_psoriasis_ae = ae_psoriasis_ae if psoriasis_nhsd==0
(34,573 missing values generated)

. count if psoriasis_nhsd!=0 
  5,417

. count if ae_psoriasis_snomed!=. 
  21,567

. count if new_ae_psoriasis_snomed!=.
  19,405

. count if ae_psoriasis_ae!=. 
  21,499

. count if new_ae_psoriasis_ae!=.
  19,311

. gen new_ae_psa_snomed = ae_psoriatic_arthritis_snomed if psoriatic_arthritis_nhsd==0
(34,466 missing values generated)

. gen new_ae_psa_ae = ae_psoriatic_arthritis_ae if psoriatic_arthritis_nhsd==0
(34,466 missing values generated)

. count if psoriatic_arthritis_nhsd!=0 
  5,342

. count if ae_psoriatic_arthritis_snomed!=. 
  21,543

. count if new_ae_psa_snomed!=.
  19,418

. count if ae_psoriatic_arthritis_ae!=. 
  21,620

. count if new_ae_psa_ae!=.
  19,418

. gen new_ae_ankspon_ctv = ae_ankylosing_spondylitis_ctv if ankylosing_spondylitis_nhsd==0
(34,434 missing values generated)

. gen new_ae_ankspon_ae = ae_ankylosing_spondylitis_ae if ankylosing_spondylitis_nhsd==0
(34,487 missing values generated)

. count if ankylosing_spondylitis_nhsd!=0 
  5,376

. count if ae_ankylosing_spondylitis_ctv!=. 
  21,592

. count if new_ae_ankspon_ctv!=.
  19,450

. count if ae_ankylosing_spondylitis_ae!=. 
  21,517

. count if new_ae_ankspon_ae!=.
  19,397

. gen new_ae_ibd_snomed = ae_ibd_snomed if ibd_ctv==0
(34,494 missing values generated)

. gen new_ae_ibd_ae = ae_ibd_ae if ibd_ctv==0
(34,441 missing values generated)

. count if ibd_ctv!=0 
  5,333

. count if ae_ibd_snomed!=. 
  21,554

. count if new_ae_ibd_snomed!=.
  19,390

. count if ae_ibd_ae!=. 
  21,636

. count if new_ae_ibd_ae!=.
  19,443

. 
. *** comparison of ICD admission primary diagnosis and all diagnoses
. count if ae_diverticulitis_icd!=.
  21,699

. count if ae_diverticulitis_icd_prim!=.
  21,532

. count if ae_taste_icd!=.
  21,511

. count if ae_taste_icd_prim!=.
  21,444

. count if ae_anaphylaxis_icd!=.
  21,537

. count if ae_anaphylaxis_icd_prim!=.
  21,625

. 
. *** combined ae from GP, hosp and A&E
. egen ae_diverticulitis = rmin(ae_diverticulitis_snomed ae_diverticulitis_icd_prim ae_diverticulitis_ae)
(11,726 missing values generated)

. egen ae_diarrhoea = rmin(ae_diarrhoea_snomed)
(32,191 missing values generated)

. egen ae_taste = rmin(ae_taste_snomed ae_taste_icd_prim)
(19,430 missing values generated)

. egen ae_anaphylaxis = rmin(ae_anaphylaxis_snomed ae_anaphlaxis_ae ae_anaphylaxis_icd_prim)
(11,585 missing values generated)

. egen ae_rash = rmin(ae_rash_snomed)
(32,362 missing values generated)

. egen ae_drug = rmin(ae_drugreact_ae)
(32,269 missing values generated)

. egen ae_allergic = rmin(ae_allergic_ae)
(32,307 missing values generated)

. egen ae_ra = rmin(new_ae_ra_snomed new_ae_ra_icd_prim new_ae_ra_ae)
(19,788 missing values generated)

. egen ae_sle = rmin(new_ae_sle_ctv new_ae_sle_icd_prim new_ae_sle_ae)
(19,758 missing values generated)

. egen ae_psorasis = rmin(new_ae_psoriasis_snomed new_ae_psoriasis_ae)
(22,914 missing values generated)

. egen ae_psa = rmin(new_ae_psa_snomed new_ae_psa_ae)
(22,862 missing values generated)

. egen ae_ankspon = rmin(new_ae_ankspon_ctv new_ae_ankspon_ae)
(22,745 missing values generated)

. egen ae_ibd = rmin(new_ae_ibd_snomed new_ae_ibd_ae)
(22,858 missing values generated)

. 
. *** global all ae
. global ae_spc                   ae_diverticulitis_snomed                ///
>                                                 ae_diarrhoea_snomed                             ///
>                                                 ae_taste_snomed                                         

. global ae_spc_icd               ae_diverticulitis_icd_prim              ///
>                                                 ae_taste_icd_prim                                       

. global ae_spc_emerg             ae_diverticulitis_ae                                                                    

. global ae_drug                  ae_anaphylaxis_snomed                   ///     
>                                                 ae_rash_snomed  

. global ae_drug_emerg    ae_anaphlaxis_ae                                ///
>                                                 ae_drugreact_ae                                 ///
>                                                 ae_allergic_ae                                                                                      

. global ae_drug_icd              ae_anaphylaxis_icd_prim

. global ae_imae                  new_ae_ra_snomed                                ///
>                                                 new_ae_sle_ctv                                  ///
>                                                 new_ae_psoriasis_snomed                 ///
>                                                 new_ae_psa_snomed                               ///
>                                                 new_ae_ankspon_ctv                              ///
>                                                 new_ae_ibd_snomed       

. global ae_imae_icd              new_ae_ra_icd_prim                              ///
>                                                 new_ae_sle_icd_prim             

. global ae_imae_emerg    new_ae_ra_ae                                    ///
>                                                 new_ae_sle_ae                                   ///
>                                                 new_ae_psoriasis_ae                             ///
>                                                 new_ae_psa_ae                                   ///
>                                                 new_ae_ankspon_ae                               ///
>                                                 new_ae_ibd_ae   

. global ae_disease               ae_diverticulitis                               ///
>                                                 ae_diarrhoea                                    ///
>                                                 ae_taste                                                ///
>                                                 ae_anaphylaxis                                  ///
>                                                 ae_rash                                                 ///
>                                                 ae_drug                                                 ///
>                                                 ae_allergic                                     ///
>                                                 ae_ra                                                   ///
>                                                 ae_sle                                                  ///
>                                                 ae_psorasis                                     ///
>                                                 ae_psa                                                  ///
>                                                 ae_ankspon                                              ///
>                                                 ae_ibd                                  

.                                                                         
. *remove event if occurred before start
. foreach x in $ae_spc $ae_spc_icd $ae_spc_emerg $ae_drug $ae_drug_icd $ae_drug_emerg $ae_imae $ae_imae_icd $ae_imae_emerg $ae_disease{
  2.                                 display "`x'"
  3.                                 count if (`x' > start_date | `x' < start_date + 28) & `x'!=. 
  4.                                 count if (`x' < start_date | `x' > start_date + 28) & `x'!=. & drug==0
  5.                                 count if (`x' < start_date | `x' > start_date + 28) & `x'!=. & drug>0
  6. }
ae_diverticulitis_snomed
  21,366
  20,225
  614
ae_diarrhoea_snomed
  21,693
  20,576
  613
ae_taste_snomed
  21,636
  20,527
  641
ae_diverticulitis_icd_prim
  21,532
  20,408
  612
ae_taste_icd_prim
  21,444
  20,350
  602
ae_diverticulitis_ae
  21,390
  20,268
  622
ae_anaphylaxis_snomed
  21,523
  20,343
  624
ae_rash_snomed
  21,522
  20,384
  586
ae_anaphylaxis_icd_prim
  21,625
  20,500
  610
ae_anaphlaxis_ae
  21,682
  20,541
  610
ae_drugreact_ae
  21,615
  20,470
  620
ae_allergic_ae
  21,577
  20,483
  609
new_ae_ra_snomed
  17,393
  16,501
  500
new_ae_sle_ctv
  17,407
  16,505
  494
new_ae_psoriasis_snomed
  19,405
  18,356
  537
new_ae_psa_snomed
  19,418
  18,376
  573
new_ae_ankspon_ctv
  19,450
  18,407
  569
new_ae_ibd_snomed
  19,390
  18,339
  582
new_ae_ra_icd_prim
  17,458
  16,531
  513
new_ae_sle_icd_prim
  17,474
  16,509
  528
new_ae_ra_ae
  17,365
  16,473
  477
new_ae_sle_ae
  17,484
  16,590
  484
new_ae_psoriasis_ae
  19,311
  18,303
  562
new_ae_psa_ae
  19,418
  18,413
  538
new_ae_ankspon_ae
  19,397
  18,397
  551
new_ae_ibd_ae
  19,443
  18,450
  526
ae_diverticulitis
  42,158
  39,898
  1,228
ae_diarrhoea
  21,693
  20,576
  613
ae_taste
  34,454
  32,707
  987
ae_anaphylaxis
  42,299
  40,056
  1,213
ae_rash
  21,522
  20,384
  586
ae_drug
  21,615
  20,470
  620
ae_allergic
  21,577
  20,483
  609
ae_ra
  34,096
  32,342
  982
ae_sle
  34,126
  32,331
  994
ae_psorasis
  30,970
  29,339
  872
ae_psa
  31,022
  29,383
  886
ae_ankspon
  31,139
  29,479
  911
ae_ibd
  31,026
  29,415
  879

. egen ae_spc_gp = rmin($ae_spc)
(11,599 missing values generated)

. egen ae_spc_serious = rmin($ae_spc_icd)
(19,558 missing values generated)

. egen ae_spc_emerg = rmin($ae_spc_emerg)
(32,494 missing values generated)

. egen ae_spc_all = rmin($ae_spc $ae_spc_icd $ae_spc_emerg)
(2,509 missing values generated)

. egen ae_drug_gp = rmin($ae_drug)
(19,430 missing values generated)

. egen ae_drug_serious = rmin($ae_drug_icd)
(32,259 missing values generated)

. egen ae_drug_emerg = rmin($ae_drug_emerg)
(11,582 missing values generated)

. egen ae_drug_all = rmin($ae_drug $ae_drug_icd $ae_drug_emerg)
(2,562 missing values generated)

. egen ae_imae_gp = rmin($ae_imae)
(4,197 missing values generated)

. egen ae_imae_serious = rmin($ae_imae_icd)
(24,636 missing values generated)

. egen ae_imae_emerg = rmin($ae_imae_emerg)
(4,165 missing values generated)

. egen ae_imae_all = rmin($ae_imae $ae_imae_icd $ae_imae_emerg)   
(254 missing values generated)

. egen ae_all = rmin($ae_spc $ae_spc_icd $ae_spc_emerg $ae_drug $ae_drug_icd $ae_drug_emerg $ae_imae $ae_imae_icd $ae_imae_emerg)
(2 missing values generated)

. egen ae_all_serious = rmin($ae_spc_icd $ae_spc_emerg $ae_drug_icd $ae_drug_emerg $ae_imae_icd $ae_imae_emerg)
(49 missing values generated)

. 
. by drug, sort: count if ae_spc_all!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  49,811
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  515
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  528
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  521

. by drug, sort: count if ae_drug_all!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  49,776
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  512
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  514
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  520

. by drug, sort: count if ae_imae_all!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  52,005
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  535
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  542
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  548

. by drug, sort: count if ae_all!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  52,252
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  536
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  544
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  550

. 
. *** Secondary outcome - SAEs hospitalisation or death including COVID-19 
. * death
. bys drug: count if died_date_ons!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  31,445
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  323
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  331
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  345

. 
. * a&e all admission
. bys drug: count if allcause_emerg_aande!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  2,626
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  30
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  40

. 
. *covid admission
. // checking admission and discharge date; missing admission, missing dischagre, or dischagre preceed admission 
. count if covid_hosp_date!=.&covid_discharge_date==.
  5,315

. count if covid_hosp_date==.&covid_discharge_date!=.
  501

. count if covid_hosp_date!=.&covid_discharge_date!=.&covid_hosp_date==covid_discharge_date
  0

. count if covid_hosp_date!=.&covid_discharge_date!=.&covid_hosp_date<covid_discharge_date
  30

. count if covid_hosp_date!=.&covid_discharge_date!=.&covid_hosp_date>covid_discharge_date
  28

. // all covid hospitalisation
. bys drug: count if covid_hosp_date!=. 

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,226
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  47
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  53
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  47

. // covid admission on treatment date (control group will not have covid_hosp_date0)
. bys drug: count if covid_hosp_date0!=. 

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  499
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  3
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  5
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  2

. //  covid admission is the same as date treated 
. bys drug: count if covid_hosp_date0==date_treated&covid_hosp_date0!=.&date_treated!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==(date_treated+1) &covid_hosp_date1!=.&date_treated!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // covid admission is the same  as date treated and is a daycase
. bys drug: count if covid_hosp_date0==covid_discharge_date0&covid_hosp_date0!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_discharge_date1&covid_hosp_date1!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // covid admission is the same date as mab
. bys drug: count if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date_mabs!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date_mabs!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // covid admission is the same date as mab and is a daycase or 24 hour admission
. bys drug: count if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date0!=.&covid_hosp_date0==covid_discharge_date0

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date1!=.&covid_hosp_date1==covid_discharge_date1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date0!=.&(covid_discharge_date0 - covid_hosp_date0)==1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date1!=.&(covid_discharge_date1 - covid_hosp_date1)==1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // REPLACE - ignore covid admission if admission is the day 0 or day 1 after treatment date treated AND a day case
. replace covid_hosp_date=. if covid_hosp_date0==covid_discharge_date0&covid_hosp_date0!=.
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date1==covid_discharge_date1&covid_hosp_date1!=.  
(0 real changes made)

. // REPLACE - ignore covid admission if admission is the day 0 or day 1 after treatment date AND a mab procedures 
. replace covid_hosp_date=. if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date0!=.&covid_hosp_date0==covid_discharge_date0
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date1!=.&covid_hosp_date1==covid_discharge_date1
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date0==covid_hosp_date_mabs&covid_hosp_date0!=.&(covid_discharge_date0 - covid_hosp_date0)==1
(0 real changes made)

. replace covid_hosp_date=. if covid_hosp_date1==covid_hosp_date_mabs&covid_hosp_date1!=.&(covid_discharge_date1 - covid_hosp_date1)==1
(0 real changes made)

. 
. *hosp admission
. // checking admission and discharge date; missing admission, missing dischagre, or dischagre preceed admission 
. count if all_hosp_date!=.&hosp_discharge_date==.
  4,822

. count if all_hosp_date==.&hosp_discharge_date!=.
  4,840

. count if all_hosp_date!=.&hosp_discharge_date!=.&all_hosp_date==hosp_discharge_date
  0

. count if all_hosp_date!=.&hosp_discharge_date!=.&all_hosp_date<hosp_discharge_date
  272

. count if all_hosp_date!=.&hosp_discharge_date!=.&all_hosp_date>hosp_discharge_date
  277

. // all hospitalisation
. bys drug: count if all_hosp_date!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,205
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  47
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  57
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  62

. // admission on treatment date (control group will not have hosp_date0)
. bys drug: count if all_hosp_date0!=. 

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  547
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  2
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  6
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  6

. // admission is the same date as date treated 
. bys drug: count if all_hosp_date0==date_treated&all_hosp_date0!=.&date_treated!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==(date_treated+1) &all_hosp_date1!=.&date_treated!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // admission is the same date as date treated and is a daycase
. bys drug: count if all_hosp_date0==hosp_discharge_date0&all_hosp_date0!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==hosp_discharge_date1&all_hosp_date1!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // admission is for Covid and is the same date as date treated and is a daycase
. bys drug: count if all_hosp_date0==covid_hosp_date0  & all_hosp_date0==hosp_discharge_date0&all_hosp_date0!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==hosp_discharge_date1&all_hosp_date1!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. //  admission is the same date as mab
. bys drug: count if all_hosp_date0==covid_hosp_date_mabs&covid_hosp_date_mabs!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date_mabs&covid_hosp_date_mabs!=.

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. //  admission is the same date as mab and is a daycase, 1 day admission
. bys drug: count if all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&all_hosp_date0==hosp_discharge_date0

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&all_hosp_date1==hosp_discharge_date1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&(hosp_discharge_date0-all_hosp_date0)==1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&(hosp_discharge_date1-all_hosp_date1)==1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. //  admission is is for Covid and the same date as mab and is a daycase, 1 day admission
. bys drug: count if all_hosp_date0==covid_hosp_date0 & all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&all_hosp_date0==hosp_discharge_date0

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&all_hosp_date1==hosp_discharge_date1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date0==covid_hosp_date0 & all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&(hosp_discharge_date0-all_hosp_date0)==1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. bys drug: count if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&(hosp_discharge_date1-all_hosp_date1)==1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  0

. // REPLACE - ignore covid admission if admission is for covid AND day 0 or day 1 after treatment AND daycase
. replace all_hosp_date=. if all_hosp_date0==covid_hosp_date0 & all_hosp_date0==hosp_discharge_date0 & all_hosp_date0!=.
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==hosp_discharge_date1 & all_hosp_date1!=.
(0 real changes made)

. // REPLACE - ignore admission if admission is for covid AND day 0 or day 1 after treatment 
. replace all_hosp_date=. if all_hosp_date0==covid_hosp_date0 & all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&all_hosp_date0==hosp_discharge_date0
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&all_hosp_date1==hosp_discharge_date1
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date0==covid_hosp_date0 & all_hosp_date0==covid_hosp_date_mabs&all_hosp_date0!=.&(hosp_discharge_date0 - all_hosp_date0)==1
(0 real changes made)

. replace all_hosp_date=. if all_hosp_date1==covid_hosp_date1 & all_hosp_date1==covid_hosp_date_mabs&all_hosp_date1!=.&(hosp_discharge_date1 - all_hosp_date1)==1
(0 real changes made)

. 
. foreach var of varlist allcause_emerg_aande covid_hosp_date all_hosp_date died_date_ons{
  2.                                 display "`var'"
  3.                                 bys drug: count if (`var' >= start_date & `var' <= start_date + 28) & `var'!=.                          
  4.                                 bys drug: count if (`var' < start_date | `var' > start_date + 28) & `var'!=.                            
  5. }
allcause_emerg_aande

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  50
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  2

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  2,576
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  29
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  38
covid_hosp_date

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  126
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  2
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,100
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  46
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  51
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  46
all_hosp_date

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  112
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  4
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  3
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  6

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,093
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  43
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  54
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  56
died_date_ons

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  458
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  11

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  30,987
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  313
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  324
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  334

. 
. ****************************
. *       COVARIATES              *
. ****************************
. *Time between 1st positive covid test and treatment*
. gen pre_drug_test=3 if drug>0 & covid_test_positive_date!=. &(date_treated-covid_test_positive_date>0)&(date_treated-covid_test_positive_date<21)
(53,835 missing values generated)

. replace pre_drug_test=2 if drug>0 & covid_test_positive_date!=. &(date_treated-covid_test_positive_date>0)&(date_treated-covid_test_positive_date<=7)
(16 real changes made)

. replace pre_drug_test=1 if drug>0 & covid_test_positive_date!=. &(date_treated-covid_test_positive_date>0)&(date_treated-covid_test_positive_date<=5)
(13 real changes made)

. replace pre_drug_test=0 if drug>0 & covid_test_positive_date!=. &(date_treated-covid_test_positive_date>=0)&(date_treated-covid_test_positive_date<=3)
(13 real changes made)

. replace pre_drug_test=4 if drug>0 & (date_treated-covid_test_positive_date<0) & (date_treated-covid_test_positive_date>-7)
(14 real changes made)

. replace pre_drug_test=5 if drug>0 & (covid_test_positive_date==. | (date_treated-covid_test_positive_date<=-7) | (date_treated-covid_test_positive_date>=21)) 
(1,564 real changes made)

. label define pre_drug_test 0 "<3 days" 1 "3-5 days"  2 "5-7 days" 3 ">7 days & <21 days" 4 "treatment proceeds test <7 days" 5 "no test", replace 

. label values pre_drug_test pre_drug_test

. tab pre_drug_test drug,m

                      |                    drug
        pre_drug_test |   control  sotrovima   paxlovid  molnupira |     Total
----------------------+--------------------------------------------+----------
              <3 days |         0          3          7          3 |        13 
             3-5 days |         0          1          0          2 |         3 
             5-7 days |         0          1          1          1 |         3 
   >7 days & <21 days |         0          6         20          7 |        33 
treatment proceeds te |         0          3          5          6 |        14 
              no test |         0        522        511        531 |     1,564 
                    . |    52,254          0          0          0 |    52,254 
----------------------+--------------------------------------------+----------
                Total |    52,254        536        544        550 |    53,884 

. 
. * Demographics*
. * Age
. sum age

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         age |     53,884    48.95663    19.02259         18        109

. gen age_group=(age>=40)+(age>=60)

. label define age_group 0 "18-39" 1 "40-59" 2 ">=60" 

. label values age_group age_group

. egen age_5y_band=cut(age), at(18,25,30,35,40,45,50,55,60,65,70,75,80,85,110) label

. tab age_group,m

  age_group |      Freq.     Percent        Cum.
------------+-----------------------------------
      18-39 |     19,421       36.04       36.04
      40-59 |     18,111       33.61       69.65
       >=60 |     16,352       30.35      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. tab age_5y_band,m

age_5y_band |      Freq.     Percent        Cum.
------------+-----------------------------------
        18- |      5,819       10.80       10.80
        25- |      4,638        8.61       19.41
        30- |      4,563        8.47       27.87
        35- |      4,401        8.17       36.04
        40- |      4,150        7.70       43.74
        45- |      4,699        8.72       52.46
        50- |      4,800        8.91       61.37
        55- |      4,462        8.28       69.65
        60- |      3,689        6.85       76.50
        65- |      3,480        6.46       82.96
        70- |      3,316        6.15       89.11
        75- |      2,385        4.43       93.54
        80- |      1,814        3.37       96.90
        85- |      1,668        3.10      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. * Sex
. gen male = 1 if sex == "M"
(27,609 missing values generated)

. replace male = 0 if sex == "F"
(27,609 real changes made)

. rename sex sex_str

. gen sex=0 if sex_str=="M"
(27,609 missing values generated)

. replace sex=1 if sex_str=="F"
(27,609 real changes made)

. label define sex 0 "Male" 1 "Female"

. label values sex sex

. tab sex

        sex |      Freq.     Percent        Cum.
------------+-----------------------------------
       Male |     26,275       48.76       48.76
     Female |     27,609       51.24      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. * Ethnicity
. tab ethnicity,m

  ethnicity |      Freq.     Percent        Cum.
------------+-----------------------------------
            |     32,433       60.19       60.19
      Black |      2,080        3.86       64.05
      Mixed |      2,105        3.91       67.96
      Other |      2,212        4.11       72.06
South Asian |      2,087        3.87       75.94
      White |     12,967       24.06      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. rename ethnicity ethnicity_str

. encode  ethnicity_str, gen(ethnicity)

. label list ethnicity
ethnicity:
           1 Black
           2 Mixed
           3 Other
           4 South Asian
           5 White

. replace ethnicity=. if ethnicity==2 
(2,105 real changes made, 2,105 to missing)

. tab ethnicity                           

  ethnicity |      Freq.     Percent        Cum.
------------+-----------------------------------
      Black |      2,080       10.75       10.75
      Other |      2,212       11.43       22.19
South Asian |      2,087       10.79       32.97
      White |     12,967       67.03      100.00
------------+-----------------------------------
      Total |     19,346      100.00

. gen ethnicity_with_missing=ethnicity
(34,538 missing values generated)

. replace ethnicity_with_missing=9 if ethnicity_with_missing==.
(34,538 real changes made)

. tab ethnicity_with_missing

ethnicity_w |
ith_missing |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      2,080        3.86        3.86
          3 |      2,212        4.11        7.97
          4 |      2,087        3.87       11.84
          5 |     12,967       24.06       35.90
          9 |     34,538       64.10      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. gen White=1 if ethnicity==6
(53,884 missing values generated)

. replace White=0 if ethnicity!=6&ethnicity!=.
(19,346 real changes made)

. tab White

      White |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     19,346      100.00      100.00
------------+-----------------------------------
      Total |     19,346      100.00

. gen White_with_missing=White
(34,538 missing values generated)

. replace White_with_missing=9 if White==.
(34,538 real changes made)

. tab White_with_missing

White_with_ |
    missing |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     19,346       35.90       35.90
          9 |     34,538       64.10      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. * IMD
. tab imdq5,m

             imdQ5 |      Freq.     Percent        Cum.
-------------------+-----------------------------------
 1 (most deprived) |     10,895       20.22       20.22
                 2 |     10,838       20.11       40.33
                 3 |     10,566       19.61       59.94
                 4 |     10,740       19.93       79.87
5 (least deprived) |     10,285       19.09       98.96
           Unknown |        560        1.04      100.00
-------------------+-----------------------------------
             Total |     53,884      100.00

. replace imdq5="." if imdq5=="Unknown" 
(560 real changes made)

. replace imdq5="1" if imdq5=="1 (most deprived)" 
(10,895 real changes made)

. replace imdq5="5" if imdq5=="5 (least deprived)" 
(10,285 real changes made)

. destring imdq5, replace
imdq5: all characters numeric; replaced as byte
(560 missing values generated)

. recode imdq5 5 = 1 4 = 2 3 = 3 2 = 4 1 = 5 // Reverse the order (so 5 is more deprived)
(42758 changes made to imdq5)

. label define imdq5 1 "1 least deprived" 2 "2" 3 "3" 4 "4" 5 "5 most deprived", replace

. label values imdq5 imdq5

. gen imd_with_missing=imdq5
(560 missing values generated)

. replace imd_with_missing=9 if imdq5==.
(560 real changes made)

. tab imdq5,m

           imdQ5 |      Freq.     Percent        Cum.
-----------------+-----------------------------------
1 least deprived |     10,285       19.09       19.09
               2 |     10,740       19.93       39.02
               3 |     10,566       19.61       58.63
               4 |     10,838       20.11       78.74
 5 most deprived |     10,895       20.22       98.96
               . |        560        1.04      100.00
-----------------+-----------------------------------
           Total |     53,884      100.00

. * Region
. tab region_nhs,m

              region_nhs |      Freq.     Percent        Cum.
-------------------------+-----------------------------------
                    East |      5,307        9.85        9.85
           East Midlands |      5,335        9.90       19.75
                  London |     10,576       19.63       39.38
              North East |      5,586       10.37       49.74
              North West |      5,364        9.95       59.70
              South East |      5,466       10.14       69.84
              South West |      5,476       10.16       80.01
           West Midlands |      5,286        9.81       89.82
Yorkshire and The Humber |      5,488       10.18      100.00
-------------------------+-----------------------------------
                   Total |     53,884      100.00

. tab drug region_nhs

             |                                             region_nhs
        drug |      East  East Mi..     London  North E..  North W..  South E..  South W..  West Mi..  Yorkshi.. |     Total
-------------+---------------------------------------------------------------------------------------------------+----------
     control |     5,136      5,157     10,256      5,442      5,231      5,282      5,320      5,095      5,335 |    52,254 
  sotrovimab |        58         72         92         40         50         71         48         56         49 |       536 
    paxlovid |        60         48        117         57         43         61         39         62         57 |       544 
molnupiravir |        53         58        111         47         40         52         69         73         47 |       550 
-------------+---------------------------------------------------------------------------------------------------+----------
       Total |     5,307      5,335     10,576      5,586      5,364      5,466      5,476      5,286      5,488 |    53,884 

. rename region_nhs region_nhs_str 

. encode  region_nhs_str, gen(region_nhs)

. label list region_nhs
region_nhs:
           1 East
           2 East Midlands
           3 London
           4 North East
           5 North West
           6 South East
           7 South West
           8 West Midlands
           9 Yorkshire and The Humber

. tab region_covid_therapeutics,m

region_covid_therapeutic |
                       s |      Freq.     Percent        Cum.
-------------------------+-----------------------------------
                    East |      5,353        9.93        9.93
           East Midlands |      5,367        9.96       19.89
                  London |     10,669       19.80       39.69
              North East |      5,409       10.04       49.73
              North West |      5,413       10.05       59.78
              South East |      5,512       10.23       70.01
              South West |      5,373        9.97       79.98
           West Midlands |      5,445       10.11       90.08
Yorkshire and The Humber |      5,343        9.92      100.00
-------------------------+-----------------------------------
                   Total |     53,884      100.00

. rename region_covid_therapeutics region_covid_therapeutics_str

. encode region_covid_therapeutics_str, gen(region_covid_therapeutics)

. label list region_covid_therapeutics
region_covid_therapeutics:
           1 East
           2 East Midlands
           3 London
           4 North East
           5 North West
           6 South East
           7 South West
           8 West Midlands
           9 Yorkshire and The Humber

. tab stp,m

        stp |      Freq.     Percent        Cum.
------------+-----------------------------------
       STP1 |      5,393       10.01       10.01
      STP10 |      5,357        9.94       19.95
       STP2 |      5,448       10.11       30.06
       STP3 |      5,463       10.14       40.20
       STP4 |      5,355        9.94       50.14
       STP5 |      5,424       10.07       60.20
       STP6 |      5,325        9.88       70.09
       STP7 |      5,345        9.92       80.01
       STP8 |      5,426       10.07       90.07
       STP9 |      5,348        9.93      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. rename stp stp_str

. encode  stp_str,gen(stp)

. label list stp
stp:
           1 STP1
           2 STP10
           3 STP2
           4 STP3
           5 STP4
           6 STP5
           7 STP6
           8 STP7
           9 STP8
          10 STP9

. label values stp stp

. by stp, sort: gen stp_N=_N if stp!=. //combine stps with low N (<100) as "Other"

. replace stp=99 if stp_N<100
(0 real changes made)

. tab stp,m

        stp |      Freq.     Percent        Cum.
------------+-----------------------------------
       STP1 |      5,393       10.01       10.01
      STP10 |      5,357        9.94       19.95
       STP2 |      5,448       10.11       30.06
       STP3 |      5,463       10.14       40.20
       STP4 |      5,355        9.94       50.14
       STP5 |      5,424       10.07       60.20
       STP6 |      5,325        9.88       70.09
       STP7 |      5,345        9.92       80.01
       STP8 |      5,426       10.07       90.07
       STP9 |      5,348        9.93      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. * BMI
. tabstat bmi, stat(mean p25 p50 p75 min max) 

    Variable |      Mean       p25       p50       p75       Min       Max
-------------+------------------------------------------------------------
         bmi |  26.60424  21.59209  27.48655  33.09357 -5.517342  60.55387
--------------------------------------------------------------------------

. replace bmi=. if bmi<10|bmi>60
(3,302 real changes made, 3,302 to missing)

. gen bmi_10y=bmi if bmi_date_measured!=. & bmi_date_measured>=start_date-365*10 & (age+((bmi_date_measured-start_date)/365)>=18)
(53,884 missing values generated)

. gen bmi_5y=bmi if bmi_date_measured!=. & bmi_date_measured>=start_date-365*5 & (age+((bmi_date_measured-start_date)/365)>=18)
(53,884 missing values generated)

. gen bmi_2y=bmi if bmi_date_measured!=. & bmi_date_measured>=start_date-365*2 & (age+((bmi_date_measured-start_date)/365)>=18)
(53,884 missing values generated)

. gen bmi_group=(bmi>=18.5)+(bmi>=25.0)+(bmi>=30.0) if bmi!=.
(3,302 missing values generated)

. label define bmi_group 0 "underweight" 1 "normal" 2 "overweight" 3 "obese"

. label values bmi_group bmi_group

. gen bmi_group_with_missing=bmi_group
(3,302 missing values generated)

. replace bmi_group_with_missing=9 if bmi_group==.
(3,302 real changes made)

. gen bmi_25=(bmi>=25) if bmi!=.
(3,302 missing values generated)

. gen bmi_30=(bmi>=30) if bmi!=.
(3,302 missing values generated)

. * Comorbidities
. tab diabetes,m

   diabetes |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     48,515       90.04       90.04
          1 |      5,369        9.96      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. tab chronic_cardiac_disease,m

chronic_car |
diac_diseas |
          e |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     48,472       89.96       89.96
          1 |      5,412       10.04      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. tab hypertension,m

hypertensio |
          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     48,475       89.96       89.96
          1 |      5,409       10.04      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. tab chronic_respiratory_disease,m

chronic_res |
piratory_di |
      sease |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     48,464       89.94       89.94
          1 |      5,420       10.06      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. * Vaccination 
. tab vaccination_status,m

       vaccination_status |      Freq.     Percent        Cum.
--------------------------+-----------------------------------
Four or more vaccinations |      5,276        9.79        9.79
          One vaccination |      5,517       10.24       20.03
       Three vaccinations |     26,950       50.01       70.04
         Two vaccinations |      5,340        9.91       79.96
            Un-vaccinated |      5,441       10.10       90.05
 Un-vaccinated (declined) |      5,360        9.95      100.00
--------------------------+-----------------------------------
                    Total |     53,884      100.00

. rename vaccination_status vaccination_status_group

. gen vaccination_status=0 if vaccination_status_g=="Un-vaccinated"|vaccination_status_g=="Un-vaccinated (declined)"
(43,083 missing values generated)

. replace vaccination_status=1 if vaccination_status_g=="One vaccination"
(5,517 real changes made)

. replace vaccination_status=2 if vaccination_status_g=="Two vaccinations"
(5,340 real changes made)

. replace vaccination_status=3 if vaccination_status_g=="Three vaccinations"
(26,950 real changes made)

. replace vaccination_status=4 if vaccination_status_g=="Four or more vaccinations"
(5,276 real changes made)

. label define vaccination_status 0 "Un-vaccinated" 1 "One vaccination" 2 "Two vaccinations" 3 "Three vaccinations" 4 "Four or more vaccinations"

. label values vaccination_status vaccination_status

. gen vaccination_3_plus=1 if vaccination_status==3|vaccination_status==4
(21,658 missing values generated)

. replace vaccination_3_plus=0 if vaccination_status<3
(21,658 real changes made)

. * time between vaccine and covid positive test or treatment
. gen days_vacc_covid=covid_test_positive_date - last_vaccination_date if (covid_test_positive_date>last_vaccination_date & drug==0)
(20,740 missing values generated)

. sum days_vacc_covid,de

                       days_vacc_covid
-------------------------------------------------------------
      Percentiles      Smallest
 1%            9              1
 5%           44              1
10%           85              1       Obs              33,144
25%          212              1       Sum of wgt.      33,144

50%          424                      Mean           441.0899
                        Largest       Std. dev.      271.4949
75%        640.5           1126
90%          827           1126       Variance       73709.47
95%          919           1130       Skewness       .2827103
99%         1037           1135       Kurtosis       2.154947

. gen days_vacc_treat=date_treated - last_vaccination_date if (date_treated>last_vaccination_date & drug>0)
(52,752 missing values generated)

. sum days_vacc_treat,de

                       days_vacc_treat
-------------------------------------------------------------
      Percentiles      Smallest
 1%           10              2
 5%           40              2
10%           74              2       Obs               1,132
25%          194              3       Sum of wgt.       1,132

50%          422                      Mean           436.6484
                        Largest       Std. dev.      275.4883
75%        646.5           1099
90%          824           1103       Variance       75893.81
95%          910           1114       Skewness       .2766819
99%         1039           1123       Kurtosis         2.1206

. gen days_vacc_treat_test = days_vacc_covid if drug==0
(20,740 missing values generated)

. replace days_vacc_treat_test = days_vacc_treat if drug>0
(1,132 real changes made)

. sum days_vacc_treat_test,de

                    days_vacc_treat_test
-------------------------------------------------------------
      Percentiles      Smallest
 1%            9              1
 5%           44              1
10%           85              1       Obs              34,276
25%          211              1       Sum of wgt.      34,276

50%          424                      Mean           440.9433
                        Largest       Std. dev.      271.6248
75%          641           1126
90%          827           1126       Variance       73780.03
95%          918           1130       Skewness       .2824568
99%         1037           1135       Kurtosis       2.153809

. gen month_vacc_covid=ceil(days_vacc_treat_test/30)
(19,608 missing values generated)

. tab month_vacc_covid,m

month_vacc_ |
      covid |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      1,180        2.19        2.19
          2 |      1,225        2.27        4.46
          3 |      1,247        2.31        6.78
          4 |      1,243        2.31        9.08
          5 |      1,208        2.24       11.33
          6 |      1,212        2.25       13.58
          7 |      1,232        2.29       15.86
          8 |      1,187        2.20       18.06
          9 |      1,159        2.15       20.22
         10 |      1,222        2.27       22.48
         11 |      1,205        2.24       24.72
         12 |      1,187        2.20       26.92
         13 |      1,291        2.40       29.32
         14 |      1,178        2.19       31.50
         15 |      1,196        2.22       33.72
         16 |      1,196        2.22       35.94
         17 |      1,193        2.21       38.16
         18 |      1,245        2.31       40.47
         19 |      1,269        2.36       42.82
         20 |      1,161        2.15       44.98
         21 |      1,098        2.04       47.02
         22 |        989        1.84       48.85
         23 |        953        1.77       50.62
         24 |        889        1.65       52.27
         25 |        814        1.51       53.78
         26 |        806        1.50       55.28
         27 |        712        1.32       56.60
         28 |        668        1.24       57.84
         29 |        583        1.08       58.92
         30 |        538        1.00       59.92
         31 |        482        0.89       60.81
         32 |        430        0.80       61.61
         33 |        347        0.64       62.25
         34 |        257        0.48       62.73
         35 |        207        0.38       63.12
         36 |        142        0.26       63.38
         37 |         94        0.17       63.55
         38 |         31        0.06       63.61
          . |     19,608       36.39      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. *Calendar time*
. gen day_after_campaign=start_date-mdy(12,15,2021)
(27,415 missing values generated)

. sum day_after_campaign,de

                     day_after_campaign
-------------------------------------------------------------
      Percentiles      Smallest
 1%            2             -3
 5%           26             -3
10%           56             -3       Obs              26,469
25%          143             -3       Sum of wgt.      26,469

50%          290                      Mean           290.5301
                        Largest       Std. dev.       170.385
75%          438            586
90%          528            586       Variance       29031.04
95%          555            586       Skewness       .0076978
99%          580            586       Kurtosis       1.793214

. gen month_after_campaign=ceil((start_date-mdy(12,15,2021))/30)
(27,415 missing values generated)

. tab month_after_campaign,m

month_after |
  _campaign |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |        210        0.39        0.39
          1 |      1,328        2.46        2.85
          2 |      1,329        2.47        5.32
          3 |      1,370        2.54        7.86
          4 |      1,369        2.54       10.40
          5 |      1,369        2.54       12.94
          6 |      1,399        2.60       15.54
          7 |      1,326        2.46       18.00
          8 |      1,336        2.48       20.48
          9 |      1,320        2.45       22.93
         10 |      1,344        2.49       25.42
         11 |      1,376        2.55       27.98
         12 |      1,299        2.41       30.39
         13 |      1,352        2.51       32.90
         14 |      1,287        2.39       35.29
         15 |      1,369        2.54       37.83
         16 |      1,328        2.46       40.29
         17 |      1,322        2.45       42.75
         18 |      1,448        2.69       45.43
         19 |      1,315        2.44       47.87
         20 |        673        1.25       49.12
          . |     27,415       50.88      100.00
------------+-----------------------------------
      Total |     53,884      100.00

. tab start_date if month_after_campaign>100
no observations

. drop if month_after_campaign>100
(27,415 observations deleted)

. * Variant
. label define sgtf_new 0 "S gene detected" 1 "confirmed SGTF" 9 "NA"

. label values sgtf_new sgtf_new

. * Prior infection / check Bang code
. tab prior_covid, m

prior_covid |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     18,544       70.06       70.06
          1 |      7,925       29.94      100.00
------------+-----------------------------------
      Total |     26,469      100.00

. gen prior_covid_index=1 if prior_covid==1 & prior_covid_date<campaign_start
(26,418 missing values generated)

. tab prior_covid_index,m

prior_covid |
     _index |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |         51        0.19        0.19
          . |     26,418       99.81      100.00
------------+-----------------------------------
      Total |     26,469      100.00

. replace prior_covid_index=0 if prior_covid_index==.
(26,418 real changes made)

. *Contraindications for Pax*
. tab drug if organ_transplant==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      7,773       93.75       93.75
  sotrovimab |        189        2.28       96.03
    paxlovid |        162        1.95       97.99
molnupiravir |        167        2.01      100.00
-------------+-----------------------------------
       Total |      8,291      100.00

. tab drug if liver_disease_nhsd_icd10==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      2,525       93.66       93.66
  sotrovimab |         57        2.11       95.77
    paxlovid |         62        2.30       98.07
molnupiravir |         52        1.93      100.00
-------------+-----------------------------------
       Total |      2,696      100.00

. tab drug if renal_disease==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      8,680       93.79       93.79
  sotrovimab |        190        2.05       95.84
    paxlovid |        192        2.07       97.91
molnupiravir |        193        2.09      100.00
-------------+-----------------------------------
       Total |      9,255      100.00

. * Calculating egfr: adapted from https://github.com/opensafely/COVID-19-vaccine-breakthrough/blob/updates-feb/analysis/data_process.R*
. tabstat creatinine_ctv3, stat(mean p25 p50 p75 min max) 

    Variable |      Mean       p25       p50       p75       Min       Max
-------------+------------------------------------------------------------
creat~e_ctv3 |  57.03817  48.08377  59.10625  69.45191 -7.423844  122.2147
--------------------------------------------------------------------------

. replace creatinine_ctv3=. if !inrange(creatinine_ctv3, 20, 3000)|creatinine_ctv3_date>start_date
(13,154 real changes made, 13,154 to missing)

. tabstat creatinine_ctv3, stat(mean p25 p50 p75 min max) 

    Variable |      Mean       p25       p50       p75       Min       Max
-------------+------------------------------------------------------------
creat~e_ctv3 |  60.21459  50.13224  60.05109  69.93862  20.05574  114.8595
--------------------------------------------------------------------------

. replace creatinine_ctv3 = creatinine_ctv3/88.4
(13,315 real changes made)

. gen min_creatinine_ctv3=.
(26,469 missing values generated)

. replace min_creatinine_ctv3 = (creatinine_ctv3/0.7)^-0.329 if sex==1
(6,837 real changes made)

. replace min_creatinine_ctv3 = (creatinine_ctv3/0.9)^-0.411 if sex==0
(6,478 real changes made)

. replace min_creatinine_ctv3 = 1 if min_creatinine_ctv3<1
(3,716 real changes made)

. gen max_creatinine_ctv3=.
(26,469 missing values generated)

. replace max_creatinine_ctv3 = (creatinine_ctv3/0.7)^-1.209 if sex==1
(6,837 real changes made)

. replace max_creatinine_ctv3 = (creatinine_ctv3/0.9)^-1.209 if sex==0
(6,478 real changes made)

. replace max_creatinine_ctv3 = 1 if max_creatinine_ctv3>1
(22,753 real changes made)

. gen egfr_creatinine_ctv3 = min_creatinine_ctv3*max_creatinine_ctv3*141*(0.993^age_creatinine_ctv3) if age_creatinine_ctv3>0&age_creatinine_ctv3<=120
(13,329 missing values generated)

. replace egfr_creatinine_ctv3 = egfr_creatinine_ctv3*1.018 if sex==1
(6,741 real changes made)

. tabstat creatinine_snomed, stat(mean p25 p50 p75 min max) 

    Variable |      Mean       p25       p50       p75       Min       Max
-------------+------------------------------------------------------------
cre~e_snomed |  22.56747         0         0  44.99383 -36.83941  118.3562
--------------------------------------------------------------------------

. replace creatinine_snomed = . if !inrange(creatinine_snomed, 20, 3000)| creatinine_snomed_date>start_date
(20,159 real changes made, 20,159 to missing)

. replace creatinine_snomed_date = creatinine_short_snomed_date if missing(creatinine_snomed)
(13,559 real changes made, 3,501 to missing)

. replace creatinine_operator_snomed = creatinine_operator_short_snomed if missing(creatinine_snomed)
(11,171 real changes made)

. replace age_creatinine_snomed = age_creatinine_short_snomed if missing(creatinine_snomed)
(19,926 real changes made)

. replace creatinine_snomed = creatinine_short_snomed if missing(creatinine_snomed)
(20,159 real changes made)

. replace creatinine_snomed = . if !inrange(creatinine_snomed, 20, 3000)| creatinine_snomed_date>start_date
(15,758 real changes made, 15,758 to missing)

. replace creatinine_snomed = creatinine_snomed/88.4
(10,711 real changes made)

. gen min_creatinine_snomed=.
(26,469 missing values generated)

. replace min_creatinine_snomed = (creatinine_snomed/0.7)^-0.329 if sex==1
(5,534 real changes made)

. replace min_creatinine_snomed = (creatinine_snomed/0.9)^-0.411 if sex==0
(5,177 real changes made)

. replace min_creatinine_snomed = 1 if min_creatinine_snomed<1
(1,506 real changes made)

. gen max_creatinine_snomed=.
(26,469 missing values generated)

. replace max_creatinine_snomed = (creatinine_snomed/0.7)^-1.209 if sex==1
(5,534 real changes made)

. replace max_creatinine_snomed = (creatinine_snomed/0.9)^-1.209 if sex==0
(5,177 real changes made)

. replace max_creatinine_snomed = 1 if max_creatinine_snomed>1
(24,963 real changes made)

. gen egfr_creatinine_snomed = min_creatinine_snomed*max_creatinine_snomed*141*(0.993^age_creatinine_snomed) if age_creatinine_snomed>0&age_creatinine_snomed<=120
(15,873 missing values generated)

. replace egfr_creatinine_snomed = egfr_creatinine_snomed*1.018 if sex==1
(5,475 real changes made)

. gen egfr_60 = 1 if (egfr_creatinine_ctv3<60&creatinine_operator_ctv3!="<")|(egfr_creatinine_snomed<60&creatinine_operator_snomed!="<")|(egfr_record<60&egfr_record>0&egfr_operator!=">"&egfr_operator!=">=")|(egfr_short_record<60&egfr_short_record>0&egf
> r_short_operator!=">"&egfr_short_operator!=">=")
(23,038 missing values generated)

. gen egfr_30 = 1 if (egfr_creatinine_ctv3<30&creatinine_operator_ctv3!="<")|(egfr_creatinine_snomed<30&creatinine_operator_snomed!="<")|(egfr_record<30&egfr_record>0&egfr_operator!=">"&egfr_operator!=">=")|(egfr_short_record<30&egfr_short_record>0&egf
> r_short_operator!=">"&egfr_short_operator!=">=")
(25,692 missing values generated)

. tab drug if egfr_60==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |      3,203       93.35       93.35
  sotrovimab |         75        2.19       95.54
    paxlovid |         81        2.36       97.90
molnupiravir |         72        2.10      100.00
-------------+-----------------------------------
       Total |      3,431      100.00

. tab drug if egfr_30==1

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        726       93.44       93.44
  sotrovimab |         20        2.57       96.01
    paxlovid |         16        2.06       98.07
molnupiravir |         15        1.93      100.00
-------------+-----------------------------------
       Total |        777      100.00

. *drug interactions*
. tab drug if drugs_paxlovid_interaction<=start_date

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        652       94.22       94.22
  sotrovimab |         15        2.17       96.39
    paxlovid |         11        1.59       97.98
molnupiravir |         14        2.02      100.00
-------------+-----------------------------------
       Total |        692      100.00

. tab drug if drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction>=(start_date-3*365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        652       94.22       94.22
  sotrovimab |         15        2.17       96.39
    paxlovid |         11        1.59       97.98
molnupiravir |         14        2.02      100.00
-------------+-----------------------------------
       Total |        692      100.00

. tab drug if drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction>=(start_date-365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        532       93.33       93.33
  sotrovimab |         13        2.28       95.61
    paxlovid |         11        1.93       97.54
molnupiravir |         14        2.46      100.00
-------------+-----------------------------------
       Total |        570      100.00

. tab drug if drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction>=(start_date-180)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        321       94.13       94.13
  sotrovimab |          6        1.76       95.89
    paxlovid |          7        2.05       97.95
molnupiravir |          7        2.05      100.00
-------------+-----------------------------------
       Total |        341      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        655       93.44       93.44
  sotrovimab |         14        2.00       95.44
    paxlovid |         10        1.43       96.86
molnupiravir |         22        3.14      100.00
-------------+-----------------------------------
       Total |        701      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date&drugs_nirmatrelvir_interaction>=(start_date-3*365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        655       93.44       93.44
  sotrovimab |         14        2.00       95.44
    paxlovid |         10        1.43       96.86
molnupiravir |         22        3.14      100.00
-------------+-----------------------------------
       Total |        701      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date&drugs_nirmatrelvir_interaction>=(start_date-365.25)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        521       93.04       93.04
  sotrovimab |         13        2.32       95.36
    paxlovid |          7        1.25       96.61
molnupiravir |         19        3.39      100.00
-------------+-----------------------------------
       Total |        560      100.00

. tab drug if drugs_nirmatrelvir_interaction<=start_date&drugs_nirmatrelvir_interaction>=(start_date-180)

        drug |      Freq.     Percent        Cum.
-------------+-----------------------------------
     control |        319       94.10       94.10
  sotrovimab |          7        2.06       96.17
    paxlovid |          2        0.59       96.76
molnupiravir |         11        3.24      100.00
-------------+-----------------------------------
       Total |        339      100.00

. gen paxlovid_interaction=(drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction>=(start_date-180))  

. gen nirmatrelvir_interaction=(drugs_nirmatrelvir_interaction<=start_date&drugs_nirmatrelvir_interaction>=(start_date-180))

. * Drug contraindicated 
. gen paxlovid_contraindicated = 1 if egfr_30==1 | dialysis==1
(23,074 missing values generated)

. replace paxlovid_contraindicated = 1 if liver_disease==1 
(4,427 real changes made)

. replace paxlovid_contraindicated = 1 if organ_transplant==1 
(5,823 real changes made)

. replace paxlovid_contraindicated = 1 if drugs_paxlovid_interaction<=start_date&drugs_paxlovid_interaction>=(start_date-180)
(172 real changes made)

. recode paxlovid_contraindicated . = 0
(12652 changes made to paxlovid_contraindicated)

. by drug, sort: count if paxlovid_contraindicated==1

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  12,947
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  300
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  288
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  282

. 
. ****************************
. *       COX MODEL               *
. ****************************
. global ae               ae_spc_all                              ///
>                                 ae_drug_all                             ///             
>                                 ae_imae_all                     ///                             
>                                 ae_all                                  ///
>                                 allcause_emerg_aande    ///
>                                 covid_hosp_date                 ///
>                                 all_hosp_date                   ///
>                                 died_date_ons

. 
. * Generate failure 
. foreach x in    $ae $ae_disease ///
>                                 $ae_spc $ae_spc_icd $ae_spc_emerg ///
>                                 $ae_drug $ae_drug_icd $ae_drug_emerg ///
>                                 $ae_imae $ae_imae_icd $ae_imae_emerg ///
>                                 {
  2.         display "`x'"
  3.         by drug, sort: count if `x'!=.
  4.         by drug, sort: count if `x'>=start_date & `x'!=.
  5.         by drug, sort: count if `x'>=start_date & `x'<start_date_29 &`x'!=.
  6.         gen fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, paxlovid, molnupiravir)) if drug==1
  7.         replace fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, sotrovimab, molnupiravir)) if drug==2
  8.         replace fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, sotrovimab, paxlovid)) if drug==3
  9.         replace fail_`x'=(`x'!=.&`x'<= min(study_end_date, start_date_29, sotrovimab, paxlovid, molnupiravir)) if drug==0
 10.         tab drug fail_`x', m
 11. }
ae_spc_all

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  23,696
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  515
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  528
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  521

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  7,735
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  170
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  168
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  157

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1,108
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  35
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  31
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  18
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |    fail_ae_spc_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     7,738     17,101 |    24,839 
  sotrovimab |       155        381 |       536 
    paxlovid |       152        392 |       544 
molnupiravir |       168        382 |       550 
-------------+----------------------+----------
       Total |     8,213     18,256 |    26,469 
ae_drug_all

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  23,644
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  512
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  514
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  520

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  7,579
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  169
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  159
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  175

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1,132
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  28
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  25
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  30
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |   fail_ae_drug_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     7,600     17,239 |    24,839 
  sotrovimab |       164        372 |       536 
    paxlovid |       163        381 |       544 
molnupiravir |       174        376 |       550 
-------------+----------------------+----------
       Total |     8,101     18,368 |    26,469 
ae_imae_all

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  24,712
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  535
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  542
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  548

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,050
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  110
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  98
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  111

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1,118
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  24
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  22
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  32
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |   fail_ae_imae_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     4,025     20,814 |    24,839 
  sotrovimab |        86        450 |       536 
    paxlovid |        78        466 |       544 
molnupiravir |        80        470 |       550 
-------------+----------------------+----------
       Total |     4,269     22,200 |    26,469 
ae_all

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  24,837
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  536
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  544
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  550

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  2,752
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  47
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  59
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  61

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1,029
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  22
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  27
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  32
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |      fail_ae_all
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |     1,693     23,146 |    24,839 
  sotrovimab |        24        512 |       536 
    paxlovid |        32        512 |       544 
molnupiravir |        29        521 |       550 
-------------+----------------------+----------
       Total |     1,778     24,691 |    26,469 
allcause_emerg_aande

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1,234
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  30
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  40

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  685
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  19
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  8
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  24

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  50
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  0
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  2
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_allcause_emerg_a
             |         ande
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    24,238        601 |    24,839 
  sotrovimab |       524         12 |       536 
    paxlovid |       536          8 |       544 
molnupiravir |       532         18 |       550 
-------------+----------------------+----------
       Total |    25,830        639 |    26,469 
covid_hosp_date

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  2,491
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  47
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  53
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  47

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1,370
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  20
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  29
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  26

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  126
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  1
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  2
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  1
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_covid_hosp_date
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    23,588      1,251 |    24,839 
  sotrovimab |       508         28 |       536 
    paxlovid |       518         26 |       544 
molnupiravir |       528         22 |       550 
-------------+----------------------+----------
       Total |    25,142      1,327 |    26,469 
all_hosp_date

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  2,526
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  47
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  57
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  62

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  1,401
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  30
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  40
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  39

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  112
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  4
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  3
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  6
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_all_hosp_date
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    23,596      1,243 |    24,839 
  sotrovimab |       515         21 |       536 
    paxlovid |       524         20 |       544 
molnupiravir |       521         29 |       550 
-------------+----------------------+----------
       Total |    25,156      1,313 |    26,469 
died_date_ons

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  14,946
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  323
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  331
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  345

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,721
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  112
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  94
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  116

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  458
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_died_date_ons
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    14,138     10,701 |    24,839 
  sotrovimab |       315        221 |       536 
    paxlovid |       299        245 |       544 
molnupiravir |       310        240 |       550 
-------------+----------------------+----------
       Total |    15,062     11,407 |    26,469 
ae_diverticulitis

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  19,459
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  435
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  423
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  440

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,380
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  190
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  177
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  173

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  962
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  29
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  27
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  14
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_diverticuliti
             |           s
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    12,768     12,071 |    24,839 
  sotrovimab |       262        274 |       536 
    paxlovid |       271        273 |       544 
molnupiravir |       269        281 |       550 
-------------+----------------------+----------
       Total |    13,570     12,899 |    26,469 
ae_diarrhoea

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  10,011
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  204
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  227
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  217

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,078
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  103
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  109
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  102

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  469
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  15
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  8
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |   fail_ae_diarrhoea
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,423      5,416 |    24,839 
  sotrovimab |       420        116 |       536 
    paxlovid |       414        130 |       544 
molnupiravir |       428        122 |       550 
-------------+----------------------+----------
       Total |    20,685      5,784 |    26,469 
ae_taste

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  15,840
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  349
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  356
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  343

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  7,320
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  166
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  171
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  163

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  699
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  20
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  17
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  24
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |     fail_ae_taste
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    15,590      9,249 |    24,839 
  sotrovimab |       332        204 |       536 
    paxlovid |       341        203 |       544 
molnupiravir |       346        204 |       550 
-------------+----------------------+----------
       Total |    16,609      9,860 |    26,469 
ae_anaphylaxis

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  19,434
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  423
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  433
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  437

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,294
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  174
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  185
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  187

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  950
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  22
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  32
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  26
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_ae_anaphylaxis
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    12,715     12,124 |    24,839 
  sotrovimab |       263        273 |       536 
    paxlovid |       263        281 |       544 
molnupiravir |       275        275 |       550 
-------------+----------------------+----------
       Total |    13,516     12,953 |    26,469 
ae_rash

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,954
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  214
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  203
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  205

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,056
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  122
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  106
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  107

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  516
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  12
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |     fail_ae_rash
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,416      5,423 |    24,839 
  sotrovimab |       432        104 |       536 
    paxlovid |       435        109 |       544 
molnupiravir |       440        110 |       550 
-------------+----------------------+----------
       Total |    20,723      5,746 |    26,469 
ae_drug

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,944
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  230
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  205
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  224

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,063
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  125
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  107
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  98

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  486
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  15
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  15
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |     fail_ae_drug
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,448      5,391 |    24,839 
  sotrovimab |       416        120 |       536 
    paxlovid |       437        107 |       544 
molnupiravir |       410        140 |       550 
-------------+----------------------+----------
       Total |    20,711      5,758 |    26,469 
ae_allergic

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,957
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  201
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  223
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  212

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,028
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  109
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  106
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  117

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  458
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |   fail_ae_allergic
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,436      5,403 |    24,839 
  sotrovimab |       437         99 |       536 
    paxlovid |       416        128 |       544 
molnupiravir |       444        106 |       550 
-------------+----------------------+----------
       Total |    20,733      5,736 |    26,469 
ae_ra

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  15,656
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  339
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  350
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  342

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  6,598
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  138
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  142
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  148

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  723
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  19
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  19
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |      fail_ae_ra
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    15,028      9,811 |    24,839 
  sotrovimab |       316        220 |       536 
    paxlovid |       317        227 |       544 
molnupiravir |       345        205 |       550 
-------------+----------------------+----------
       Total |    16,006     10,463 |    26,469 
ae_sle

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  15,688
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  340
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  334
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  368

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  6,638
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  142
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  140
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  159

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  753
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  22
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |      fail_ae_sle
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    15,008      9,831 |    24,839 
  sotrovimab |       327        209 |       536 
    paxlovid |       333        211 |       544 
molnupiravir |       319        231 |       550 
-------------+----------------------+----------
       Total |    15,987     10,482 |    26,469 
ae_psorasis

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  14,268
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  316
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  291
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  314

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  6,647
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  153
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  134
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  144

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  710
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  18
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  15
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |   fail_ae_psorasis
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    16,491      8,348 |    24,839 
  sotrovimab |       354        182 |       536 
    paxlovid |       370        174 |       544 
molnupiravir |       365        185 |       550 
-------------+----------------------+----------
       Total |    17,580      8,889 |    26,469 
ae_psa

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  14,259
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  297
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  324
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  311

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  6,686
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  128
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  152
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  150

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  707
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  17
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  19
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |      fail_ae_psa
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    16,538      8,301 |    24,839 
  sotrovimab |       349        187 |       536 
    paxlovid |       362        182 |       544 
molnupiravir |       370        180 |       550 
-------------+----------------------+----------
       Total |    17,619      8,850 |    26,469 
ae_ankspon

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  14,339
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  319
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  315
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  327

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  6,743
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  154
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  137
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  146

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  699
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  13
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  21
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |    fail_ae_ankspon
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    16,520      8,319 |    24,839 
  sotrovimab |       353        183 |       536 
    paxlovid |       353        191 |       544 
molnupiravir |       348        202 |       550 
-------------+----------------------+----------
       Total |    17,574      8,895 |    26,469 
ae_ibd

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  14,293
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  299
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  317
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  305

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  6,644
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  135
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  150
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  140

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  690
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  14
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  12
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |      fail_ae_ibd
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    16,476      8,363 |    24,839 
  sotrovimab |       356        180 |       536 
    paxlovid |       362        182 |       544 
molnupiravir |       375        175 |       550 
-------------+----------------------+----------
       Total |    17,569      8,900 |    26,469 
ae_diverticulitis_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,856
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  217
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  216
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  217

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,003
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  109
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  113
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  105

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  491
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  17
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_diverticuliti
             |       s_snomed
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,475      5,364 |    24,839 
  sotrovimab |       411        125 |       536 
    paxlovid |       431        113 |       544 
molnupiravir |       429        121 |       550 
-------------+----------------------+----------
       Total |    20,746      5,723 |    26,469 
ae_diarrhoea_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  10,011
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  204
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  227
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  217

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,078
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  103
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  109
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  102

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  469
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  15
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  8
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_diarrhoea_sno
             |          med
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,423      5,416 |    24,839 
  sotrovimab |       420        116 |       536 
    paxlovid |       414        130 |       544 
molnupiravir |       428        122 |       550 
-------------+----------------------+----------
       Total |    20,685      5,784 |    26,469 
ae_taste_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,956
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  222
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  233
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  216

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,021
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  109
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  127
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  102

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  438
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  14
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  6
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_taste_snomed
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,445      5,394 |    24,839 
  sotrovimab |       408        128 |       536 
    paxlovid |       428        116 |       544 
molnupiravir |       430        120 |       550 
-------------+----------------------+----------
       Total |    20,711      5,758 |    26,469 
ae_diverticulitis_icd_prim

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,958
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  215
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  209
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  224

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,131
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  120
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  111
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  103

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  476
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  15
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  5
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_diverticuliti
             |      s_icd_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,526      5,313 |    24,839 
  sotrovimab |       425        111 |       536 
    paxlovid |       431        113 |       544 
molnupiravir |       424        126 |       550 
-------------+----------------------+----------
       Total |    20,806      5,663 |    26,469 
ae_taste_icd_prim

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,833
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  207
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  214
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  224

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,939
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  109
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  113
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  120

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  449
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  13
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  20
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_taste_icd_pri
             |           m
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,481      5,358 |    24,839 
  sotrovimab |       428        108 |       536 
    paxlovid |       429        115 |       544 
molnupiravir |       426        124 |       550 
-------------+----------------------+----------
       Total |    20,764      5,705 |    26,469 
ae_diverticulitis_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,854
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  207
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  232
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  218

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,023
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  104
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  110
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  108

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  465
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  11
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  15
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_diverticuliti
             |         s_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,529      5,310 |    24,839 
  sotrovimab |       422        114 |       536 
    paxlovid |       407        137 |       544 
molnupiravir |       431        119 |       550 
-------------+----------------------+----------
       Total |    20,789      5,680 |    26,469 
ae_anaphylaxis_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,884
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  229
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  218
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  212

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,042
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  116
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  111
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  110

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  521
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  12
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_anaphylaxis_s
             |         nomed
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,456      5,383 |    24,839 
  sotrovimab |       416        120 |       536 
    paxlovid |       421        123 |       544 
molnupiravir |       436        114 |       550 
-------------+----------------------+----------
       Total |    20,729      5,740 |    26,469 
ae_rash_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,954
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  214
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  203
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  205

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,056
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  122
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  106
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  107

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  516
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  12
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_ae_rash_snomed
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,416      5,423 |    24,839 
  sotrovimab |       432        104 |       536 
    paxlovid |       435        109 |       544 
molnupiravir |       440        110 |       550 
-------------+----------------------+----------
       Total |    20,723      5,746 |    26,469 
ae_anaphylaxis_icd_prim

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,984
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  209
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  223
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  219

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,068
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  102
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  117
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  106

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  474
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  11
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  19
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_anaphylaxis_i
             |        cd_prim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,438      5,401 |    24,839 
  sotrovimab |       417        119 |       536 
    paxlovid |       418        126 |       544 
molnupiravir |       426        124 |       550 
-------------+----------------------+----------
       Total |    20,699      5,770 |    26,469 
ae_anaphlaxis_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,996
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  207
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  214
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  226

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,123
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  99
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  113
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  111

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  494
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  13
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  12
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_anaphlaxis_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,452      5,387 |    24,839 
  sotrovimab |       415        121 |       536 
    paxlovid |       431        113 |       544 
molnupiravir |       425        125 |       550 
-------------+----------------------+----------
       Total |    20,723      5,746 |    26,469 
ae_drugreact_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,944
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  230
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  205
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  224

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,063
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  125
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  107
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  98

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  486
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  15
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  15
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_ae_drugreact_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,448      5,391 |    24,839 
  sotrovimab |       416        120 |       536 
    paxlovid |       437        107 |       544 
molnupiravir |       410        140 |       550 
-------------+----------------------+----------
       Total |    20,711      5,758 |    26,469 
ae_allergic_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,957
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  201
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  223
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  212

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  5,028
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  109
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  106
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  117

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  458
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_ae_allergic_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,436      5,403 |    24,839 
  sotrovimab |       437         99 |       536 
    paxlovid |       416        128 |       544 
molnupiravir |       444        106 |       550 
-------------+----------------------+----------
       Total |    20,733      5,736 |    26,469 
new_ae_ra_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  7,989
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  178
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  169
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  170

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,006
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  80
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  88
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  83

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  375
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  3
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_ra_snomed
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,465      4,374 |    24,839 
  sotrovimab |       431        105 |       536 
    paxlovid |       454         90 |       544 
molnupiravir |       460         90 |       550 
-------------+----------------------+----------
       Total |    21,810      4,659 |    26,469 
new_ae_sle_ctv

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,011
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  176
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  159
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  184

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  3,981
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  84
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  86
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  92

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  383
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  4
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  11
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_new_ae_sle_ctv
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,409      4,430 |    24,839 
  sotrovimab |       439         97 |       536 
    paxlovid |       461         83 |       544 
molnupiravir |       446        104 |       550 
-------------+----------------------+----------
       Total |    21,755      4,714 |    26,469 
new_ae_psoriasis_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  9,003
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  190
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  189
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  194

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,560
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  99
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  94
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  98

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  476
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  13
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  16
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  7
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_psoriasis
             |        _snomed
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,905      4,934 |    24,839 
  sotrovimab |       432        104 |       536 
    paxlovid |       432        112 |       544 
molnupiravir |       447        103 |       550 
-------------+----------------------+----------
       Total |    21,216      5,253 |    26,469 
new_ae_psa_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,928
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  196
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  207
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  198

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,568
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  83
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  113
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  104

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  441
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  13
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  8
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_psa_snome
             |           d
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,024      4,815 |    24,839 
  sotrovimab |       410        126 |       536 
    paxlovid |       443        101 |       544 
molnupiravir |       449        101 |       550 
-------------+----------------------+----------
       Total |    21,326      5,143 |    26,469 
new_ae_ankspon_ctv

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,924
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  204
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  197
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  204

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,582
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  94
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  100
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  100

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  438
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  8
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  19
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_ankspon_c
             |          tv
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,045      4,794 |    24,839 
  sotrovimab |       417        119 |       536 
    paxlovid |       439        105 |       544 
molnupiravir |       428        122 |       550 
-------------+----------------------+----------
       Total |    21,329      5,140 |    26,469 
new_ae_ibd_snomed

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,984
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  193
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  214
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  201

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,573
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  101
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  119
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  99

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  443
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  11
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  6
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_ibd_snome
             |           d
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    19,975      4,864 |    24,839 
  sotrovimab |       435        101 |       536 
    paxlovid |       437        107 |       544 
molnupiravir |       443        107 |       550 
-------------+----------------------+----------
       Total |    21,290      5,179 |    26,469 
new_ae_ra_icd_prim

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,033
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  178
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  203
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  157

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,038
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  82
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  105
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  84

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  389
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_ra_icd_pr
             |          im
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,439      4,400 |    24,839 
  sotrovimab |       433        103 |       536 
    paxlovid |       437        107 |       544 
molnupiravir |       469         81 |       550 
-------------+----------------------+----------
       Total |    21,778      4,691 |    26,469 
new_ae_sle_icd_prim

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,090
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  184
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  187
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  188

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,167
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  97
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  94
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  101

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  406
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  8
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  13
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  10
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_sle_icd_p
             |          rim
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,500      4,339 |    24,839 
  sotrovimab |       441         95 |       536 
    paxlovid |       438        106 |       544 
molnupiravir |       455         95 |       550 
-------------+----------------------+----------
       Total |    21,834      4,635 |    26,469 
new_ae_ra_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,027
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  167
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  162
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  179

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,065
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  85
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  72
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  78

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  384
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |   fail_new_ae_ra_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,480      4,359 |    24,839 
  sotrovimab |       441         95 |       536 
    paxlovid |       444        100 |       544 
molnupiravir |       441        109 |       550 
-------------+----------------------+----------
       Total |    21,806      4,663 |    26,469 
new_ae_sle_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,039
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  184
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  147
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  187

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,049
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  95
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  67
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  99

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  376
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  13
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  14
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_new_ae_sle_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,463      4,376 |    24,839 
  sotrovimab |       435        101 |       536 
    paxlovid |       456         88 |       544 
molnupiravir |       448        102 |       550 
-------------+----------------------+----------
       Total |    21,802      4,667 |    26,469 
new_ae_psoriasis_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,897
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  202
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  177
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  208

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,548
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  100
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  85
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  106

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  421
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  10
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  3
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  12
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_psoriasis
             |          _ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,061      4,778 |    24,839 
  sotrovimab |       423        113 |       536 
    paxlovid |       449         95 |       544 
molnupiravir |       435        115 |       550 
-------------+----------------------+----------
       Total |    21,368      5,101 |    26,469 
new_ae_psa_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,893
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  186
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  189
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  185

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,518
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  101
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  88
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  93

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  445
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  6
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  4
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  12
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_new_ae_psa_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,008      4,831 |    24,839 
  sotrovimab |       444         92 |       536 
    paxlovid |       439        105 |       544 
molnupiravir |       446        104 |       550 
-------------+----------------------+----------
       Total |    21,337      5,132 |    26,469 
new_ae_ankspon_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,956
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  186
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  199
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  193

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,556
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  97
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  89
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  95

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  422
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  9
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             | fail_new_ae_ankspon_a
             |           e
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,001      4,838 |    24,839 
  sotrovimab |       436        100 |       536 
    paxlovid |       425        119 |       544 
molnupiravir |       443        107 |       550 
-------------+----------------------+----------
       Total |    21,305      5,164 |    26,469 
new_ae_ibd_ae

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  8,896
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  190
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  190
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  173

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  4,529
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  95
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  88
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  87

------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = control
  440
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = sotrovimab
  12
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = paxlovid
  7
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
-> drug = molnupiravir
  8
(25,933 missing values generated)
(544 real changes made)
(550 real changes made)
(24,839 real changes made)

             |  fail_new_ae_ibd_ae
        drug |         0          1 |     Total
-------------+----------------------+----------
     control |    20,013      4,826 |    24,839 
  sotrovimab |       429        107 |       536 
    paxlovid |       435        109 |       544 
molnupiravir |       458         92 |       550 
-------------+----------------------+----------
       Total |    21,335      5,134 |    26,469 

. 
. * Add half-day buffer if outcome on indexdate
. foreach x in    $ae $ae_disease ///
>                                 $ae_spc $ae_spc_icd $ae_spc_emerg ///
>                                 $ae_drug $ae_drug_icd $ae_drug_emerg ///
>                                 $ae_imae $ae_imae_icd $ae_imae_emerg ///
>                                 {
  2.         display "`x'"
  3.         replace `x'=`x'+0.5 if `x'==start_date
  4. }
ae_spc_all
(51 real changes made)
ae_drug_all
(47 real changes made)
ae_imae_all
(50 real changes made)
ae_all
(53 real changes made)
allcause_emerg_aande
(4 real changes made)
covid_hosp_date
(8 real changes made)
all_hosp_date
(3 real changes made)
died_date_ons
(13 real changes made)
ae_diverticulitis
(33 real changes made)
ae_diarrhoea
(20 real changes made)
ae_taste
(33 real changes made)
ae_anaphylaxis
(40 real changes made)
ae_rash
(25 real changes made)
ae_drug
(22 real changes made)
ae_allergic
(11 real changes made)
ae_ra
(27 real changes made)
ae_sle
(38 real changes made)
ae_psorasis
(22 real changes made)
ae_psa
(22 real changes made)
ae_ankspon
(20 real changes made)
ae_ibd
(29 real changes made)
ae_diverticulitis_snomed
(15 real changes made)
ae_diarrhoea_snomed
(20 real changes made)
ae_taste_snomed
(19 real changes made)
ae_diverticulitis_icd_prim
(26 real changes made)
ae_taste_icd_prim
(22 real changes made)
ae_diverticulitis_ae
(11 real changes made)
ae_anaphylaxis_snomed
(17 real changes made)
ae_rash_snomed
(25 real changes made)
ae_anaphylaxis_icd_prim
(18 real changes made)
ae_anaphlaxis_ae
(28 real changes made)
ae_drugreact_ae
(22 real changes made)
ae_allergic_ae
(11 real changes made)
new_ae_ra_snomed
(18 real changes made)
new_ae_sle_ctv
(15 real changes made)
new_ae_psoriasis_snomed
(22 real changes made)
new_ae_psa_snomed
(17 real changes made)
new_ae_ankspon_ctv
(15 real changes made)
new_ae_ibd_snomed
(21 real changes made)
new_ae_ra_icd_prim
(14 real changes made)
new_ae_sle_icd_prim
(19 real changes made)
new_ae_ra_ae
(20 real changes made)
new_ae_sle_ae
(23 real changes made)
new_ae_psoriasis_ae
(11 real changes made)
new_ae_psa_ae
(15 real changes made)
new_ae_ankspon_ae
(8 real changes made)
new_ae_ibd_ae
(12 real changes made)

. 
. *Generate censor date
. foreach x in    $ae $ae_disease ///
>                                 $ae_spc $ae_spc_icd $ae_spc_emerg ///
>                                 $ae_drug $ae_drug_icd $ae_drug_emerg ///
>                                 $ae_imae $ae_imae_icd $ae_imae_emerg ///
>                                 {
  2.         gen stop_`x'=`x' if fail_`x'==1
  3.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_date_29,paxlovid,molnupiravir) if fail_`x'==0&drug==1
  4.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_date_29,sotrovimab,molnupiravir) if fail_`x'==0&drug==2
  5.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_date_29,sotrovimab,paxlovid) if fail_`x'==0&drug==3
  6.         replace stop_`x'=min(death_date,dereg_date,study_end_date,start_date_29,sotrovimab,paxlovid,molnupiravir) if fail_`x'==0&drug==0
  7.         format %td stop_`x'
  8. }
(8,213 missing values generated)
(155 real changes made)
(152 real changes made)
(168 real changes made)
(7,738 real changes made)
(8,101 missing values generated)
(164 real changes made)
(163 real changes made)
(174 real changes made)
(7,600 real changes made)
(4,269 missing values generated)
(86 real changes made)
(78 real changes made)
(80 real changes made)
(4,025 real changes made)
(1,778 missing values generated)
(24 real changes made)
(32 real changes made)
(29 real changes made)
(1,693 real changes made)
(25,830 missing values generated)
(524 real changes made)
(536 real changes made)
(532 real changes made)
(24,238 real changes made)
(25,142 missing values generated)
(508 real changes made)
(518 real changes made)
(528 real changes made)
(23,588 real changes made)
(25,156 missing values generated)
(515 real changes made)
(524 real changes made)
(521 real changes made)
(23,596 real changes made)
(15,062 missing values generated)
(315 real changes made)
(299 real changes made)
(310 real changes made)
(14,138 real changes made)
(13,570 missing values generated)
(262 real changes made)
(271 real changes made)
(269 real changes made)
(12,768 real changes made)
(20,685 missing values generated)
(420 real changes made)
(414 real changes made)
(428 real changes made)
(19,423 real changes made)
(16,609 missing values generated)
(332 real changes made)
(341 real changes made)
(346 real changes made)
(15,590 real changes made)
(13,516 missing values generated)
(263 real changes made)
(263 real changes made)
(275 real changes made)
(12,715 real changes made)
(20,723 missing values generated)
(432 real changes made)
(435 real changes made)
(440 real changes made)
(19,416 real changes made)
(20,711 missing values generated)
(416 real changes made)
(437 real changes made)
(410 real changes made)
(19,448 real changes made)
(20,733 missing values generated)
(437 real changes made)
(416 real changes made)
(444 real changes made)
(19,436 real changes made)
(16,006 missing values generated)
(316 real changes made)
(317 real changes made)
(345 real changes made)
(15,028 real changes made)
(15,987 missing values generated)
(327 real changes made)
(333 real changes made)
(319 real changes made)
(15,008 real changes made)
(17,580 missing values generated)
(354 real changes made)
(370 real changes made)
(365 real changes made)
(16,491 real changes made)
(17,619 missing values generated)
(349 real changes made)
(362 real changes made)
(370 real changes made)
(16,538 real changes made)
(17,574 missing values generated)
(353 real changes made)
(353 real changes made)
(348 real changes made)
(16,520 real changes made)
(17,569 missing values generated)
(356 real changes made)
(362 real changes made)
(375 real changes made)
(16,476 real changes made)
(20,746 missing values generated)
(411 real changes made)
(431 real changes made)
(429 real changes made)
(19,475 real changes made)
(20,685 missing values generated)
(420 real changes made)
(414 real changes made)
(428 real changes made)
(19,423 real changes made)
(20,711 missing values generated)
(408 real changes made)
(428 real changes made)
(430 real changes made)
(19,445 real changes made)
(20,806 missing values generated)
(425 real changes made)
(431 real changes made)
(424 real changes made)
(19,526 real changes made)
(20,764 missing values generated)
(428 real changes made)
(429 real changes made)
(426 real changes made)
(19,481 real changes made)
(20,789 missing values generated)
(422 real changes made)
(407 real changes made)
(431 real changes made)
(19,529 real changes made)
(20,729 missing values generated)
(416 real changes made)
(421 real changes made)
(436 real changes made)
(19,456 real changes made)
(20,723 missing values generated)
(432 real changes made)
(435 real changes made)
(440 real changes made)
(19,416 real changes made)
(20,699 missing values generated)
(417 real changes made)
(418 real changes made)
(426 real changes made)
(19,438 real changes made)
(20,723 missing values generated)
(415 real changes made)
(431 real changes made)
(425 real changes made)
(19,452 real changes made)
(20,711 missing values generated)
(416 real changes made)
(437 real changes made)
(410 real changes made)
(19,448 real changes made)
(20,733 missing values generated)
(437 real changes made)
(416 real changes made)
(444 real changes made)
(19,436 real changes made)
(21,810 missing values generated)
(431 real changes made)
(454 real changes made)
(460 real changes made)
(20,465 real changes made)
(21,755 missing values generated)
(439 real changes made)
(461 real changes made)
(446 real changes made)
(20,409 real changes made)
(21,216 missing values generated)
(432 real changes made)
(432 real changes made)
(447 real changes made)
(19,905 real changes made)
(21,326 missing values generated)
(410 real changes made)
(443 real changes made)
(449 real changes made)
(20,024 real changes made)
(21,329 missing values generated)
(417 real changes made)
(439 real changes made)
(428 real changes made)
(20,045 real changes made)
(21,290 missing values generated)
(435 real changes made)
(437 real changes made)
(443 real changes made)
(19,975 real changes made)
(21,778 missing values generated)
(433 real changes made)
(437 real changes made)
(469 real changes made)
(20,439 real changes made)
(21,834 missing values generated)
(441 real changes made)
(438 real changes made)
(455 real changes made)
(20,500 real changes made)
(21,806 missing values generated)
(441 real changes made)
(444 real changes made)
(441 real changes made)
(20,480 real changes made)
(21,802 missing values generated)
(435 real changes made)
(456 real changes made)
(448 real changes made)
(20,463 real changes made)
(21,368 missing values generated)
(423 real changes made)
(449 real changes made)
(435 real changes made)
(20,061 real changes made)
(21,337 missing values generated)
(444 real changes made)
(439 real changes made)
(446 real changes made)
(20,008 real changes made)
(21,305 missing values generated)
(436 real changes made)
(425 real changes made)
(443 real changes made)
(20,001 real changes made)
(21,335 missing values generated)
(429 real changes made)
(435 real changes made)
(458 real changes made)
(20,013 real changes made)

. 
. * Follow-up time
. stset stop_ae_all, id(patient_id) origin(time start_date) enter(time start_date) failure(fail_ae_all==1) 

Survival-time data settings

           ID variable: patient_id
         Failure event: fail_ae_all==1
Observed time interval: (stop_ae_all[_n-1], stop_ae_all]
     Enter on or after: time start_date
     Exit on or before: failure
     Time for analysis: (time-origin)
                Origin: time start_date

--------------------------------------------------------------------------
     26,469  total observations
     23,554  observations end on or before enter()
--------------------------------------------------------------------------
      2,915  observations remaining, representing
      2,915  subjects
      1,143  failures in single-failure-per-subject data
   65,820.5  total analysis time at risk and under observation
                                                At risk from t =         0
                                     Earliest observed entry t =         0
                                          Last observed exit t =        29

. *count censored due to second therapy*
. count if fail_ae_all==0&drug==1&min(paxlovid,molnupiravir)==stop_ae_all
  0

. count if fail_ae_all==0&drug==2&min(sotrovimab,molnupiravir)==stop_ae_all
  0

. count if fail_ae_all==0&drug==3&min(sotrovimab,paxlovid)==stop_ae_all
  0

. count if fail_ae_all==0&drug==0&min(sotrovimab,paxlovid,molnupiravir)==stop_ae_all
  0

. tab _st  // keep if _st==1 -> removes observations that end on or before enter 

1 if record |
   is to be |
    used; 0 |
  otherwise |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     23,554       88.99       88.99
          1 |      2,915       11.01      100.00
------------+-----------------------------------
      Total |     26,469      100.00

. count if start_date>=stop_ae_all & _st==0
  23,554

. count if start_date==stop_ae_all & _st==0
  6

. tab _t,m

   Analysis |
  time when |
record ends |      Freq.     Percent        Cum.
------------+-----------------------------------
         .5 |         53        0.20        0.20
          1 |         50        0.19        0.39
          2 |         51        0.19        0.58
          3 |         45        0.17        0.75
          4 |         57        0.22        0.97
          5 |         59        0.22        1.19
          6 |         43        0.16        1.35
          7 |         44        0.17        1.52
          8 |         41        0.15        1.67
          9 |         33        0.12        1.80
         10 |         37        0.14        1.94
         11 |         48        0.18        2.12
         12 |         33        0.12        2.24
         13 |         43        0.16        2.41
         14 |         39        0.15        2.55
         15 |         39        0.15        2.70
         16 |         37        0.14        2.84
         17 |         44        0.17        3.01
         18 |         22        0.08        3.09
         19 |         30        0.11        3.20
         20 |         27        0.10        3.31
         21 |         26        0.10        3.40
         22 |         41        0.15        3.56
         23 |         41        0.15        3.71
         24 |         22        0.08        3.80
         25 |         39        0.15        3.94
         26 |         29        0.11        4.05
         27 |         28        0.11        4.16
         28 |         47        0.18        4.34
         29 |      1,767        6.68       11.01
          . |     23,554       88.99      100.00
------------+-----------------------------------
      Total |     26,469      100.00

. tab _t drug,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  Analysis |
 time when |
    record |                    drug
      ends |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
        .5 |        44          2          1          6 |        53 
           |      0.18       0.37       0.18       1.09 |      0.20 
-----------+--------------------------------------------+----------
         1 |        47          2          1          0 |        50 
           |      0.19       0.37       0.18       0.00 |      0.19 
-----------+--------------------------------------------+----------
         2 |        46          3          2          0 |        51 
           |      0.19       0.56       0.37       0.00 |      0.19 
-----------+--------------------------------------------+----------
         3 |        43          1          0          1 |        45 
           |      0.17       0.19       0.00       0.18 |      0.17 
-----------+--------------------------------------------+----------
         4 |        49          4          3          1 |        57 
           |      0.20       0.75       0.55       0.18 |      0.22 
-----------+--------------------------------------------+----------
         5 |        56          1          1          1 |        59 
           |      0.23       0.19       0.18       0.18 |      0.22 
-----------+--------------------------------------------+----------
         6 |        42          0          0          1 |        43 
           |      0.17       0.00       0.00       0.18 |      0.16 
-----------+--------------------------------------------+----------
         7 |        42          1          0          1 |        44 
           |      0.17       0.19       0.00       0.18 |      0.17 
-----------+--------------------------------------------+----------
         8 |        38          0          2          1 |        41 
           |      0.15       0.00       0.37       0.18 |      0.15 
-----------+--------------------------------------------+----------
         9 |        30          1          2          0 |        33 
           |      0.12       0.19       0.37       0.00 |      0.12 
-----------+--------------------------------------------+----------
        10 |        37          0          0          0 |        37 
           |      0.15       0.00       0.00       0.00 |      0.14 
-----------+--------------------------------------------+----------
        11 |        46          0          0          2 |        48 
           |      0.19       0.00       0.00       0.36 |      0.18 
-----------+--------------------------------------------+----------
        12 |        31          1          1          0 |        33 
           |      0.12       0.19       0.18       0.00 |      0.12 
-----------+--------------------------------------------+----------
        13 |        41          0          1          1 |        43 
           |      0.17       0.00       0.18       0.18 |      0.16 
-----------+--------------------------------------------+----------
        14 |        35          1          1          2 |        39 
           |      0.14       0.19       0.18       0.36 |      0.15 
-----------+--------------------------------------------+----------
        15 |        38          0          1          0 |        39 
           |      0.15       0.00       0.18       0.00 |      0.15 
-----------+--------------------------------------------+----------
        16 |        33          1          2          1 |        37 
           |      0.13       0.19       0.37       0.18 |      0.14 
-----------+--------------------------------------------+----------
        17 |        43          1          0          0 |        44 
           |      0.17       0.19       0.00       0.00 |      0.17 
-----------+--------------------------------------------+----------
        18 |        20          1          1          0 |        22 
           |      0.08       0.19       0.18       0.00 |      0.08 
-----------+--------------------------------------------+----------
        19 |        29          1          0          0 |        30 
           |      0.12       0.19       0.00       0.00 |      0.11 
-----------+--------------------------------------------+----------
        20 |        25          1          0          1 |        27 
           |      0.10       0.19       0.00       0.18 |      0.10 
-----------+--------------------------------------------+----------
        21 |        25          0          0          1 |        26 
           |      0.10       0.00       0.00       0.18 |      0.10 
-----------+--------------------------------------------+----------
        22 |        36          0          1          4 |        41 
           |      0.14       0.00       0.18       0.73 |      0.15 
-----------+--------------------------------------------+----------
        23 |        38          0          1          2 |        41 
           |      0.15       0.00       0.18       0.36 |      0.15 
-----------+--------------------------------------------+----------
        24 |        19          1          1          1 |        22 
           |      0.08       0.19       0.18       0.18 |      0.08 
-----------+--------------------------------------------+----------
        25 |        36          0          1          2 |        39 
           |      0.14       0.00       0.18       0.36 |      0.15 
-----------+--------------------------------------------+----------
        26 |        26          1          1          1 |        29 
           |      0.10       0.19       0.18       0.18 |      0.11 
-----------+--------------------------------------------+----------
        27 |        26          0          2          0 |        28 
           |      0.10       0.00       0.37       0.00 |      0.11 
-----------+--------------------------------------------+----------
        28 |        43          0          2          2 |        47 
           |      0.17       0.00       0.37       0.36 |      0.18 
-----------+--------------------------------------------+----------
        29 |     1,684         23         31         29 |     1,767 
           |      6.78       4.29       5.70       5.27 |      6.68 
-----------+--------------------------------------------+----------
         . |    22,091        489        485        489 |    23,554 
           |     88.94      91.23      89.15      88.91 |     88.99 
-----------+--------------------------------------------+----------
     Total |    24,839        536        544        550 |    26,469 
           |    100.00     100.00     100.00     100.00 |    100.00 

. tab _t drug if fail_ae_all==1,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  Analysis |
 time when |
    record |                    drug
      ends |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
        .5 |        44          2          1          6 |        53 
           |      0.19       0.39       0.20       1.15 |      0.21 
-----------+--------------------------------------------+----------
         1 |        43          2          1          0 |        46 
           |      0.19       0.39       0.20       0.00 |      0.19 
-----------+--------------------------------------------+----------
         2 |        41          2          1          0 |        44 
           |      0.18       0.39       0.20       0.00 |      0.18 
-----------+--------------------------------------------+----------
         3 |        38          1          0          1 |        40 
           |      0.16       0.20       0.00       0.19 |      0.16 
-----------+--------------------------------------------+----------
         4 |        38          3          3          1 |        45 
           |      0.16       0.59       0.59       0.19 |      0.18 
-----------+--------------------------------------------+----------
         5 |        50          1          1          1 |        53 
           |      0.22       0.20       0.20       0.19 |      0.21 
-----------+--------------------------------------------+----------
         6 |        38          0          0          1 |        39 
           |      0.16       0.00       0.00       0.19 |      0.16 
-----------+--------------------------------------------+----------
         7 |        42          1          0          1 |        44 
           |      0.18       0.20       0.00       0.19 |      0.18 
-----------+--------------------------------------------+----------
         8 |        38          0          2          1 |        41 
           |      0.16       0.00       0.39       0.19 |      0.17 
-----------+--------------------------------------------+----------
         9 |        30          1          2          0 |        33 
           |      0.13       0.20       0.39       0.00 |      0.13 
-----------+--------------------------------------------+----------
        10 |        37          0          0          0 |        37 
           |      0.16       0.00       0.00       0.00 |      0.15 
-----------+--------------------------------------------+----------
        11 |        46          0          0          2 |        48 
           |      0.20       0.00       0.00       0.38 |      0.19 
-----------+--------------------------------------------+----------
        12 |        31          1          1          0 |        33 
           |      0.13       0.20       0.20       0.00 |      0.13 
-----------+--------------------------------------------+----------
        13 |        41          0          1          1 |        43 
           |      0.18       0.00       0.20       0.19 |      0.17 
-----------+--------------------------------------------+----------
        14 |        35          1          1          2 |        39 
           |      0.15       0.20       0.20       0.38 |      0.16 
-----------+--------------------------------------------+----------
        15 |        38          0          1          0 |        39 
           |      0.16       0.00       0.20       0.00 |      0.16 
-----------+--------------------------------------------+----------
        16 |        33          1          2          1 |        37 
           |      0.14       0.20       0.39       0.19 |      0.15 
-----------+--------------------------------------------+----------
        17 |        43          1          0          0 |        44 
           |      0.19       0.20       0.00       0.00 |      0.18 
-----------+--------------------------------------------+----------
        18 |        20          1          1          0 |        22 
           |      0.09       0.20       0.20       0.00 |      0.09 
-----------+--------------------------------------------+----------
        19 |        29          1          0          0 |        30 
           |      0.13       0.20       0.00       0.00 |      0.12 
-----------+--------------------------------------------+----------
        20 |        25          1          0          1 |        27 
           |      0.11       0.20       0.00       0.19 |      0.11 
-----------+--------------------------------------------+----------
        21 |        25          0          0          1 |        26 
           |      0.11       0.00       0.00       0.19 |      0.11 
-----------+--------------------------------------------+----------
        22 |        36          0          1          4 |        41 
           |      0.16       0.00       0.20       0.77 |      0.17 
-----------+--------------------------------------------+----------
        23 |        38          0          1          2 |        41 
           |      0.16       0.00       0.20       0.38 |      0.17 
-----------+--------------------------------------------+----------
        24 |        19          1          1          1 |        22 
           |      0.08       0.20       0.20       0.19 |      0.09 
-----------+--------------------------------------------+----------
        25 |        36          0          1          2 |        39 
           |      0.16       0.00       0.20       0.38 |      0.16 
-----------+--------------------------------------------+----------
        26 |        26          1          1          1 |        29 
           |      0.11       0.20       0.20       0.19 |      0.12 
-----------+--------------------------------------------+----------
        27 |        26          0          2          0 |        28 
           |      0.11       0.00       0.39       0.00 |      0.11 
-----------+--------------------------------------------+----------
        28 |        43          0          2          2 |        47 
           |      0.19       0.00       0.39       0.38 |      0.19 
-----------+--------------------------------------------+----------
        29 |        32          1          0          0 |        33 
           |      0.14       0.20       0.00       0.00 |      0.13 
-----------+--------------------------------------------+----------
         . |    22,085        489        485        489 |    23,548 
           |     95.42      95.51      94.73      93.86 |     95.37 
-----------+--------------------------------------------+----------
     Total |    23,146        512        512        521 |    24,691 
           |    100.00     100.00     100.00     100.00 |    100.00 

. tab _t drug if fail_ae_all==1&stop_ae_all==ae_all

  Analysis |
 time when |
    record |                    drug
      ends |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
        .5 |        44          2          1          6 |        53 
         1 |        43          2          1          0 |        46 
         2 |        41          2          1          0 |        44 
         3 |        38          1          0          1 |        40 
         4 |        38          3          3          1 |        45 
         5 |        50          1          1          1 |        53 
         6 |        38          0          0          1 |        39 
         7 |        42          1          0          1 |        44 
         8 |        38          0          2          1 |        41 
         9 |        30          1          2          0 |        33 
        10 |        37          0          0          0 |        37 
        11 |        46          0          0          2 |        48 
        12 |        31          1          1          0 |        33 
        13 |        41          0          1          1 |        43 
        14 |        35          1          1          2 |        39 
        15 |        38          0          1          0 |        39 
        16 |        33          1          2          1 |        37 
        17 |        43          1          0          0 |        44 
        18 |        20          1          1          0 |        22 
        19 |        29          1          0          0 |        30 
        20 |        25          1          0          1 |        27 
        21 |        25          0          0          1 |        26 
        22 |        36          0          1          4 |        41 
        23 |        38          0          1          2 |        41 
        24 |        19          1          1          1 |        22 
        25 |        36          0          1          2 |        39 
        26 |        26          1          1          1 |        29 
        27 |        26          0          2          0 |        28 
        28 |        43          0          2          2 |        47 
        29 |        32          1          0          0 |        33 
-----------+--------------------------------------------+----------
     Total |     1,061         23         27         32 |     1,143 

. tab fail_ae_all drug,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

fail_ae_al |                    drug
         l |   control  sotrovima   paxlovid  molnupira |     Total
-----------+--------------------------------------------+----------
         0 |     1,693         24         32         29 |     1,778 
           |      6.82       4.48       5.88       5.27 |      6.72 
-----------+--------------------------------------------+----------
         1 |    23,146        512        512        521 |    24,691 
           |     93.18      95.52      94.12      94.73 |     93.28 
-----------+--------------------------------------------+----------
     Total |    24,839        536        544        550 |    26,469 
           |    100.00     100.00     100.00     100.00 |    100.00 

. *check censor reasons*
. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==ae_all,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==death_date,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  Analysis |
 time when |
    record |               drug
      ends |   control  sotrovima   paxlovid |     Total
-----------+---------------------------------+----------
         1 |         1          0          0 |         1 
           |      5.56       0.00       0.00 |      5.00 
-----------+---------------------------------+----------
         2 |         3          1          1 |         5 
           |     16.67     100.00     100.00 |     25.00 
-----------+---------------------------------+----------
         3 |         3          0          0 |         3 
           |     16.67       0.00       0.00 |     15.00 
-----------+---------------------------------+----------
         4 |         8          0          0 |         8 
           |     44.44       0.00       0.00 |     40.00 
-----------+---------------------------------+----------
         5 |         1          0          0 |         1 
           |      5.56       0.00       0.00 |      5.00 
-----------+---------------------------------+----------
         6 |         2          0          0 |         2 
           |     11.11       0.00       0.00 |     10.00 
-----------+---------------------------------+----------
     Total |        18          1          1 |        20 
           |    100.00     100.00     100.00 |    100.00 

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==dereg_date,m col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
| column percentage |
+-------------------+

  Analysis |
 time when |
    record |         drug
      ends |   control  sotrovima |     Total
-----------+----------------------+----------
         1 |         3          0 |         3 
           |     17.65       0.00 |     16.67 
-----------+----------------------+----------
         2 |         2          0 |         2 
           |     11.76       0.00 |     11.11 
-----------+----------------------+----------
         3 |         2          0 |         2 
           |     11.76       0.00 |     11.11 
-----------+----------------------+----------
         4 |         3          1 |         4 
           |     17.65     100.00 |     22.22 
-----------+----------------------+----------
         5 |         5          0 |         5 
           |     29.41       0.00 |     27.78 
-----------+----------------------+----------
         6 |         2          0 |         2 
           |     11.76       0.00 |     11.11 
-----------+----------------------+----------
     Total |        17          1 |        18 
           |    100.00     100.00 |    100.00 

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(paxlovid,molnupiravir)&drug==1,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(sotrovimab,molnupiravir)&drug==2,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(sotrovimab,paxlovid)&drug==3,m col
no observations

. tab _t drug if fail_ae_all==0&_t<28&stop_ae_all==min(sotrovimab,paxlovid,molnupiravir)&drug==0,m col
no observations

. 
. 
. save "$projectdir/output/data/main.dta", replace
file C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir/output/data/main.dta saved

. 
. log close
      name:  <unnamed>
       log:  C:\Users\k1635179\OneDrive - King's College London\Katie\OpenSafely\Safety mAB and antivirals\Safety-Sotrovimab-Paxlovid-Molnupiravir/logs/cleaning_dataset_combine_2.log
  log type:  text
 closed on:   1 Aug 2023, 14:03:15
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
